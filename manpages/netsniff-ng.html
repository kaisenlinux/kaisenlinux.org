<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.23.0">
    <meta name="project" content="Kaisen-linux v0.0.1">
    <title>netsniff-ng — Kaisen-linux v0.0.1</title>
    <link rel="stylesheet" href="dist/elixir-9f91ebe876dc01d67920.css" />
    <script src="dist/sidebar_items-d3359b838f.js"></script>
      <script src="doc-versions.js"></script>
    <script async src="dist/app-60a0c9f10e9e52eae31f.js"></script>
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="#homepage_url" class="sidebar-projectName">
Kaisen-linux      </a>
      <strong class="sidebar-projectVersion">
        v0.0.1
      </strong>
    </div>
      <a href="#homepage_url">
        <img src="assets/logo.jpg" alt="Kaisen-linux" class="sidebar-projectImage">
      </a>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">MANUAL</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

<p>  NETSNIFF-NG</p><h2 id="name" class="section-heading">
  <a href="#name" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  NAME
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">sniffing</span><span class="w"> </span><span class="n">beast</span></code></pre><h2 id="synopsis" class="section-heading">
  <a href="#synopsis" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  SYNOPSIS
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="p" data-group-id="9223438694-1">{</span><span class="w"> </span><span class="p" data-group-id="9223438694-2">[</span><span class="n">options</span><span class="p" data-group-id="9223438694-2">]</span><span class="w"> </span><span class="p" data-group-id="9223438694-3">[</span><span class="n">filter</span><span class="o">-</span><span class="n">expression</span><span class="p" data-group-id="9223438694-3">]</span><span class="w"> </span><span class="p" data-group-id="9223438694-1">}</span></code></pre><h2 id="description" class="section-heading">
  <a href="#description" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  DESCRIPTION
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fast</span><span class="p">,</span><span class="w"> </span><span class="n">minimal</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">analyze</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">replay</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">redirect</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">help</span><span class="w">
    </span><span class="n">of</span><span class="w"> </span><span class="n">zero</span><span class="o">-</span><span class="n">copy</span><span class="w"> </span><span class="n">packet</span><span class="p" data-group-id="0304188924-1">(</span><span class="mi">7</span><span class="p" data-group-id="0304188924-1">)</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="nc">RX_RING</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TX_RING</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">zero</span><span class="o">-</span><span class="n">copy</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w">  </span><span class="n">copy</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">system</span><span class="w">
    </span><span class="n">call</span><span class="w"> </span><span class="n">overhead</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">space</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="p" data-group-id="0304188924-2">(</span><span class="mi">3</span><span class="p" data-group-id="0304188924-2">)</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">did</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">zero</span><span class="o">-</span><span class="n">copy</span><span class="w"> </span><span class="n">facility</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="nc">Linux</span><span class="w">  </span><span class="n">specific</span><span class="p">,</span><span class="w">  </span><span class="n">meaning</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">systems</span><span class="o">.</span><span class="w"> </span><span class="nc">Therefore</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">footprint</span><span class="w"> </span><span class="n">quite</span><span class="w"> </span><span class="n">minimal</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
    </span><span class="n">point</span><span class="o">.</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">packet</span><span class="p" data-group-id="0304188924-3">(</span><span class="mi">7</span><span class="p" data-group-id="0304188924-3">)</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="nc">RX_RING</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TX_RING</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">networking</span><span class="w">  </span><span class="n">stack</span><span class="o">.</span><span class="w">   </span><span class="nc">This</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">the</span><span class="w">
    </span><span class="n">fastest</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">transmission</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">box</span><span class="p">,</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">unsupported</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">mainline</span><span class="w"> </span><span class="n">third</span><span class="o">-</span><span class="n">party</span><span class="w"> </span><span class="n">ker</span><span class="err">‐</span><span class="w">
    </span><span class="n">nel</span><span class="w"> </span><span class="n">modules</span><span class="o">.</span><span class="w"> </span><span class="nc">We</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">refuse</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ntop</span><span class="o">/</span><span class="nc">PF_RING</span><span class="o">.</span><span class="w"> </span><span class="nc">Not</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k" data-group-id="0304188924-4">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="p" data-group-id="0304188924-5">(</span><span class="n">we</span><span class="w"> </span><span class="k" data-group-id="0304188924-6">do</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">interesting</span><span class="p">)</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w">
    </span><span class="n">fact</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mainline</span><span class="w"> </span><span class="n">kernel</span><span class="o">.</span><span class="w"> </span><span class="nc">Therefore</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ntop</span><span class="w"> </span><span class="n">project</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">maintain</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">sync</span><span class="w"> </span><span class="n">out</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">tree</span><span class="w"> </span><span class="n">drivers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">adapt</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="nc">DNA</span><span class="o">.</span><span class="w"> </span><span class="nc">Eventu</span><span class="err">‐</span><span class="w">
    </span><span class="n">ally</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">went</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">untainted</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">review</span><span class="p">,</span><span class="w"> </span><span class="n">maintenance</span><span class="p">,</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">bug</span><span class="w"> </span><span class="n">fixes</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">early</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">filtering</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">low</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">high</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">translated</span><span class="w"> </span><span class="n">into</span><span class="w">  </span><span class="nc">Berkeley</span><span class="w">
    </span><span class="nc">Packet</span><span class="w"> </span><span class="nc">Filter</span><span class="w"> </span><span class="n">instructions</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="n">capture</span><span class="w">  </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">formats</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">interoperable</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tools</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">supported</span><span class="w">
    </span><span class="k">for</span><span class="w"> </span><span class="n">efficient</span><span class="w"> </span><span class="n">to</span><span class="o">-</span><span class="n">disc</span><span class="w"> </span><span class="ss">capturing</span><span class="p">:</span><span class="w"> </span><span class="n">scatter</span><span class="o">-</span><span class="n">gather</span><span class="p">,</span><span class="w"> </span><span class="n">mmap</span><span class="p" data-group-id="0304188924-7">(</span><span class="mi">2</span><span class="p" data-group-id="0304188924-7">)</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="p" data-group-id="0304188924-8">(</span><span class="mi">2</span><span class="p" data-group-id="0304188924-8">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="p" data-group-id="0304188924-9">(</span><span class="mi">2</span><span class="p" data-group-id="0304188924-9">)</span><span class="o">.</span><span class="w">  </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">rotate</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">data</span><span class="w">  </span><span class="n">size</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">time</span><span class="w">
    </span><span class="n">intervals</span><span class="p">,</span><span class="w"> </span><span class="n">thus</span><span class="p">,</span><span class="w"> </span><span class="n">making</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">backend</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">subsequent</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">analysis</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w">  </span><span class="n">itself</span><span class="w">  </span><span class="n">also</span><span class="w">  </span><span class="n">supports</span><span class="w">  </span><span class="n">analysis</span><span class="p">,</span><span class="w"> </span><span class="n">replaying</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dumping</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="mf">802.11</span><span class="w"> </span><span class="n">frames</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">online</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">offline</span><span class="w"> </span><span class="n">analysis</span><span class="p">,</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">packet</span><span class="w">
    </span><span class="n">dissector</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="mf">802.3</span><span class="w"> </span><span class="p" data-group-id="0304188924-10">(</span><span class="nc">Ethernet</span><span class="p" data-group-id="0304188924-10">)</span><span class="p">,</span><span class="w"> </span><span class="mf">802.11</span><span class="o">*</span><span class="w"> </span><span class="p" data-group-id="0304188924-11">(</span><span class="nc">WLAN</span><span class="p" data-group-id="0304188924-11">)</span><span class="p">,</span><span class="w"> </span><span class="nc">ARP</span><span class="p">,</span><span class="w"> </span><span class="nc">MPLS</span><span class="p">,</span><span class="w"> </span><span class="mf">802.1</span><span class="nc">Q</span><span class="w"> </span><span class="p" data-group-id="0304188924-12">(</span><span class="nc">VLAN</span><span class="p" data-group-id="0304188924-12">)</span><span class="p">,</span><span class="w"> </span><span class="mf">802.1</span><span class="nc">QinQ</span><span class="p">,</span><span class="w"> </span><span class="nc">LLDP</span><span class="p">,</span><span class="w"> </span><span class="nc">IPv4</span><span class="p">,</span><span class="w"> </span><span class="nc">IPv6</span><span class="p">,</span><span class="w"> </span><span class="nc">ICMPv4</span><span class="p">,</span><span class="w"> </span><span class="nc">ICMPv6</span><span class="p">,</span><span class="w"> </span><span class="nc">IGMP</span><span class="p">,</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">UDP</span><span class="p">,</span><span class="w"> </span><span class="n">includ</span><span class="err">‐</span><span class="w">
    </span><span class="n">ing</span><span class="w">  </span><span class="nc">GeoIP</span><span class="w">  </span><span class="n">location</span><span class="w">  </span><span class="n">analysis</span><span class="o">.</span><span class="w">  </span><span class="nc">Since</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">establish</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">reassembly</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">dissection</span><span class="p">,</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">footprint</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">quite</span><span class="w">
    </span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="n">thus</span><span class="p">,</span><span class="w"> </span><span class="n">making</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">quite</span><span class="w"> </span><span class="n">efficient</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">offline</span><span class="w"> </span><span class="n">analysis</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w">

    </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">multithreaded</span><span class="o">.</span><span class="w"> </span><span class="nc">However</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">instances</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">pinned</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">dif</span><span class="err">‐</span><span class="w">
    </span><span class="n">ferent</span><span class="p">,</span><span class="w">  </span><span class="n">non</span><span class="o">-</span><span class="n">overlapping</span><span class="w"> </span><span class="nc">CPUs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="nc">BPF</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">attached</span><span class="o">.</span><span class="w">  </span><span class="nc">Likely</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">harddisc</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bottleneck</span><span class="w"> </span><span class="n">assum</span><span class="err">‐</span><span class="w">
    </span><span class="n">ing</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k" data-group-id="0304188924-13">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">rotate</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">pcaps</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ram</span><span class="w"> </span><span class="p" data-group-id="0304188924-14">(</span><span class="ow">and</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">periodically</span><span class="w"> </span><span class="n">scheduled</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">slower</span><span class="w"> </span><span class="n">medias</span><span class="p" data-group-id="0304188924-14">)</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">mergecap</span><span class="p" data-group-id="0304188924-15">(</span><span class="mi">1</span><span class="p" data-group-id="0304188924-15">)</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">transform</span><span class="w">  </span><span class="n">all</span><span class="w">  </span><span class="n">pcap</span><span class="w">
    </span><span class="n">files</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">Thus</span><span class="p">,</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">multithreaded</span><span class="w"> </span><span class="n">eventually</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="n">netlink</span><span class="w"> </span><span class="n">traffic</span><span class="o">.</span></code></pre><h2 id="options" class="section-heading">
  <a href="#options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  OPTIONS
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dev</span><span class="o">|</span><span class="n">pcap</span><span class="o">|</span><span class="o">-&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dev</span><span class="o">|</span><span class="n">pcap</span><span class="o">|</span><span class="o">-&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dev</span><span class="o">|</span><span class="n">pcap</span><span class="o">|</span><span class="o">-&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dev</span><span class="o">|</span><span class="n">pcap</span><span class="o">|</span><span class="o">-&gt;</span><span class="w">
           </span><span class="nc">Defines</span><span class="w">  </span><span class="n">an</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">stdin</span><span class="w"> </span><span class="p" data-group-id="1266181283-1">(</span><span class="err">“</span><span class="o">-</span><span class="err">”</span><span class="p" data-group-id="1266181283-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="1266181283-2">(</span><span class="o">-</span><span class="nc">D</span><span class="w"> </span><span class="n">option</span><span class="p" data-group-id="1266181283-2">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">de</span><span class="err">‐</span><span class="w">
           </span><span class="n">termined</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">magic</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stdin</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">assumed</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w">  </span><span class="nc">Netlink</span><span class="w">
           </span><span class="ow">and</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="p" data-group-id="1266181283-3">(</span><span class="n">usec</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">nsec</span><span class="p" data-group-id="1266181283-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">wrapped</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">cooked</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="p" data-group-id="1266181283-4">[</span><span class="mi">2</span><span class="p" data-group-id="1266181283-4">]</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dev</span><span class="o">|</span><span class="n">pcap</span><span class="o">|</span><span class="n">dir</span><span class="o">|</span><span class="n">cfg</span><span class="o">|</span><span class="o">-&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dev</span><span class="o">|</span><span class="n">pcap</span><span class="o">|</span><span class="n">dir</span><span class="o">|</span><span class="n">cfg</span><span class="o">|</span><span class="o">-&gt;</span><span class="w">
           </span><span class="nc">Defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">folder</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">trafgen</span><span class="p" data-group-id="1266181283-5">(</span><span class="mi">8</span><span class="p" data-group-id="1266181283-5">)</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="p" data-group-id="1266181283-6">(</span><span class="err">“</span><span class="o">-</span><span class="err">”</span><span class="p" data-group-id="1266181283-6">)</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">out</span><span class="err">‐</span><span class="w">
           </span><span class="n">put</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">trafgen</span><span class="p" data-group-id="1266181283-7">(</span><span class="mi">8</span><span class="p" data-group-id="1266181283-7">)</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">strfime</span><span class="p" data-group-id="1266181283-8">(</span><span class="mi">3</span><span class="p" data-group-id="1266181283-8">)</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">conjunction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">F</span><span class="w">  </span><span class="n">op</span><span class="err">‐</span><span class="w">
           </span><span class="n">tion</span><span class="p">,</span><span class="w">  </span><span class="n">each</span><span class="w">  </span><span class="n">rotated</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unique</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="1266181283-9">(</span><span class="mh">0xa1b2c3d4</span><span class="p" data-group-id="1266181283-9">)</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">addi</span><span class="err">‐</span><span class="w">
           </span><span class="n">tional</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="o">-</span><span class="nc">T</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">provided</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="p">,</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">rotation</span><span class="w"> </span><span class="n">based</span><span class="w">
           </span><span class="n">on</span><span class="w">  </span><span class="n">maximum</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="p" data-group-id="1266181283-10">(</span><span class="o">-</span><span class="nc">F</span><span class="w"> </span><span class="n">option</span><span class="p" data-group-id="1266181283-10">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Optionally</span><span class="p">,</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">premature</span><span class="w"> </span><span class="n">rotation</span><span class="w"> </span><span class="n">of</span><span class="w">
           </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">trafgen</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">as</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">output</span><span class="w">  </span><span class="n">de</span><span class="err">‐</span><span class="w">
           </span><span class="n">vice</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="err">“</span><span class="o">.</span><span class="n">pcap</span><span class="err">”</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">extension</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">trafgen</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">input</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Netlink</span><span class="w"> </span><span class="n">monitor</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pcap</span><span class="w">  </span><span class="n">type</span><span class="w">
           </span><span class="n">is</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="p" data-group-id="1266181283-11">(</span><span class="n">usec</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">nsec</span><span class="p" data-group-id="1266181283-11">)</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">wrapped</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">cooked</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="p" data-group-id="1266181283-12">[</span><span class="mi">2</span><span class="p" data-group-id="1266181283-12">]</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="nc">Netlink</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p" data-group-id="1266181283-13">(</span><span class="nc">Kuznetzov</span><span class="sc">&#39;s and netsniff-ng pcap
           types already contain family number in protocol number field).

    -C &lt;id&gt;, --fanout-group &lt;id&gt;
           If multiple netsniff-ng instances are being started that all have the same packet fanout group id, then the ingress network traffic being captured  is
           being distributed/load-balanced among these group participants. This gives a much better scaling than running multiple netsniff-ng processes without a
           fanout group parameter in parallel, but only with a BPF filter attached as a packet would otherwise need to be delivered to all  such  capturing  pro‐
           cesses, instead of only once to such a fanout member. Naturally, each fanout member can have its own BPF filters attached.

    -K &lt;hash|lb|cpu|rnd|roll|qm&gt;, --fanout-type &lt;hash|lb|cpu|rnd|roll|qm&gt;
           This  parameter  specifies  the fanout discipline, in other words, how the captured network traffic is dispatched to the fanout group members. Options
           are to distribute traffic by the packet hash (“hash”), in a round-robin manner (“lb”), by CPU the packet arrived on (“cpu”),  by  random  (“rnd”),  by
           rolling over sockets (“roll”) which means if one socket&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">full</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">NIC</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="p" data-group-id="1266181283-14">(</span><span class="err">“</span><span class="n">qm</span><span class="err">”</span><span class="p" data-group-id="1266181283-14">)</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">L</span><span class="w"> </span><span class="o">&lt;</span><span class="n">defrag</span><span class="o">|</span><span class="n">roll</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">fanout</span><span class="o">-</span><span class="n">opts</span><span class="w"> </span><span class="o">&lt;</span><span class="n">defrag</span><span class="o">|</span><span class="n">roll</span><span class="o">&gt;</span><span class="w">
           </span><span class="nc">Defines</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">auxiliary</span><span class="w"> </span><span class="n">fanout</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">addition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">fanout</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">fanout</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">defrag</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">kernel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">told</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">defragment</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">delivering</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">space</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">“</span><span class="n">roll</span><span class="err">”</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">roll</span><span class="o">-</span><span class="n">over</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">“</span><span class="n">roll</span><span class="err">”</span><span class="w">  </span><span class="n">fanout</span><span class="w">  </span><span class="n">type</span><span class="p">,</span><span class="w">
           </span><span class="n">so</span><span class="w">  </span><span class="n">that</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">fanout</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="1266181283-15">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="err">“</span><span class="n">qm</span><span class="err">”</span><span class="p" data-group-id="1266181283-15">)</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">temporarily</span><span class="w"> </span><span class="n">roll</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">fanout</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">member</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w">
           </span><span class="n">one</span><span class="sc">&#39;s queue is full.

    -f, --filter &lt;bpf-file|-|expr&gt;
           Specifies to not dump all traffic, but to filter the network packet haystack.  As a filter, either a bpfc(8) compiled file/stdin can be  passed  as  a
           parameter  or  a  tcpdump(1)-like filter expression in quotes. For details regarding the bpf-file have a look at bpfc(8), for details regarding a tcp‐
           dump(1)-like filter have a look at section “filter example” or at pcap-filter(7).  A filter expression may also be passed to netsniff-ng  without  op‐
           tion -f in case there is no subsequent option following after the command-line filter expression.

    -t, --type &lt;type&gt;
           This  defines some sort of filtering mechanisms in terms of addressing. Possible values for type are “host” (to us), “broadcast” (to all), “multicast”
           (to group), “others” (promiscuous mode) or “outgoing” (from us).

    -F, --interval &lt;size|time&gt;
           If the output device is a folder, with “-F”, it is possible to define the pcap file rotation interval either in terms of size or time. Thus, when  the
           interval limit has been reached, a new pcap file will be started. As size parameter, the following values are accepted “&lt;num&gt;KiB/MiB/GiB”; As time pa‐
           rameter, it can be “&lt;num&gt;s/sec/min/hrs”.

    -J, --jumbo-support
           By default, in pcap replay or redirect mode, netsniff-ng&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">ring</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">2048</span><span class="w"> </span><span class="n">bytes</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">are</span><span class="w">  </span><span class="n">expecting</span><span class="w">
           </span><span class="n">jumbo</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">super</span><span class="w"> </span><span class="n">jumbo</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">However</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">has</span><span class="w">
           </span><span class="n">the</span><span class="w"> </span><span class="n">disadvantage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="n">degradation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bigger</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">footprint</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ring</span><span class="w"> </span><span class="n">buffer</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">doesn</span><span class="sc">&#39;t affect  (pcap)  capturing  mode,
           since tpacket in version 3 is used!

    -R, --rfraw
           In case the input or output networking device is a wireless device, it is possible with netsniff-ng to turn this into monitor mode and create a mon&lt;X&gt;
           device that netsniff-ng will be listening on instead of wlan&lt;X&gt;, for instance.  This enables netsniff-ng to analyze, dump, or even replay  raw  802.11
           frames.

    -n &lt;0|uint&gt;, --num &lt;0|uint&gt;
           Process  a  number  of packets and then exit. If the number of packets is 0, then this is equivalent to infinite packets resp. processing until inter‐
           rupted.  Otherwise, a number given as an unsigned integer will limit processing.

    -P &lt;name&gt;, --prefix &lt;name&gt;
           When dumping pcap files into a folder, a file name prefix can be defined with this option. If not otherwise specified, the default prefix  is  “dump-”
           followed by a Unix timestamp. Use “--prefex &quot;&quot;” to set filename as seconds since the Unix Epoch e.g. 1369179203.pcap

    -T &lt;pcap-magic&gt;, --magic &lt;pcap-magic&gt;
           Specify  a pcap type for storage. Different pcap types with their various meta data capabilities are shown with option -D. If not otherwise specified,
           the pcap-magic 0xa1b2c3d4, also known as a standard tcpdump-capable pcap format, is used. Pcap files with swapped endianness are also supported.

    -D, --dump-pcap-types
           Dump all available pcap types with their capabilities and magic numbers that can be used with option “-T” to stdout and exit.

    -B, --dump-bpf
           If a Berkeley Packet Filter is given, for example via option “-f”, then dump the BPF disassembly to stdout during ring setup. This only serves for in‐
           formative or verification purposes.

    -r, --rand
           If the input and output device are both networking devices, then this option will randomize packet order in the output ring buffer.

    -M, --no-promisc
           The networking interface will not be put into promiscuous mode. By default, promiscuous mode is turned on.

    -N, --no-hwtimestamp
           Disable  taking  hardware time stamps for RX packets. By default, if the network device supports hardware time stamping, the hardware time stamps will
           be used when writing packets to pcap files. This option disables this behavior and forces (kernel based) software time stamps  to  be  used,  even  if
           hardware time stamps are available.

    -A, --no-sock-mem
           On  startup  and shutdown, netsniff-ng tries to increase socket read and write buffers if appropriate. This option will prevent netsniff-ng from doing
           so.

    -m, --mmap
           Use mmap(2) as pcap file I/O. This is the default when replaying pcap files.

    -G, --sg
           Use scatter-gather as pcap file I/O. This is the default when capturing pcap files.

    -c, --clrw
           Use slower read(2) and write(2) I/O. This is not the default case anywhere, but in some situations it could be preferred as it has a lower latency  on
           write-back to disc.

    -S &lt;size&gt;, --ring-size &lt;size&gt;
           Manually define the RX_RING resp. TX_RING size in “&lt;num&gt;KiB/MiB/GiB”. By default, the size is determined based on the network connectivity rate.

    -k &lt;uint&gt;, --kernel-pull &lt;uint&gt;
           Manually  define  the  interval in micro-seconds where the kernel should be triggered to batch process the ring buffer frames. By default, it is every
           10us, but it can manually be prolonged, for instance.

    -b &lt;cpu&gt;, --bind-cpu &lt;cpu&gt;
           Pin netsniff-ng to a specific CPU and also pin resp. migrate the NIC&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">IRQ</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">affinity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="nc">CPU</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w">  </span><span class="n">preferred</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">combination</span><span class="w">
           </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">middle</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">expected</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="o">&lt;</span><span class="n">uid</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="o">&lt;</span><span class="n">uid</span><span class="o">&gt;</span><span class="w"> </span><span class="n">resp</span><span class="o">.</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">&lt;</span><span class="n">gid</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">group</span><span class="w"> </span><span class="o">&lt;</span><span class="n">gid</span><span class="o">&gt;</span><span class="w">
           </span><span class="nc">After</span><span class="w"> </span><span class="n">ring</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">root</span><span class="w"> </span><span class="n">user</span><span class="o">/</span><span class="n">group</span><span class="w"> </span><span class="n">combination</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">H</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">prio</span><span class="o">-</span><span class="n">high</span><span class="w">
           </span><span class="nc">Set</span><span class="w">  </span><span class="n">this</span><span class="w">  </span><span class="n">process</span><span class="w">  </span><span class="n">as</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">high</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">achieve</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">scheduling</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">resp</span><span class="o">.</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">setting</span><span class="p">,</span><span class="w">
           </span><span class="n">since</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">starvation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">processes</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">threads</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">Q</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">notouch</span><span class="o">-</span><span class="n">irq</span><span class="w">
           </span><span class="nc">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">reassign</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NIC</span><span class="sc">&#39;s IRQ CPU affinity settings.

    -s, --silent
           Do not enter the packet dissector at all and do not print any packet information to the terminal. Just shut up and be silent. This  option  should  be
           preferred in combination with pcap recording or replay, since it will not flood your terminal which causes a significant performance degradation.

    -q, --less
           Print a less verbose one-line information for each packet to the terminal.

    -X, --hex
           Only dump packets in hex format to the terminal.

    -l, --ascii
           Only display ASCII printable characters.

    -U, --update
           If  geographical IP location is used, the built-in database update mechanism will be invoked to get Maxmind&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">latest</span><span class="w"> </span><span class="n">database</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="n">lo</span><span class="err">‐</span><span class="w">
           </span><span class="n">cations</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">databases</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="o">/</span><span class="n">geoip</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">addresses</span><span class="o">.</span><span class="w"> </span><span class="nc">Thus</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="n">bandwidth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">mirroring</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="nc">Maxmind</span><span class="err">&#39;</span><span class="n">s</span><span class="w">  </span><span class="n">data</span><span class="err">‐</span><span class="w">
           </span><span class="n">bases</span><span class="w"> </span><span class="p" data-group-id="1266181283-16">(</span><span class="n">to</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">policy</span><span class="p" data-group-id="1266181283-16">)</span><span class="p">,</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">geoip</span><span class="o">.</span><span class="n">conf</span><span class="p">,</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">newline</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">cooked</span><span class="w">
           </span><span class="nc">Replace</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="s">&quot;cooked&quot;</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="p" data-group-id="1266181283-17">[</span><span class="mi">3</span><span class="p" data-group-id="1266181283-17">]</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">keeps</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dissect</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="n">cap</span><span class="err">‐</span><span class="w">
           </span><span class="n">tured</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="s">&quot;any&quot;</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">V</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">verbose</span><span class="w">
           </span><span class="nc">Be</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">startup</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">ring</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">information</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">version</span><span class="w">
           </span><span class="nc">Show</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">help</span><span class="w">
           </span><span class="nc">Show</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span></code></pre><h2 id="usage-example" class="section-heading">
  <a href="#usage-example" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  USAGE## EXAMPLE
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w">
           </span><span class="nc">The</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="err">“</span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="err">”</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">promiscuous</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">dump</span><span class="w">  </span><span class="n">the</span><span class="w">
           </span><span class="n">packet</span><span class="w"> </span><span class="n">dissector</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="o">.</span><span class="w"> </span><span class="nc">No</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">recorded</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="nc">T</span><span class="w"> </span><span class="mh">0xa1e2cb12</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">udp</span><span class="w">
           </span><span class="nc">Capture</span><span class="w">  </span><span class="nc">TCP</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="nc">UDP</span><span class="w">  </span><span class="n">traffic</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="p" data-group-id="2557774877-1">(</span><span class="n">see</span><span class="w">
           </span><span class="err">“</span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="nc">D</span><span class="err">”</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">capabilities</span><span class="p" data-group-id="2557774877-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Also</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="2557774877-2">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pin</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">NIC</span><span class="w"> </span><span class="nc">IRQ</span><span class="w"> </span><span class="n">affinity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w">  </span><span class="n">pcap</span><span class="w">  </span><span class="n">write</span><span class="w">
           </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">scatter</span><span class="o">-</span><span class="n">gather</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">wlan0</span><span class="w"> </span><span class="o">--</span><span class="n">rfraw</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">--</span><span class="n">silent</span><span class="w"> </span><span class="o">--</span><span class="n">bind</span><span class="o">-</span><span class="n">cpu</span><span class="w"> </span><span class="mi">0</span><span class="w">
           </span><span class="nc">Put</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">wlan0</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">monitoring</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="mf">802.11</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="o">.</span><span class="w"> </span><span class="nc">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">dissect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ter</span><span class="err">‐</span><span class="w">
           </span><span class="n">minal</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pin</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">NIC</span><span class="w"> </span><span class="nc">IRQ</span><span class="w"> </span><span class="n">affinity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">scatter</span><span class="o">-</span><span class="n">gather</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">--</span><span class="n">mmap</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">-</span><span class="n">k1000</span><span class="w"> </span><span class="o">--</span><span class="n">silent</span><span class="w"> </span><span class="o">--</span><span class="n">bind</span><span class="o">-</span><span class="n">cpu</span><span class="w"> </span><span class="mi">0</span><span class="w">
           </span><span class="nc">Replay</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">mmap</span><span class="p" data-group-id="2557774877-3">(</span><span class="mi">2</span><span class="p" data-group-id="2557774877-3">)</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">dissect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">content</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pin</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">NIC</span><span class="w"> </span><span class="nc">IRQ</span><span class="w"> </span><span class="n">affinity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w">  </span><span class="nc">Also</span><span class="p">,</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="mi">1000</span><span class="n">us</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">traverse</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TX_RING</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w">
           </span><span class="n">every</span><span class="w"> </span><span class="mi">10</span><span class="n">us</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">detected</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">header</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="n">eth1</span><span class="w"> </span><span class="o">--</span><span class="n">silent</span><span class="w"> </span><span class="o">--</span><span class="n">bind</span><span class="o">-</span><span class="n">cpu</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">--</span><span class="n">type</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w">
           </span><span class="nc">Redirect</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">eth1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">destined</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="n">thus</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="n">broadcast</span><span class="p">,</span><span class="w"> </span><span class="n">multicast</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">pro</span><span class="err">‐</span><span class="w">
           </span><span class="n">miscuous</span><span class="w">  </span><span class="n">traffic</span><span class="o">.</span><span class="w">  </span><span class="nc">Randomize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">outgoing</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k" data-group-id="2557774877-4">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="o">.</span><span class="w"> </span><span class="nc">Also</span><span class="p">,</span><span class="w"> </span><span class="n">pin</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w">
           </span><span class="ow">and</span><span class="w"> </span><span class="nc">NIC</span><span class="w"> </span><span class="nc">IRQ</span><span class="w"> </span><span class="n">affinity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">team0</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">probe</span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="o">--</span><span class="n">interval</span><span class="w"> </span><span class="mi">100</span><span class="nc">MiB</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="mi">0</span><span class="w">
           </span><span class="nc">Capture</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">aggregated</span><span class="w"> </span><span class="n">team0</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="mi">100</span><span class="nc">MiB</span><span class="w"> </span><span class="n">each</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">mmap</span><span class="p" data-group-id="2557774877-5">(</span><span class="mi">2</span><span class="p" data-group-id="2557774877-5">)</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="n">pcap</span><span class="w">
           </span><span class="n">write</span><span class="w">  </span><span class="n">method</span><span class="p">,</span><span class="w">  </span><span class="n">support</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="k">super</span><span class="w"> </span><span class="n">jumbo</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="p" data-group-id="2557774877-6">(</span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">here</span><span class="p" data-group-id="2557774877-6">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k" data-group-id="2557774877-7">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">captured</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="o">.</span><span class="w">
           </span><span class="nc">Pin</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">NIC</span><span class="w"> </span><span class="nc">IRQ</span><span class="w"> </span><span class="n">affinity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mh">0xa1b2c3d4</span><span class="w"> </span><span class="p" data-group-id="2557774877-8">(</span><span class="n">tcpdump</span><span class="o">-</span><span class="n">capable</span><span class="w"> </span><span class="n">pcap</span><span class="p" data-group-id="2557774877-8">)</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">vlan0</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="err">`</span><span class="n">id</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">bob</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="err">`</span><span class="n">id</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">bob</span><span class="err">`</span><span class="w">
           </span><span class="nc">Capture</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">vlan0</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">read</span><span class="p" data-group-id="2557774877-9">(</span><span class="mi">2</span><span class="p" data-group-id="2557774877-9">)</span><span class="p">,</span><span class="w"> </span><span class="n">write</span><span class="p" data-group-id="2557774877-10">(</span><span class="mi">2</span><span class="p" data-group-id="2557774877-10">)</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="2557774877-11">(</span><span class="n">slower</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">la</span><span class="err">‐</span><span class="w">
           </span><span class="n">tency</span><span class="p" data-group-id="2557774877-11">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Also</span><span class="p">,</span><span class="w">  </span><span class="k" data-group-id="2557774877-7">after</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">RX_RING</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">capture</span><span class="p">,</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="err">“</span><span class="n">bob</span><span class="err">”</span><span class="o">.</span><span class="w"> </span><span class="nc">Invoke</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">dissector</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">print</span><span class="w">
           </span><span class="n">packet</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">analysis</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="o">--</span><span class="n">filter</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">bpf</span><span class="w"> </span><span class="o">-</span><span class="nc">B</span><span class="w"> </span><span class="o">--</span><span class="n">ascii</span><span class="w"> </span><span class="o">-</span><span class="nc">V</span><span class="w">
           </span><span class="nc">Capture</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">low</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">bpfc</span><span class="p" data-group-id="2557774877-12">(</span><span class="mi">8</span><span class="p" data-group-id="2557774877-12">)</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">bpf</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">fil</span><span class="err">‐</span><span class="w">
           </span><span class="n">ter</span><span class="w">  </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">traffic</span><span class="o">.</span><span class="w"> </span><span class="nc">Super</span><span class="w"> </span><span class="n">jumbo</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">human</span><span class="w"> </span><span class="n">readable</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">ver</span><span class="err">‐</span><span class="w">
           </span><span class="n">bose</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">phase</span><span class="o">.</span><span class="w"> </span><span class="nc">Moreover</span><span class="p">,</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">BPF</span><span class="w"> </span><span class="n">disassembly</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">bpf</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">cfg</span><span class="w"> </span><span class="o">--</span><span class="n">silent</span><span class="w">
           </span><span class="nc">Convert</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">trafgen</span><span class="p" data-group-id="2557774877-13">(</span><span class="mi">8</span><span class="p" data-group-id="2557774877-13">)</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="w"> </span><span class="nc">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">beacon</span><span class="o">.</span><span class="n">bpf</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w">
           </span><span class="nc">Convert</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">trafgen</span><span class="p" data-group-id="2557774877-14">(</span><span class="mi">8</span><span class="p" data-group-id="2557774877-14">)</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stdout</span><span class="o">.</span><span class="w"> </span><span class="nc">However</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="2557774877-15">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">one</span><span class="w">
           </span><span class="n">that</span><span class="w">  </span><span class="n">passes</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">low</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="mf">802.11</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">beacon</span><span class="o">.</span><span class="n">bpf</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="nc">BPF</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">inside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">exten</span><span class="err">‐</span><span class="w">
           </span><span class="n">sions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">available</span><span class="o">.</span><span class="w">

    </span><span class="n">cat</span><span class="w"> </span><span class="n">foo</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w">
           </span><span class="nc">Read</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">stdin</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">trafgen</span><span class="p" data-group-id="2557774877-16">(</span><span class="mi">8</span><span class="p" data-group-id="2557774877-16">)</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stdout</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">nlmon0</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">dump</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w">
           </span><span class="nc">Capture</span><span class="w"> </span><span class="n">netlink</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">netlink</span><span class="w"> </span><span class="n">monitoring</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">beforehand</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">follwing</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">ip</span><span class="p" data-group-id="2557774877-17">(</span><span class="mi">1</span><span class="p" data-group-id="2557774877-17">)</span><span class="w">
           </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">iproute2</span><span class="w"> </span><span class="n">utility</span><span class="w"> </span><span class="ss">collection</span><span class="p">:</span><span class="w">

             </span><span class="n">modprobe</span><span class="w"> </span><span class="n">nlmon</span><span class="w">
             </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">nlmon</span><span class="w">
             </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">nlmon0</span><span class="w"> </span><span class="n">up</span><span class="w">

           </span><span class="nc">To</span><span class="w"> </span><span class="n">tear</span><span class="w"> </span><span class="n">down</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">nlmon0</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

             </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">nlmon0</span><span class="w"> </span><span class="n">down</span><span class="w">
             </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">del</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="n">nlmon0</span><span class="w">
             </span><span class="n">rmmod</span><span class="w"> </span><span class="n">nlmon</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">--</span><span class="n">fanout</span><span class="o">-</span><span class="n">group</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">--</span><span class="n">fanout</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">cpu</span><span class="w"> </span><span class="o">--</span><span class="n">fanout</span><span class="o">-</span><span class="n">opts</span><span class="w"> </span><span class="n">defrag</span><span class="w"> </span><span class="o">--</span><span class="n">bind</span><span class="o">-</span><span class="n">cpu</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">--</span><span class="n">notouch</span><span class="o">-</span><span class="n">irq</span><span class="w"> </span><span class="o">--</span><span class="n">silent</span><span class="w"> </span><span class="o">--</span><span class="ow">in</span><span class="w"> </span><span class="n">em1</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cap</span><span class="o">/</span><span class="n">cpu0</span><span class="o">/</span><span class="w"> </span><span class="o">--</span><span class="n">interval</span><span class="w"> </span><span class="mi">120</span><span class="n">sec</span><span class="w">
           </span><span class="nc">Start</span><span class="w">  </span><span class="n">two</span><span class="w">  </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w">  </span><span class="n">fanout</span><span class="w"> </span><span class="n">instances</span><span class="o">.</span><span class="w"> </span><span class="nc">Both</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">fanout</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">membership</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">splitted</span><span class="w"> </span><span class="n">among</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">cpu</span><span class="o">.</span><span class="w">
           </span><span class="nc">Furthermore</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supposed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">defragment</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">fragments</span><span class="o">.</span><span class="w"> </span><span class="nc">First</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="nc">CPU</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="nc">IRQ</span><span class="w">
           </span><span class="n">bindings</span><span class="w">  </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">altered</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">adapted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">scenario</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">a</span><span class="o">-</span><span class="n">priori</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">captured</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">em1</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">written</span><span class="w">
           </span><span class="n">out</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">120</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">intervals</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cap</span><span class="o">/</span><span class="n">cpu0</span><span class="o">/</span><span class="o">.</span><span class="w"> </span><span class="nc">Tools</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">mergecap</span><span class="p" data-group-id="2557774877-18">(</span><span class="mi">1</span><span class="p" data-group-id="2557774877-18">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">merge</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cpu0</span><span class="o">/</span><span class="mi">1</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">needed</span><span class="o">.</span></code></pre><p> CONFIG## FILES</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">Files</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="o">/</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">extend</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="ss">functionality</span><span class="p">:</span><span class="w">

        </span><span class="o">*</span><span class="w"> </span><span class="n">oui</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">OUI</span><span class="o">/</span><span class="nc">MAC</span><span class="w"> </span><span class="n">vendor</span><span class="w"> </span><span class="n">database</span><span class="w">
        </span><span class="o">*</span><span class="w"> </span><span class="n">ether</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">descriptions</span><span class="w">
        </span><span class="o">*</span><span class="w"> </span><span class="n">tcp</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">port</span><span class="o">/</span><span class="n">services</span><span class="w"> </span><span class="n">map</span><span class="w">
        </span><span class="o">*</span><span class="w"> </span><span class="n">udp</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">port</span><span class="o">/</span><span class="n">services</span><span class="w"> </span><span class="n">map</span><span class="w">
        </span><span class="o">*</span><span class="w"> </span><span class="n">geoip</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">GeoIP</span><span class="w"> </span><span class="n">database</span><span class="w"> </span><span class="n">mirrors</span></code></pre><p> FILTER## EXAMPLE</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">both</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">high</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">attached</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">packet</span><span class="p" data-group-id="9473478134-1">(</span><span class="mi">7</span><span class="p" data-group-id="9473478134-1">)</span><span class="w"> </span><span class="n">socket</span><span class="o">.</span><span class="w"> </span><span class="nc">Low</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">described</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">bpfc</span><span class="p" data-group-id="9473478134-2">(</span><span class="mi">8</span><span class="p" data-group-id="9473478134-2">)</span><span class="w">  </span><span class="n">man</span><span class="w">
    </span><span class="n">page</span><span class="o">.</span><span class="w">

    </span><span class="nc">Low</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">way</span><span class="p">:</span><span class="w">

        </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">bpfc</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bar</span><span class="w">
        </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">bar</span><span class="w">
        </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">bpfc</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">nlmon0</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="o">-</span><span class="w">

    </span><span class="nc">Here</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bpfc</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">translated</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">readable</span><span class="w"> </span><span class="err">“</span><span class="n">opcodes</span><span class="err">”</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

    </span><span class="nc">Similarly</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="s">&quot;tcp or udp&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">“</span><span class="o">-</span><span class="n">f</span><span class="err">”</span><span class="o">.</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tcpdump</span><span class="p" data-group-id="9473478134-3">(</span><span class="mi">8</span><span class="p" data-group-id="9473478134-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">man</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">pcap</span><span class="o">-</span><span class="n">filter</span><span class="p" data-group-id="9473478134-4">(</span><span class="mi">7</span><span class="p" data-group-id="9473478134-4">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Just</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">quote</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="ss">examples</span><span class="p">:</span><span class="w">

    </span><span class="n">host</span><span class="w"> </span><span class="n">sundown</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">arriving</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">departing</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">sundown</span><span class="o">.</span><span class="w">

    </span><span class="n">host</span><span class="w"> </span><span class="n">helios</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p" data-group-id="9473478134-5">(</span><span class="n">hot</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">ace</span><span class="p" data-group-id="9473478134-5">)</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">helios</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">hot</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">ace</span><span class="o">.</span><span class="w">

    </span><span class="n">ip</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">ace</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">helios</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">ace</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="n">helios</span><span class="o">.</span><span class="w">

    </span><span class="n">net</span><span class="w"> </span><span class="n">ucb</span><span class="o">-</span><span class="n">ether</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="nc">Berkeley</span><span class="o">.</span><span class="w">

    </span><span class="n">gateway</span><span class="w"> </span><span class="n">snup</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p" data-group-id="9473478134-6">(</span><span class="n">port</span><span class="w"> </span><span class="n">ftp</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">ftp</span><span class="o">-</span><span class="n">data</span><span class="p" data-group-id="9473478134-6">)</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">FTP</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="nc">Internet</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">snup</span><span class="o">.</span><span class="w">

    </span><span class="n">ip</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">localnet</span><span class="w">
           </span><span class="nc">To</span><span class="w">  </span><span class="n">select</span><span class="w">  </span><span class="n">traffic</span><span class="w">  </span><span class="n">neither</span><span class="w">  </span><span class="n">sourced</span><span class="w"> </span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">destined</span><span class="w"> </span><span class="k">for</span><span class="p">,</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">hosts</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">it</span><span class="w">
           </span><span class="n">onto</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">network</span><span class="o">.</span><span class="w">

    </span><span class="n">tcp</span><span class="p" data-group-id="9473478134-7">[</span><span class="n">tcpflags</span><span class="p" data-group-id="9473478134-7">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p" data-group-id="9473478134-8">(</span><span class="n">tcp</span><span class="o">-</span><span class="n">syn</span><span class="o">|</span><span class="n">tcp</span><span class="o">-</span><span class="n">fin</span><span class="p" data-group-id="9473478134-8">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">src</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dst</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">localnet</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="9473478134-9">(</span><span class="n">the</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">FIN</span><span class="w"> </span><span class="n">packets</span><span class="p" data-group-id="9473478134-9">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">conversation</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">involve</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">local</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w">

    </span><span class="n">tcp</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p" data-group-id="9473478134-10">(</span><span class="p" data-group-id="9473478134-11">(</span><span class="p" data-group-id="9473478134-12">(</span><span class="n">ip</span><span class="p" data-group-id="9473478134-13">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p" data-group-id="9473478134-13">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p" data-group-id="9473478134-14">(</span><span class="p" data-group-id="9473478134-15">(</span><span class="n">ip</span><span class="p" data-group-id="9473478134-16">[</span><span class="mi">0</span><span class="p" data-group-id="9473478134-16">]</span><span class="ni">&amp;0</span><span class="n">xf</span><span class="p" data-group-id="9473478134-15">)</span><span class="p" data-group-id="9473478134-17">&lt;&lt;</span><span class="mi">2</span><span class="p">)</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p" data-group-id="9473478134-18">(</span><span class="p" data-group-id="9473478134-19">(</span><span class="n">tcp</span><span class="p" data-group-id="9473478134-20">[</span><span class="mi">12</span><span class="p" data-group-id="9473478134-20">]</span><span class="ni">&amp;0</span><span class="n">xf0</span><span class="p" data-group-id="9473478134-19">)</span><span class="p">&gt;&gt;</span><span class="mi">2</span><span class="p" data-group-id="9473478134-18">)</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">say</span><span class="p">,</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">FIN</span><span class="w">  </span><span class="n">packets</span><span class="w">  </span><span class="ow">and</span><span class="w">
           </span><span class="nc">ACK</span><span class="o">-</span><span class="n">only</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">  </span><span class="p" data-group-id="9473478134-21">(</span><span class="nc">IPv6</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exercise</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reader</span><span class="o">.</span><span class="p" data-group-id="9473478134-21">)</span><span class="w">

    </span><span class="n">gateway</span><span class="w"> </span><span class="n">snup</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ip</span><span class="p" data-group-id="9473478134-22">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p" data-group-id="9473478134-22">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">576</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">576</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">snup</span><span class="o">.</span><span class="w">

    </span><span class="n">ether</span><span class="p" data-group-id="9473478134-23">[</span><span class="mi">0</span><span class="p" data-group-id="9473478134-23">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ip</span><span class="p" data-group-id="9473478134-24">[</span><span class="mi">16</span><span class="p" data-group-id="9473478134-24">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">224</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">multicast</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">multicast</span><span class="o">.</span><span class="w">

    </span><span class="n">icmp</span><span class="p" data-group-id="9473478134-25">[</span><span class="n">icmptype</span><span class="p" data-group-id="9473478134-25">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">icmp</span><span class="o">-</span><span class="n">echo</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">icmp</span><span class="p" data-group-id="9473478134-26">[</span><span class="n">icmptype</span><span class="p" data-group-id="9473478134-26">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">icmp</span><span class="o">-</span><span class="n">echoreply</span><span class="w">
           </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">ICMP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="p" data-group-id="9473478134-27">(</span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">say</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="s">&quot;ping&quot;</span><span class="w"> </span><span class="n">packets</span><span class="p" data-group-id="9473478134-27">)</span><span class="o">.</span></code></pre><p> PCAP FORMATS:</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">couple</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">formats</span><span class="p">,</span><span class="w"> </span><span class="n">visible</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="o">-</span><span class="nc">D</span><span class="ss">&#39;&#39;</span><span class="p">:</span><span class="w">

    </span><span class="n">tcpdump</span><span class="o">-</span><span class="n">capable</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="p" data-group-id="6899825339-1">(</span><span class="n">default</span><span class="p" data-group-id="6899825339-1">)</span><span class="w">
           </span><span class="nc">Pcap</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mh">0xa1b2c3d4</span><span class="w"> </span><span class="n">resp</span><span class="o">.</span><span class="w"> </span><span class="mh">0xd4c3b2a1</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timeval</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">microseconds</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">packet</span><span class="w">
           </span><span class="n">length</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">captured</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">length</span><span class="o">.</span><span class="w">

    </span><span class="n">tcpdump</span><span class="o">-</span><span class="n">capable</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="n">resolution</span><span class="w">
           </span><span class="nc">Pcap</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mh">0xa1b23c4d</span><span class="w"> </span><span class="n">resp</span><span class="o">.</span><span class="w"> </span><span class="mh">0x4d3cb2a1</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timeval</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">nanoseconds</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w">  </span><span class="n">packet</span><span class="w">
           </span><span class="n">length</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">captured</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">length</span><span class="o">.</span><span class="w">

    </span><span class="nc">Alexey</span><span class="w"> </span><span class="nc">Kuznetzov</span><span class="sc">&#39;s pcap
           Pcap magic number is encoded as 0xa1b2cd34 resp. 0x34cdb2a1. As packet meta data this format contains the timeval in microseconds, the original packet
           length, the captured packet length, the interface index (sll_ifindex), the packet&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="p" data-group-id="6899825339-2">(</span><span class="n">sll_protocol</span><span class="p" data-group-id="6899825339-2">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="6899825339-3">(</span><span class="n">sll_pkttype</span><span class="p" data-group-id="6899825339-3">)</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">pcap</span><span class="w">
           </span><span class="nc">Pcap</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mh">0xa1e2cb12</span><span class="w"> </span><span class="n">resp</span><span class="o">.</span><span class="w"> </span><span class="mh">0x12cbe2a1</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timeval</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">nanoseconds</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w">  </span><span class="n">packet</span><span class="w">
           </span><span class="n">length</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">captured</span><span class="w">  </span><span class="n">packet</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="n">hw</span><span class="o">/</span><span class="n">sw</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p" data-group-id="6899825339-4">(</span><span class="n">sll_ifindex</span><span class="p" data-group-id="6899825339-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="p" data-group-id="6899825339-5">(</span><span class="n">sll_protocol</span><span class="p" data-group-id="6899825339-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w">
           </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="6899825339-6">(</span><span class="n">sll_pkttype</span><span class="p" data-group-id="6899825339-6">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="6899825339-7">(</span><span class="n">sll_hatype</span><span class="p" data-group-id="6899825339-7">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">For</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">application</span><span class="p">,</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">pcap_io</span><span class="o">.</span><span class="n">h</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">sources</span><span class="o">.</span></code></pre><p> NOTE</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">To</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">confusion</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">noted</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">analyzer</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="nc">NetSniff</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">unrelated</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w">
    </span><span class="n">project</span><span class="o">.</span><span class="w">

    </span><span class="nc">For</span><span class="w"> </span><span class="n">introducing</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">errors</span><span class="p">,</span><span class="w"> </span><span class="n">delays</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">variation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">replaying</span><span class="w"> </span><span class="n">pcaps</span><span class="p">,</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tc</span><span class="p" data-group-id="1299301809-1">(</span><span class="mi">8</span><span class="p" data-group-id="1299301809-1">)</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">disciplines</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">netem</span><span class="o">.</span><span class="w">

    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">basic</span><span class="p">,</span><span class="w"> </span><span class="n">architecture</span><span class="w"> </span><span class="n">generic</span><span class="w"> </span><span class="n">tuning</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">startup</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">considering</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="1299301809-2">do</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="n">capturing</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">carefully</span><span class="w"> </span><span class="n">tune</span><span class="w">
    </span><span class="n">your</span><span class="w"> </span><span class="n">machine</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">software</span><span class="o">.</span><span class="w">  </span><span class="nc">Simply</span><span class="w"> </span><span class="n">letting</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">thinking</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">necessarily</span><span class="w">  </span><span class="n">give</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">the</span><span class="w">
    </span><span class="n">desired</span><span class="w">  </span><span class="n">performance</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">tuning</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tradeoff</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">fine</span><span class="o">-</span><span class="n">grained</span><span class="w"> </span><span class="n">balancing</span><span class="w"> </span><span class="n">act</span><span class="w"> </span><span class="p" data-group-id="1299301809-3">(</span><span class="n">throughput</span><span class="w"> </span><span class="n">versus</span><span class="w"> </span><span class="n">latency</span><span class="p" data-group-id="1299301809-3">)</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">you</span><span class="w">
    </span><span class="n">are</span><span class="w"> </span><span class="n">doing!</span><span class="w">

    </span><span class="nc">One</span><span class="w"> </span><span class="n">recommendation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">software</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">tuning</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">tuned</span><span class="p" data-group-id="1299301809-4">(</span><span class="mi">8</span><span class="p" data-group-id="1299301809-4">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Besides</span><span class="w"> </span><span class="n">that</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">things</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">consider</span><span class="o">.</span><span class="w"> </span><span class="nc">Just</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="n">few</span><span class="w">  </span><span class="n">things</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">you</span><span class="w">
    </span><span class="n">might</span><span class="w">  </span><span class="n">want</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="ss">at</span><span class="p">:</span><span class="w"> </span><span class="nc">NAPI</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">drivers</span><span class="p">,</span><span class="w"> </span><span class="n">tickless</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">OAT</span><span class="w"> </span><span class="nc">DMA</span><span class="w"> </span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="nc">Direct</span><span class="w"> </span><span class="nc">Cache</span><span class="w"> </span><span class="nc">Access</span><span class="p">,</span><span class="w"> </span><span class="nc">RAM</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">systems</span><span class="p">,</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">queues</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">more</span><span class="w">
    </span><span class="n">things</span><span class="o">.</span><span class="w"> </span><span class="nc">Also</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="sc">&#39;s Documentation/networking/scaling.txt file regarding technologies such as RSS, RPS, RFS, aRFS and XPS.  Also
    check your ethtool(8) settings, for example regarding offloading or Ethernet pause frames.

    Moreover,  to  get  a  deeper  understanding  of  netsniff-ng internals and how it interacts with the Linux kernel, the kernel documentation under Documenta‐
    tion/networking/{packet_mmap.txt, filter.txt, multiqueue.txt} might be of interest.

    How do you sniff in a switched environment? I rudely refer to dSniff&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="ss">says</span><span class="p">:</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">easiest</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">simply</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">impersonate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">gateway</span><span class="p">,</span><span class="w"> </span><span class="n">stealing</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">en</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">destination</span><span class="o">.</span><span class="w"> </span><span class="nc">Of</span><span class="w"> </span><span class="n">course</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">traffic</span><span class="w">  </span><span class="n">must</span><span class="w">  </span><span class="n">be</span><span class="w">
    </span><span class="n">forwarded</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">attacking</span><span class="w"> </span><span class="n">machine</span><span class="p">,</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">enabling</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">forwarding</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">userland</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">accomplishes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="p" data-group-id="1299301809-5">(</span><span class="n">fragrouter</span><span class="w"> </span><span class="o">-</span><span class="nc">B1</span><span class="p" data-group-id="1299301809-5">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">Several</span><span class="w">  </span><span class="n">people</span><span class="w">  </span><span class="n">have</span><span class="w"> </span><span class="n">reportedly</span><span class="w"> </span><span class="n">destroyed</span><span class="w"> </span><span class="n">connectivity</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="nc">LAN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">world</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">ARP</span><span class="w"> </span><span class="n">spoofing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">gateway</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">forgetting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">forwarding</span><span class="w">
    </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">attacking</span><span class="w"> </span><span class="n">machine</span><span class="o">.</span><span class="w"> </span><span class="nc">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k" data-group-id="1299301809-6">do</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">warned</span><span class="o">.</span><span class="w">

    </span><span class="nc">A</span><span class="w"> </span><span class="n">safer</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="nc">ARP</span><span class="w"> </span><span class="n">spoofing</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;port mirror&quot;</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">switch</span><span class="o">.</span><span class="w">

    </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k" data-group-id="1299301809-7">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">traffic</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">BPF</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ingress</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">purpose</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="w">  </span><span class="n">the</span><span class="w">
    </span><span class="n">bpfc</span><span class="p" data-group-id="1299301809-8">(</span><span class="mi">8</span><span class="p" data-group-id="1299301809-8">)</span><span class="w"> </span><span class="n">man</span><span class="w"> </span><span class="n">page</span><span class="o">.</span><span class="w">

    </span><span class="nc">Also</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">aggregate</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="nc">NICs</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">on</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">team</span><span class="w"> </span><span class="n">devices</span><span class="p">,</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">explained</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">libteam</span><span class="w"> </span><span class="n">resp</span><span class="o">.</span><span class="w">  </span><span class="n">teamd</span><span class="p" data-group-id="1299301809-9">(</span><span class="mi">8</span><span class="p" data-group-id="1299301809-9">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">compatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tools</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ss">Wireshark</span><span class="p">:</span><span class="w">

        </span><span class="mh">0xa1b2c3d4</span><span class="w"> </span><span class="p" data-group-id="1299301809-10">(</span><span class="n">tcpdump</span><span class="o">-</span><span class="n">capable</span><span class="w"> </span><span class="n">pcap</span><span class="p" data-group-id="1299301809-10">)</span><span class="w">
        </span><span class="mh">0xa1b23c4d</span><span class="w"> </span><span class="p" data-group-id="1299301809-11">(</span><span class="n">tcpdump</span><span class="o">-</span><span class="n">capable</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="n">resolution</span><span class="p" data-group-id="1299301809-11">)</span><span class="w">
        </span><span class="mh">0xa1b2cd34</span><span class="w"> </span><span class="p" data-group-id="1299301809-12">(</span><span class="nc">Alexey</span><span class="w"> </span><span class="nc">Kuznetzov</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">pcap</span><span class="p" data-group-id="1299301809-12">)</span><span class="w">

    </span><span class="nc">Pcap</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">endianness</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span></code></pre><h2 id="bugs" class="section-heading">
  <a href="#bugs" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  BUGS
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">When</span><span class="w"> </span><span class="n">replaying</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timing</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">ignored</span><span class="o">.</span><span class="w">

    </span><span class="nc">Also</span><span class="p">,</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">replaying</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">demultiplexing</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">among</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">work</span><span class="o">.</span><span class="w"> </span><span class="nc">Currently</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">that</span><span class="w">
    </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">out</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w">

    </span><span class="nc">When</span><span class="w"> </span><span class="n">performing</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">interface</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">without</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="mf">802.1</span><span class="nc">Q</span><span class="w">  </span><span class="n">header</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w">  </span><span class="n">one</span><span class="w">  </span><span class="n">uses</span><span class="w">
    </span><span class="n">tshark</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">visible</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">removes</span><span class="w"> </span><span class="mf">802.1</span><span class="nc">Q</span><span class="w"> </span><span class="n">headers</span><span class="o">.</span><span class="w"> </span><span class="nc">Is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">behavior?</span><span class="w">

    </span><span class="nc">Yes</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">no</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">PF_PACKET</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">somewhat</span><span class="w"> </span><span class="err">“</span><span class="n">problematic</span><span class="err">”</span><span class="w"> </span><span class="p" data-group-id="1817581024-1">[</span><span class="mi">1</span><span class="p" data-group-id="1817581024-1">]</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">some</span><span class="w">
    </span><span class="n">drivers</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="nc">VLANs</span><span class="p">,</span><span class="w"> </span><span class="n">others</span><span class="w"> </span><span class="k" data-group-id="1817581024-2">do</span><span class="w"> </span><span class="ow">not</span><span class="o">.</span><span class="w"> </span><span class="nc">Those</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">implementations</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">acceleration</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">so</span><span class="w">  </span><span class="n">on</span><span class="o">.</span><span class="w">   </span><span class="nc">So</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">some</span><span class="w">
    </span><span class="n">cases</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">VLAN</span><span class="w">  </span><span class="n">tag</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">even</span><span class="w">  </span><span class="n">stripped</span><span class="w">  </span><span class="n">before</span><span class="w"> </span><span class="n">entering</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">stack</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="ow">not</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">bottom</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;hack&quot;</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">introduced</span><span class="w"> </span><span class="ow">in</span><span class="w">
    </span><span class="nc">PF_PACKET</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">visible</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">structure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">accessible</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">RX_RING</span><span class="o">.</span><span class="w">

    </span><span class="nc">Then</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">messy</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">artificially</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">place</span><span class="o">.</span><span class="w"> </span><span class="nc">Not</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">mention</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resulting</span><span class="w"> </span><span class="n">performance</span><span class="w">  </span><span class="n">implica</span><span class="err">‐</span><span class="w">
    </span><span class="n">tions</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">libpcap</span><span class="p" data-group-id="1817581024-3">(</span><span class="mi">3</span><span class="p" data-group-id="1817581024-3">)</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">copied</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">reassembly</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">memmove</span><span class="p" data-group-id="1817581024-4">(</span><span class="mi">3</span><span class="p" data-group-id="1817581024-4">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">A</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">reported</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="p">,</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">demonstrate</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ss">mess</span><span class="p">:</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">machines</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">seems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="n">depend</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="n">...</span><span class="w">

        </span><span class="ss">AR8131</span><span class="p">:</span><span class="w">
          </span><span class="n">ethtool</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">gives</span><span class="w"> </span><span class="s">&quot;rx-vlan-offload: on&quot;</span><span class="w">
          </span><span class="o">-</span><span class="w"> </span><span class="n">wireshark</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vlan</span><span class="w"> </span><span class="n">header</span><span class="w">
          </span><span class="o">-</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">doesn</span><span class="sc">&#39;t get the vlan header
          ethtool -K eth0 rxvlan off
          - wireshark gets a QinQ header even though no one sent QinQ
          - netsniff-ng gets the vlan header

        RTL8111/8168B:
          ethtool -k eth0 gives &quot;rx-vlan-offload: on&quot;
          - wireshark gets the vlan header
          - netsniff-ng doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vlan</span><span class="w"> </span><span class="n">header</span><span class="w">
          </span><span class="n">ethtool</span><span class="w"> </span><span class="o">-</span><span class="nc">K</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">rxvlan</span><span class="w"> </span><span class="n">off</span><span class="w">
          </span><span class="o">-</span><span class="w"> </span><span class="n">wireshark</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vlan</span><span class="w"> </span><span class="n">header</span><span class="w">
          </span><span class="o">-</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">doesn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vlan</span><span class="w"> </span><span class="n">header</span><span class="w">

    </span><span class="nc">Even</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="n">we</span><span class="w">  </span><span class="n">agreed</span><span class="w">  </span><span class="n">on</span><span class="w"> </span><span class="n">doing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">workaround</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">libpcap</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="nc">QinQ</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fact</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">is</span><span class="w">
    </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">structure</span><span class="o">.</span><span class="w"> </span><span class="nc">We</span><span class="w"> </span><span class="n">think</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">consensus</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">transferred</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">userland</span><span class="w">
    </span><span class="n">first</span><span class="o">.</span><span class="w">

    </span><span class="nc">Update</span><span class="w"> </span><span class="p" data-group-id="1817581024-5">(</span><span class="mf">28.11</span><span class="o">.</span><span class="mi">2012</span><span class="p" data-group-id="1817581024-5">)</span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">bpfc</span><span class="p" data-group-id="1817581024-6">(</span><span class="mi">8</span><span class="p" data-group-id="1817581024-6">)</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">accelerated</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="n">filtering</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">tags</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">visible</span><span class="w"> </span><span class="ow">in</span><span class="w">
    </span><span class="n">the</span><span class="w"> </span><span class="n">payload</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">reported</span><span class="w"> </span><span class="n">here</span><span class="o">.</span><span class="w"> </span><span class="nc">However</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filtering</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">VLANs</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">reliable</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="nc">NIC</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">bpfc</span><span class="p" data-group-id="1817581024-7">(</span><span class="mi">8</span><span class="p" data-group-id="1817581024-7">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">example</span><span class="o">.</span><span class="w">

       </span><span class="p" data-group-id="1817581024-8">[</span><span class="mi">1</span><span class="p" data-group-id="1817581024-8">]</span><span class="w"> </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">lkml</span><span class="o">.</span><span class="n">indiana</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">hypermail</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="mf">0710.3</span><span class="o">/</span><span class="mi">3816</span><span class="o">.</span><span class="n">html</span><span class="w">
       </span><span class="p" data-group-id="1817581024-9">[</span><span class="mi">2</span><span class="p" data-group-id="1817581024-9">]</span><span class="w"> </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">tcpdump</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">linktypes</span><span class="o">/</span><span class="nc">LINKTYPE_NETLINK</span><span class="o">.</span><span class="n">html</span><span class="w">
       </span><span class="p" data-group-id="1817581024-10">[</span><span class="mi">3</span><span class="p" data-group-id="1817581024-10">]</span><span class="w"> </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">tcpdump</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">linktypes</span><span class="o">/</span><span class="nc">LINKTYPE_LINUX_SLL</span><span class="o">.</span><span class="n">html</span></code></pre><p> LEGAL</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">licensed</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">GNU</span><span class="w"> </span><span class="nc">GPL</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">2.0</span><span class="o">.</span></code></pre><p> HISTORY</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">originally</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">toolkit</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Daniel</span><span class="w"> </span><span class="nc">Borkmann</span><span class="o">.</span><span class="w"> </span><span class="nc">Bigger</span><span class="w"> </span><span class="n">contributions</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Emmanuel</span><span class="w"> </span><span class="nc">Roullit</span><span class="p">,</span><span class="w"> </span><span class="nc">Markus</span><span class="w">  </span><span class="nc">Amend</span><span class="p">,</span><span class="w">  </span><span class="nc">Tobias</span><span class="w">
    </span><span class="nc">Klauser</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Christoph</span><span class="w"> </span><span class="nc">Jaeger</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">maintained</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Tobias</span><span class="w"> </span><span class="nc">Klauser</span><span class="w"> </span><span class="o">&lt;</span><span class="n">tklauser</span><span class="na">@distanz</span><span class="o">.</span><span class="n">ch</span><span class="o">&gt;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Daniel</span><span class="w"> </span><span class="nc">Borkmann</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dborkma</span><span class="na">@tik</span><span class="o">.</span><span class="n">ee</span><span class="o">.</span><span class="n">ethz</span><span class="o">.</span><span class="n">ch</span><span class="o">&gt;</span><span class="o">.</span></code></pre><h2 id="see-also" class="section-heading">
  <a href="#see-also" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  SEE ALSO
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">trafgen</span><span class="p" data-group-id="3198865302-1">(</span><span class="mi">8</span><span class="p" data-group-id="3198865302-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">mausezahn</span><span class="p" data-group-id="3198865302-2">(</span><span class="mi">8</span><span class="p" data-group-id="3198865302-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">ifpps</span><span class="p" data-group-id="3198865302-3">(</span><span class="mi">8</span><span class="p" data-group-id="3198865302-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">bpfc</span><span class="p" data-group-id="3198865302-4">(</span><span class="mi">8</span><span class="p" data-group-id="3198865302-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">flowtop</span><span class="p" data-group-id="3198865302-5">(</span><span class="mi">8</span><span class="p" data-group-id="3198865302-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">astraceroute</span><span class="p" data-group-id="3198865302-6">(</span><span class="mi">8</span><span class="p" data-group-id="3198865302-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">curvetun</span><span class="p" data-group-id="3198865302-7">(</span><span class="mi">8</span><span class="p" data-group-id="3198865302-7">)</span></code></pre><h2 id="author" class="section-heading">
  <a href="#author" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  AUTHOR
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">Manpage</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Daniel</span><span class="w"> </span><span class="nc">Borkmann</span><span class="o">.</span></code></pre><p> COLOPHON</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">This</span><span class="w">  </span><span class="n">page</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">netsniff</span><span class="o">-</span><span class="n">ng</span><span class="w"> </span><span class="n">toolkit</span><span class="w"> </span><span class="n">project</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">project</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">reporting</span><span class="w"> </span><span class="n">bugs</span><span class="p">,</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">net</span><span class="err">‐</span><span class="w">
    </span><span class="n">sniff</span><span class="o">-</span><span class="n">ng</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="o">.</span></code></pre><p> Linux                                                                       03 March 2013                                                             NETSNIFF-NG(8)</p>      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.23.0) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>
