<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="Manpages v3.0.0">


    <title>traceroute — Manpages v3.0.0</title>

    <link rel="stylesheet" href="dist/html-elixir-KV3YOVJ3.css" />

    <script defer src="dist/sidebar_items-65F766E3.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>
<link rel="stylesheet" href="assets/doc.css">
  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Manpages" />
        </a>

      <div>
        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectName" translate="no">
Manpages
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v3.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras="MANUALS"></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Manpages</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>traceroute</h1>


  </div>


<p>TRACEROUTE(1)                                                                        Traceroute For Linux                                                                        TRACEROUTE(1)</p><p>NAME</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">traceroute</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">host</span></code></pre><p>SYNOPSIS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">traceroute</span><span class="w"> </span><span class="p" data-group-id="1285769131-1">[</span><span class="o">-</span><span class="mi">46</span><span class="n">dFITUnreAV</span><span class="p" data-group-id="1285769131-1">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-2">[</span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">first_ttl</span><span class="p" data-group-id="1285769131-2">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-3">[</span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">gate</span><span class="p">,</span><span class="n">...</span><span class="p" data-group-id="1285769131-3">]</span><span class="w">
           </span><span class="p" data-group-id="1285769131-4">[</span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">device</span><span class="p" data-group-id="1285769131-4">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-5">[</span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">max_ttl</span><span class="p" data-group-id="1285769131-5">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-6">[</span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">port</span><span class="p" data-group-id="1285769131-6">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-7">[</span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">src_addr</span><span class="p" data-group-id="1285769131-7">]</span><span class="w">
           </span><span class="p" data-group-id="1285769131-8">[</span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="n">nqueries</span><span class="p" data-group-id="1285769131-8">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-9">[</span><span class="o">-</span><span class="nc">N</span><span class="w"> </span><span class="n">squeries</span><span class="p" data-group-id="1285769131-9">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-10">[</span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">tos</span><span class="p" data-group-id="1285769131-10">]</span><span class="w">
           </span><span class="p" data-group-id="1285769131-11">[</span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">flow_label</span><span class="p" data-group-id="1285769131-11">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-12">[</span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">waittimes</span><span class="p" data-group-id="1285769131-12">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-13">[</span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="n">sendwait</span><span class="p" data-group-id="1285769131-13">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-14">[</span><span class="o">-</span><span class="nc">UL</span><span class="p" data-group-id="1285769131-14">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-15">[</span><span class="o">-</span><span class="nc">D</span><span class="p" data-group-id="1285769131-15">]</span><span class="w">
           </span><span class="p" data-group-id="1285769131-16">[</span><span class="o">-</span><span class="nc">P</span><span class="w"> </span><span class="n">proto</span><span class="p" data-group-id="1285769131-16">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-17">[</span><span class="o">--</span><span class="n">sport</span><span class="o">=</span><span class="n">port</span><span class="p" data-group-id="1285769131-17">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-18">[</span><span class="o">-</span><span class="nc">M</span><span class="w"> </span><span class="n">method</span><span class="p" data-group-id="1285769131-18">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-19">[</span><span class="o">-</span><span class="nc">O</span><span class="w"> </span><span class="n">mod_options</span><span class="p" data-group-id="1285769131-19">]</span><span class="w">
           </span><span class="p" data-group-id="1285769131-20">[</span><span class="o">--</span><span class="n">mtu</span><span class="p" data-group-id="1285769131-20">]</span><span class="w"> </span><span class="p" data-group-id="1285769131-21">[</span><span class="o">--</span><span class="n">back</span><span class="p" data-group-id="1285769131-21">]</span><span class="w">
           </span><span class="n">host</span><span class="w"> </span><span class="p" data-group-id="1285769131-22">[</span><span class="n">packet_len</span><span class="p" data-group-id="1285769131-22">]</span><span class="w">
   </span><span class="n">traceroute6</span><span class="w">  </span><span class="p" data-group-id="1285769131-23">[</span><span class="n">options</span><span class="p" data-group-id="1285769131-23">]</span><span class="w">
   </span><span class="n">tcptraceroute</span><span class="w">  </span><span class="p" data-group-id="1285769131-24">[</span><span class="n">options</span><span class="p" data-group-id="1285769131-24">]</span><span class="w">
   </span><span class="n">lft</span><span class="w">  </span><span class="p" data-group-id="1285769131-25">[</span><span class="n">options</span><span class="p" data-group-id="1285769131-25">]</span></code></pre><p>DESCRIPTION</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">traceroute</span><span class="w">  </span><span class="n">tracks</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">route</span><span class="w">  </span><span class="n">packets</span><span class="w">  </span><span class="n">taken</span><span class="w">  </span><span class="n">from</span><span class="w">  </span><span class="n">an</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">utilizes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">protocol</span><span class="sc">&#39;s time to live (TTL) field and attempts to elicit an ICMP
   TIME_EXCEEDED response from each gateway along the path to the host.

   traceroute6 is equivalent to traceroute -6

   tcptraceroute is equivalent to traceroute -T

   lft , the Layer Four Traceroute, performs a TCP traceroute, like traceroute -T , but attempts to provide compatibility with the original such implementation, also called &quot;lft&quot;.

   The only required parameter is the name or IP address of the destination host .  The optional packet_len`gth is the total size of the probing packet (default 60 bytes for IPv4 and  80
   for IPv6). The specified size can be ignored in some situations or increased up to a minimal value.

   This  program  attempts  to trace the route an IP packet would follow to some internet host by launching probe packets with a small ttl (time to live) then listening for an ICMP &quot;time
   exceeded&quot; reply from a gateway.  We start our probes with a ttl of one and increase by one until we get an ICMP &quot;port unreachable&quot; (or TCP reset), which means we got to the &quot;host&quot;, or
   hit a max (which defaults to 30 hops). Three probes (by default) are sent at each ttl setting and a line is printed showing the ttl, address of the gateway and round trip time of each
   probe. The address can be followed by additional information when requested. If the probe answers come from different gateways, the address of each responding system will be  printed.
   If there is no response within a certain timeout, an &quot;*&quot; (asterisk) is printed for that probe.

   After  the trip time, some additional annotation can be printed: !H, !N, or !P (host, network or protocol unreachable), !S (source route failed), !F (fragmentation needed), !X (commu‐
   nication administratively prohibited), !V (host precedence violation), !C (precedence cutoff in effect), or !&lt;num&gt; (ICMP unreachable code &lt;num&gt;).  If almost all the probes  result  in
   some kind of unreachable, traceroute will give up and exit.

   We don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">probe</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">unlikely</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p" data-group-id="4636842713-1">(</span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">flag</span><span class="p" data-group-id="4636842713-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">prob</span><span class="err">‐</span><span class="w">
   </span><span class="n">lem</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">ICMP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">tracerouting</span><span class="w"> </span><span class="p" data-group-id="4636842713-2">(</span><span class="k">for</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">half</span><span class="o">-</span><span class="n">open</span><span class="w"> </span><span class="n">technique</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">probes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">applications</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="p" data-group-id="4636842713-2">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">In</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">modern</span><span class="w">  </span><span class="n">network</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">traditional</span><span class="w"> </span><span class="n">traceroute</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">applicable</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">widespread</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">firewalls</span><span class="o">.</span><span class="w">  </span><span class="nc">Such</span><span class="w"> </span><span class="n">firewalls</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s">&quot;unlikely&quot;</span><span class="w"> </span><span class="nc">UDP</span><span class="w">
   </span><span class="n">ports</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="nc">ICMP</span><span class="w"> </span><span class="n">echoes</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">solve</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">tracerouting</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="p" data-group-id="4636842713-3">(</span><span class="n">including</span><span class="w"> </span><span class="n">tcp</span><span class="p" data-group-id="4636842713-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="nc">OF</span><span class="w"> </span><span class="nc">AVAILABLE</span><span class="w"> </span><span class="nc">METHODS</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w"> </span><span class="nc">Such</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">particu</span><span class="err">‐</span><span class="w">
   </span><span class="n">lar</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">source</span><span class="o">/</span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">firewalls</span><span class="w"> </span><span class="p" data-group-id="4636842713-4">(</span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">firewalls</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">session</span><span class="p" data-group-id="4636842713-4">)</span><span class="o">.</span></code></pre><p>OPTIONS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="o">--</span><span class="n">help</span><span class="w"> </span><span class="nc">Print</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span><span class="w"> </span><span class="nc">Explicitly</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">tracerouting</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">resolve</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">choose</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">automatically</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">resolving</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">host</span><span class="w">
          </span><span class="n">name</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">addresses</span><span class="p">,</span><span class="w"> </span><span class="n">traceroute</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="nc">IPv4</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">I</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">icmp</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">ICMP</span><span class="w"> </span><span class="nc">ECHO</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">probes</span><span class="w">

   </span><span class="o">-</span><span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">tcp</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">probes</span><span class="w">

   </span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">debug</span><span class="w">
          </span><span class="nc">Enable</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">debugging</span><span class="w"> </span><span class="p" data-group-id="2799329701-1">(</span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">it</span><span class="p" data-group-id="2799329701-1">)</span><span class="w">

   </span><span class="o">-</span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">dont</span><span class="o">-</span><span class="n">fragment</span><span class="w">
          </span><span class="nc">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="n">probe</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="2799329701-2">(</span><span class="nc">For</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="nc">DF</span><span class="w"> </span><span class="n">bit</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">tells</span><span class="w"> </span><span class="n">intermediate</span><span class="w"> </span><span class="n">routers</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="n">remotely</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="p" data-group-id="2799329701-2">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Varying</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">probing</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet_len</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">manually</span><span class="w"> </span><span class="n">obtain</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">individual</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">hops</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">mtu</span><span class="w"> </span><span class="n">option</span><span class="w">
          </span><span class="p" data-group-id="2799329701-3">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="2799329701-3">)</span><span class="w"> </span><span class="n">tries</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="2799329701-4">do</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">automatically</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">fragmented</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="p" data-group-id="2799329701-5">(</span><span class="n">like</span><span class="w"> </span><span class="o">-</span><span class="nc">F</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">mtu</span><span class="p" data-group-id="2799329701-5">)</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">properly</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="mf">2.6</span><span class="o">.</span><span class="mi">22</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w">  </span><span class="nc">Before</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">fragmented</span><span class="p">,</span><span class="w">  </span><span class="nc">IPv4</span><span class="w">  </span><span class="n">could</span><span class="w">  </span><span class="kn">use</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">once</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">discovered</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">mtu</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="p" data-group-id="2799329701-6">(</span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">cache</span><span class="p" data-group-id="2799329701-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">mtu</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">first_ttl</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">first</span><span class="o">=</span><span class="n">first_ttl</span><span class="w">
          </span><span class="nc">Specifies</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="nc">TTL</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">gateway</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="w">
          </span><span class="nc">Tells</span><span class="w">  </span><span class="n">traceroute</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">outgoing</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">tells</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="p" data-group-id="2799329701-7">(</span><span class="n">most</span><span class="w"> </span><span class="n">routers</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">disabled</span><span class="w">
          </span><span class="n">source</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">reasons</span><span class="p" data-group-id="2799329701-7">)</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">general</span><span class="p">,</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">gateway</span><span class="sc">&#39;s is allowed (comma separated). For IPv6, the form of num,addr,addr...  is allowed,  where  num  is  a  route
          header type (default is type 2). Note the type 0 route header is now deprecated (rfc5095).

   -i interface, --interface=interface
          Specifies the interface through which traceroute should send packets. By default, the interface is selected according to the routing table.

   -m max_ttl, --max-hops=max_ttl
          Specifies the maximum number of hops (max time-to-live value) traceroute will probe. The default is 30.

   -N squeries, --sim-queries=squeries
          Specifies the number of probe packets sent out simultaneously.  Sending several probes concurrently can speed up traceroute considerably. The default value is 16.
          Note that some routers and hosts can use ICMP rate throttling. In such a situation specifying too large number can lead to loss of some responses.

   -n     Do not try to map IP addresses to host names when displaying them.

   -p port, --port=port
          For UDP tracing, specifies the destination port base traceroute will use (the destination port number will be incremented by each probe).
          For ICMP tracing, specifies the initial ICMP sequence value (incremented by each probe too).
          For TCP and others specifies just the (constant) destination port to connect. When using the tcptraceroute wrapper, -p specifies the source port.

   -t tos, --tos=tos
          For  IPv4,  set  the Type of Service (TOS) and Precedence value. Useful values are 16 (low delay) and 8 (high throughput). Note that in order to use some TOS precedence values,
          you have to be super user.
          For IPv6, set the Traffic Control value.

   -l flow_label, --flowlabel=flow_label
          Use specified flow_label for IPv6 packets.

   -w max[,here,near], --wait=max[,here,near]
          Determines how long to wait for a response to a probe.

          There are three (in general) float values separated by a comma (or a slash).  Max specifies the maximum time (in seconds, default 5.0) to wait, in any case.

          Traditional traceroute implementation always waited whole max seconds for any probe. But if we already have some replies from the same hop, or even from some next hop,  we  can
          use the round trip time of such a reply as a hint to determine the actual reasonable amount of time to wait.

          The  optional  here (default 3.0) specifies a factor to multiply the round trip time of an already received response from the same hop. The resulting value is used as a timeout
          for the probe, instead of (but no more than) max.  The optional near (default 10.0) specifies a similar factor for a response from some next hop.  (The time of the first  found
          result is used in both cases).

          First,  we look for the same hop (of the probe which will be printed first from now).  If nothing found, then look for some next hop. If nothing found, use max.  If here and/or
          near have zero values, the corresponding computation is skipped.
          Here and near are always set to zero if only max is specified (for compatibility with previous versions).

   -q nqueries, --queries=nqueries
          Sets the number of probe packets per hop. The default is 3.

   -r     Bypass the normal routing tables and send directly to a host on an attached network.  If the host is not on a directly-attached network, an error is returned.  This option  can
          be used to ping a local host through an interface that has no route through it.

   -s source_addr, --source=source_addr
          Chooses an alternative source address. Note that you must select the address of one of the interfaces.  By default, the address of the outgoing interface is used.

   -z sendwait, --sendwait=sendwait
          Minimal  time interval between probes (default 0).  If the value is more than 10, then it specifies a number in milliseconds, else it is a number of seconds (float point values
          allowed too).  Useful when some routers use rate-limit for ICMP messages.

   -e, --extensions
          Show ICMP  extensions  (rfc4884).  The  general  form  is  CLASS/TYPE:  followed  by  a  hexadecimal  dump.   The  MPLS  (rfc4950)  is  shown  parsed,  in  a  form:  MPLS:L=la‐
          bel,E=exp_use,S=stack_bottom,T=TTL  (more  objects  separated  by  /  ). The Interface Information (rfc5837) is shown parsed as well, in a following form: {INC|SUB|OUT|NXT}:in‐
          dex,IP_addr,&quot;name&quot;,mtu=MTU (all four fields may be missing).

   -A, --as-path-lookups
          Perform AS path lookups in routing registries and print results directly after the corresponding addresses.

   -V, --version
          Print the version and exit.

   There are additional options intended for advanced usage (such as alternate trace methods etc.):

   --sport=port
          Chooses the source port to use. Implies -N 1 -w 5 .  Normally source ports (if applicable) are chosen by the system.

   --fwmark=mark
          Set the firewall mark for outgoing packets (since the Linux kernel 2.6.25).

   -M method, --module=name
          Use specified method for traceroute operations. Default traditional udp method has name default, icmp (-I) and tcp (-T) have names icmp and tcp respectively.
          Method-specific options can be passed by -O .  Most methods have their simple shortcuts, (-I means -M icmp, etc).

   -O option, --options=options
          Specifies some method-specific option. Several options are separated by comma (or use several -O on cmdline).  Each method may have its own specific options, or many  not  have
          them at all.  To print information about available options, use -O help.

   -U, --udp
          Use UDP to particular destination port for tracerouting (instead of increasing the port per each probe). Default port is 53 (dns).

   -UL    Use UDPLITE for tracerouting (default port is 53).

   -D, --dccp
          Use DCCP Requests for probes.

   -P protocol, --protocol=protocol
          Use raw packet of specified protocol for tracerouting. Default protocol is 253 (rfc3692).

   --mtu  Discover MTU along the path being traced. Implies -F -N 1.  New mtu is printed once in a form of F=NUM at the first probe of a hop which requires such mtu to be reached. (Actu‐
          ally, the correspond &quot;frag needed&quot; icmp message normally is sent by the previous hop).

          Note,  that  some routers might cache once the seen information on a fragmentation. Thus you can receive the final mtu from a closer hop.  Try to specify an unusual tos by -t ,
          this can help for one attempt (then it can be cached there as well).
          See -F option for more info.

   --back Print the number of backward hops when it seems different with the forward direction. This number is guessed in assumption that remote hops send reply packets with initial  ttl
          set to either 64, or 128 or 255 (which seems a common practice). It is printed as a negate value in a form of &#39;</span><span class="o">-</span><span class="nc">NUM</span><span class="err">&#39;</span><span class="w"> </span><span class="o">.</span></code></pre><p>LIST OF AVAILABLE METHODS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">In</span><span class="w">  </span><span class="n">general</span><span class="p">,</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">particular</span><span class="w">  </span><span class="n">traceroute</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">chosen</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="nc">M</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">cmdline</span><span class="w"> </span><span class="n">switches</span><span class="w"> </span><span class="p" data-group-id="7242518190-1">(</span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w">
   </span><span class="n">present</span><span class="p" data-group-id="7242518190-1">)</span><span class="o">.</span></code></pre><p>   default</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">traditional</span><span class="p">,</span><span class="w"> </span><span class="n">ancient</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tracerouting</span><span class="o">.</span><span class="w"> </span><span class="nc">Used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

   </span><span class="nc">Probe</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="n">datagrams</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">so</span><span class="o">-</span><span class="n">called</span><span class="w"> </span><span class="s">&quot;unlikely&quot;</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">ports</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="s">&quot;unlikely&quot;</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">probe</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">33434</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">probe</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">incremented</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="o">.</span><span class="w"> </span><span class="nc">Since</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">unused</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="s">&quot;icmp unreach port&quot;</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">response</span><span class="o">.</span><span class="w">  </span><span class="p" data-group-id="5849059427-1">(</span><span class="nc">Nobody</span><span class="w"> </span><span class="n">knows</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">listens</span><span class="w"> </span><span class="k">for</span><span class="w">  </span><span class="n">such</span><span class="w">
   </span><span class="n">ports</span><span class="p">,</span><span class="w"> </span><span class="n">though</span><span class="p" data-group-id="5849059427-1">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">unprivileged</span><span class="w"> </span><span class="n">users</span><span class="o">.</span></code></pre><p>   icmp       -I</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Most</span><span class="w"> </span><span class="n">usual</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">now</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">probes</span><span class="o">.</span><span class="w">
   </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">ping</span><span class="p" data-group-id="3108073412-1">(</span><span class="mi">8</span><span class="p" data-group-id="3108073412-1">)</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="n">tracerouting</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">applicable</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">unprivileged</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="p" data-group-id="3108073412-2">(</span><span class="nc">IPv4</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="mf">3.11</span><span class="p" data-group-id="3108073412-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">dgram</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="p" data-group-id="3108073412-3">(</span><span class="ow">or</span><span class="w"> </span><span class="s">&quot;ping&quot;</span><span class="p" data-group-id="3108073412-3">)</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">sockets</span><span class="p">,</span><span class="w"> </span><span class="n">sysadmin</span><span class="w">
   </span><span class="n">should</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">net</span><span class="o">/</span><span class="n">ipv4</span><span class="o">/</span><span class="n">ping_group_range</span><span class="w"> </span><span class="n">sysctl</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">
   </span><span class="ss">Options</span><span class="p">:</span><span class="w">

   </span><span class="n">raw</span><span class="w">    </span><span class="nc">Use</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="p" data-group-id="3108073412-4">(</span><span class="n">the</span><span class="w"> </span><span class="n">traditional</span><span class="w"> </span><span class="n">way</span><span class="p" data-group-id="3108073412-4">)</span><span class="o">.</span><span class="w">
          </span><span class="nc">This</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">tried</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="p" data-group-id="3108073412-5">(</span><span class="k">for</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="n">reasons</span><span class="p" data-group-id="3108073412-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">dgram</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">fallback</span><span class="o">.</span><span class="w">

   </span><span class="n">dgram</span><span class="w">  </span><span class="nc">Use</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">dgram</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span></code></pre><p>   tcp        -T</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Well</span><span class="o">-</span><span class="n">known</span><span class="w"> </span><span class="n">modern</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">firewalls</span><span class="o">.</span><span class="w">
   </span><span class="nc">Uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">constant</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="1583820693-1">(</span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="n">http</span><span class="p" data-group-id="1583820693-1">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="s">&quot;unlikely&quot;</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="p" data-group-id="1583820693-2">(</span><span class="n">as</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">method</span><span class="p" data-group-id="1583820693-2">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="n">echoes</span><span class="w"> </span><span class="p" data-group-id="1583820693-3">(</span><span class="n">as</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">icmp</span><span class="p" data-group-id="1583820693-3">)</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">filtered</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">whole</span><span class="w">  </span><span class="n">tracer</span><span class="err">‐</span><span class="w">
   </span><span class="n">outing</span><span class="w">  </span><span class="n">will</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">firewall</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">filter</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">protocol</span><span class="o">/</span><span class="n">port</span><span class="w"> </span><span class="n">combinations</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">some</span><span class="p">,</span><span class="w"> </span><span class="n">say</span><span class="p">,</span><span class="w"> </span><span class="n">mailserver</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">likely</span><span class="w">
   </span><span class="o">-</span><span class="nc">T</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">reach</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">-</span><span class="nc">I</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ow">not</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">well</span><span class="o">-</span><span class="n">known</span><span class="w"> </span><span class="s">&quot;half-open technique&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">applications</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">seeing</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">probes</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">all</span><span class="o">.</span><span class="w">  </span><span class="nc">Normally</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">syn</span><span class="w"> </span><span class="n">is</span><span class="w">  </span><span class="n">sent</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w">  </span><span class="n">non</span><span class="o">-</span><span class="n">listened</span><span class="w">
   </span><span class="n">ports</span><span class="w">  </span><span class="n">we</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">reset</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">done</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">syn</span><span class="o">+</span><span class="n">ack</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="p" data-group-id="1583820693-4">(</span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">ack</span><span class="p" data-group-id="1583820693-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">session</span><span class="w">
   </span><span class="n">is</span><span class="w"> </span><span class="n">dropped</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">ever</span><span class="w"> </span><span class="n">taking</span><span class="w"> </span><span class="n">notice</span><span class="o">.</span><span class="w">

   </span><span class="nc">There</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">couple</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="ss">method</span><span class="p">:</span><span class="w">

   </span><span class="n">syn</span><span class="p">,</span><span class="n">ack</span><span class="p">,</span><span class="n">fin</span><span class="p">,</span><span class="n">rst</span><span class="p">,</span><span class="n">psh</span><span class="p">,</span><span class="n">urg</span><span class="p">,</span><span class="n">ece</span><span class="p">,</span><span class="n">cwr</span><span class="w">
          </span><span class="nc">Sets</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">probe</span><span class="w"> </span><span class="n">packet</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">combination</span><span class="o">.</span><span class="w">

   </span><span class="n">flags</span><span class="o">=</span><span class="n">num</span><span class="w">
          </span><span class="nc">Sets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">num</span><span class="o">.</span><span class="w">

   </span><span class="n">ecn</span><span class="w">    </span><span class="nc">Send</span><span class="w"> </span><span class="n">syn</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="nc">ECE</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">CWR</span><span class="w"> </span><span class="p" data-group-id="1583820693-5">(</span><span class="k">for</span><span class="w"> </span><span class="nc">Explicit</span><span class="w"> </span><span class="nc">Congestion</span><span class="w"> </span><span class="nc">Notification</span><span class="p">,</span><span class="w"> </span><span class="n">rfc3168</span><span class="p" data-group-id="1583820693-5">)</span><span class="o">.</span><span class="w">

   </span><span class="n">sack</span><span class="p">,</span><span class="n">timestamps</span><span class="p">,</span><span class="n">window_scaling</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">outgoing</span><span class="w"> </span><span class="n">probe</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">

   </span><span class="n">sysctl</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">sysctl</span><span class="w"> </span><span class="p" data-group-id="1583820693-6">(</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="o">*</span><span class="p" data-group-id="1583820693-6">)</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ecn</span><span class="o">.</span><span class="w">  </span><span class="nc">Always</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">

   </span><span class="n">fastopen</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">fastopen</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="1583820693-7">(</span><span class="ow">when</span><span class="w"> </span><span class="n">syn</span><span class="p" data-group-id="1583820693-7">)</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">cookie</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w">

   </span><span class="n">mss</span><span class="o">=</span><span class="p" data-group-id="1583820693-8">[</span><span class="n">num</span><span class="p" data-group-id="1583820693-8">]</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="p" data-group-id="1583820693-9">(</span><span class="ow">or</span><span class="w"> </span><span class="n">unchanged</span><span class="p" data-group-id="1583820693-9">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">maxseg</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="1583820693-10">(</span><span class="ow">when</span><span class="w"> </span><span class="n">syn</span><span class="p" data-group-id="1583820693-10">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">discover</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">clamping</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">traced</span><span class="o">.</span><span class="w">  </span><span class="nc">New</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">mss</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">form</span><span class="w">  </span><span class="n">of</span><span class="w">
          </span><span class="nc">M</span><span class="o">=</span><span class="nc">NUM</span><span class="w">  </span><span class="n">at</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">first</span><span class="w"> </span><span class="n">probe</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">detected</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="p">,</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">routers</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">short</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">exceeded</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">making</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">impossible</span><span class="o">.</span><span class="w">  </span><span class="nc">Be</span><span class="err">‐</span><span class="w">
          </span><span class="n">sides</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">responses</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">come</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="w">  </span><span class="nc">All</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="p" data-group-id="1583820693-11">(</span><span class="n">using</span><span class="w"> </span><span class="o">-</span><span class="nc">N</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="1583820693-11">)</span><span class="o">.</span><span class="w">

   </span><span class="n">info</span><span class="w">   </span><span class="nc">Print</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reached</span><span class="o">.</span><span class="w">  </span><span class="nc">Allows</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">an</span><span class="w">  </span><span class="n">application</span><span class="w">  </span><span class="n">listens</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">port</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">other</span><span class="w">  </span><span class="n">useful</span><span class="w">
          </span><span class="n">things</span><span class="o">.</span><span class="w">   </span><span class="nc">Supported</span><span class="w">  </span><span class="n">tcp</span><span class="w">  </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="nc">T</span><span class="w"> </span><span class="o">-</span><span class="nc">O</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="o">.</span><span class="w">  </span><span class="n">mss</span><span class="p">,</span><span class="w"> </span><span class="n">sack</span><span class="p">,</span><span class="w"> </span><span class="n">timestamps</span><span class="p">,</span><span class="w"> </span><span class="n">window_scaling</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">fastopen</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="p" data-group-id="1583820693-12">(</span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">mss</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">just</span><span class="w"> </span><span class="n">presence</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">others</span><span class="p" data-group-id="1583820693-12">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Default</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">syn</span><span class="p">,</span><span class="n">sysctl</span><span class="o">.</span></code></pre><p>   tcpconn</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">An</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">connect</span><span class="p" data-group-id="7787796806-1">(</span><span class="mi">2</span><span class="p" data-group-id="7787796806-1">)</span><span class="w"> </span><span class="n">call</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">opening</span><span class="o">.</span><span class="w"> </span><span class="nc">Not</span><span class="w"> </span><span class="n">recommended</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="kn">use</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w">
   </span><span class="n">affected</span><span class="w"> </span><span class="p" data-group-id="7787796806-2">(</span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">confused</span><span class="p" data-group-id="7787796806-2">)</span><span class="o">.</span></code></pre><p>   udp        -U</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Use</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">constant</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="5908132661-1">(</span><span class="n">default</span><span class="w"> </span><span class="mi">53</span><span class="p">,</span><span class="w"> </span><span class="n">dns</span><span class="p" data-group-id="5908132661-1">)</span><span class="o">.</span><span class="w">
   </span><span class="nc">Intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w">

   </span><span class="nc">Note</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">unlike</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">probes</span><span class="w"> </span><span class="p" data-group-id="5908132661-2">(</span><span class="k">with</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">data</span><span class="p" data-group-id="5908132661-2">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">easily</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">confused</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">them</span><span class="o">.</span><span class="w">  </span><span class="nc">Most</span><span class="w">  </span><span class="n">cases</span><span class="w">
   </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">respond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">though</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">hop</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trace</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="5908132661-3">(</span><span class="nc">Fortunately</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">seems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">dns</span><span class="w"> </span><span class="n">servers</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="n">angry</span><span class="p" data-group-id="5908132661-3">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">unprivileged</span><span class="w"> </span><span class="n">users</span><span class="o">.</span></code></pre><p>   udplite    -UL</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Use</span><span class="w"> </span><span class="n">udplite</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">probes</span><span class="w"> </span><span class="p" data-group-id="2744616518-1">(</span><span class="k">with</span><span class="w"> </span><span class="n">constant</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="mi">53</span><span class="p" data-group-id="2744616518-1">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">unprivileged</span><span class="w"> </span><span class="n">users</span><span class="o">.</span><span class="w">
   </span><span class="ss">Options</span><span class="p">:</span><span class="w">

   </span><span class="n">coverage</span><span class="o">=</span><span class="n">num</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">udplite</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">coverage</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">num</span><span class="o">.</span></code></pre><p>   dccp    -D</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Use</span><span class="w"> </span><span class="nc">DCCP</span><span class="w"> </span><span class="nc">Request</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">probes</span><span class="w"> </span><span class="p" data-group-id="8112517767-1">(</span><span class="n">rfc4340</span><span class="p" data-group-id="8112517767-1">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="s">&quot;half-open technique&quot;</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">TCP</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">33434</span><span class="o">.</span><span class="w">

   </span><span class="ss">Options</span><span class="p">:</span><span class="w">

   </span><span class="n">service</span><span class="o">=</span><span class="n">num</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="nc">DCCP</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="p" data-group-id="8112517767-2">(</span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">1885957735</span><span class="p" data-group-id="8112517767-2">)</span><span class="o">.</span></code></pre><p>   raw        -P proto</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Send</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">proto</span><span class="o">.</span><span class="w">
   </span><span class="nc">No</span><span class="w"> </span><span class="n">protocol</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w">
   </span><span class="nc">Implies</span><span class="w"> </span><span class="o">-</span><span class="nc">N</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">.</span><span class="w">
   </span><span class="ss">Options</span><span class="p">:</span><span class="w">

   </span><span class="n">protocol</span><span class="o">=</span><span class="n">proto</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="p" data-group-id="0120550064-1">(</span><span class="n">default</span><span class="w"> </span><span class="mi">253</span><span class="p" data-group-id="0120550064-1">)</span><span class="o">.</span></code></pre><p>NOTES</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">To</span><span class="w">  </span><span class="n">speed</span><span class="w">  </span><span class="n">up</span><span class="w">  </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">probes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">simultaneously</span><span class="o">.</span><span class="w">  </span><span class="nc">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">hand</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">creates</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;storm of packages&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">especially</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">direction</span><span class="o">.</span><span class="w"> </span><span class="nc">Routers</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">throttle</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">rate</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="n">responses</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">lost</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">decrease</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">simultaneous</span><span class="w"> </span><span class="n">probes</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p" data-group-id="1934575966-1">(</span><span class="n">like</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">initial</span><span class="w">  </span><span class="n">traceroute</span><span class="w">  </span><span class="n">implementation</span><span class="p" data-group-id="1934575966-1">)</span><span class="p">,</span><span class="w">
   </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w">  </span><span class="o">-</span><span class="nc">N</span><span class="w"> </span><span class="mi">1</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="p" data-group-id="1934575966-2">(</span><span class="n">target</span><span class="p" data-group-id="1934575966-2">)</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">simultaneous</span><span class="w"> </span><span class="n">probes</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latest</span><span class="w"> </span><span class="n">ones</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="s">&quot;looks like expired&quot;</span><span class="w"> </span><span class="n">hops</span><span class="w"> </span><span class="n">near</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">hop</span><span class="o">.</span><span class="w"> </span><span class="nc">We</span><span class="w"> </span><span class="kn">use</span><span class="w">
   </span><span class="n">a</span><span class="w"> </span><span class="n">smart</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">auto</span><span class="o">-</span><span class="n">detect</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">situation</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">-</span><span class="nc">N</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">too</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">slow</span><span class="w"> </span><span class="n">down</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">half</span><span class="o">-</span><span class="n">second</span><span class="w"> </span><span class="n">pause</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">probes</span><span class="o">.</span><span class="w">

   </span><span class="nc">To</span><span class="w">  </span><span class="n">avoid</span><span class="w">  </span><span class="n">an</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">waiting</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">adaptive</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">timeouts</span><span class="w"> </span><span class="p" data-group-id="1934575966-3">(</span><span class="n">see</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">info</span><span class="p" data-group-id="1934575966-3">)</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">premature</span><span class="w"> </span><span class="n">expiry</span><span class="w"> </span><span class="p" data-group-id="1934575966-4">(</span><span class="n">especially</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">differ</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">times</span><span class="p" data-group-id="1934575966-4">)</span><span class="w"> </span><span class="ow">and</span><span class="w">
   </span><span class="n">printing</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">desired</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="p" data-group-id="1934575966-5">(</span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="1934575966-5">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">hops</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">chance</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">obtain</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="o">-</span><span class="nc">R</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="p" data-group-id="1934575966-6">(</span><span class="nc">IPv4</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">nearest</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">hops</span><span class="w"> </span><span class="n">only</span><span class="p" data-group-id="1934575966-6">)</span><span class="o">.</span></code></pre><p>SEE ALSO</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">ping</span><span class="p" data-group-id="1662657009-1">(</span><span class="mi">8</span><span class="p" data-group-id="1662657009-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">ping6</span><span class="p" data-group-id="1662657009-2">(</span><span class="mi">8</span><span class="p" data-group-id="1662657009-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">tcpdump</span><span class="p" data-group-id="1662657009-3">(</span><span class="mi">8</span><span class="p" data-group-id="1662657009-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">netstat</span><span class="p" data-group-id="1662657009-4">(</span><span class="mi">8</span><span class="p" data-group-id="1662657009-4">)</span></code></pre><p>Traceroute                                                                              11 October 2006                                                                          TRACEROUTE(1)</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="traceroute6.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
traceroute6
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="tree.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
tree
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
