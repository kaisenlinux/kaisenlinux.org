<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="Manpages v3.0.0">


    <title>btrfs-balance — Manpages v3.0.0</title>

    <link rel="stylesheet" href="dist/html-elixir-KV3YOVJ3.css" />

    <script defer src="dist/sidebar_items-65F766E3.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>
<link rel="stylesheet" href="assets/doc.css">
  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Manpages" />
        </a>

      <div>
        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectName" translate="no">
Manpages
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v3.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras="MANUALS"></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Manpages</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>btrfs-balance</h1>


  </div>


<p>BTRFS-BALANCE(8)                                                                             BTRFS                                                                            BTRFS-BALANCE(8)</p><p>NAME</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="o">-</span><span class="n">balance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span></code></pre><p>SYNOPSIS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">&lt;</span><span class="n">subcommand</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span></code></pre><p>DESCRIPTION</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w">  </span><span class="n">primary</span><span class="w">  </span><span class="n">purpose</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">balance</span><span class="w">  </span><span class="n">feature</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">spread</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">mkfs</span><span class="o">.</span><span class="n">btrfs</span><span class="p" data-group-id="2747388751-1">(</span><span class="mi">8</span><span class="p" data-group-id="2747388751-1">)</span><span class="w"> </span><span class="n">section</span><span class="w">
   </span><span class="nc">PROFILES</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">balancing</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">tuned</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w"> </span><span class="nc">Balance</span><span class="w">  </span><span class="n">works</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">mounted</span><span class="w">
   </span><span class="n">filesystem</span><span class="o">.</span><span class="w">   </span><span class="nc">Extent</span><span class="w">  </span><span class="n">sharing</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">preserved</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reflinks</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">broken</span><span class="o">.</span><span class="w">  </span><span class="nc">Files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">defragmented</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">recompressed</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">extents</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">preserved</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">devices</span><span class="w">
   </span><span class="n">will</span><span class="w"> </span><span class="n">change</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">cancellable</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">disk</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">consistent</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">unexpected</span><span class="w"> </span><span class="n">interruption</span><span class="w"> </span><span class="p" data-group-id="2747388751-2">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">crash</span><span class="p">,</span><span class="w"> </span><span class="n">reboot</span><span class="p" data-group-id="2747388751-2">)</span><span class="w"> </span><span class="n">does</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">corrupt</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">temporarily</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">resumed</span><span class="w"> </span><span class="n">upon</span><span class="w"> </span><span class="n">mount</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">skip_balance</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">

   </span><span class="ss">WARNING</span><span class="p">:</span><span class="w">
      </span><span class="nc">Running</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">lot</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">basically</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">data</span><span class="o">/</span><span class="n">metadata</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">pointers</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">actions</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="p" data-group-id="2747388751-3">(</span><span class="n">filter</span><span class="w"> </span><span class="n">convert</span><span class="p" data-group-id="2747388751-3">)</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">compact</span><span class="w">  </span><span class="p" data-group-id="2747388751-4">(</span><span class="n">filter</span><span class="w"> </span><span class="n">usage</span><span class="p" data-group-id="2747388751-4">)</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="p" data-group-id="2747388751-5">(</span><span class="n">filters</span><span class="w"> </span><span class="n">devid</span><span class="p">,</span><span class="w"> </span><span class="n">drange</span><span class="p" data-group-id="2747388751-5">)</span><span class="w">

   </span><span class="nc">The</span><span class="w">  </span><span class="n">filters</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="p" data-group-id="2747388751-6">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">system</span><span class="p" data-group-id="2747388751-6">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">changing</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">Otherwise</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">auto</span><span class="err">‐</span><span class="w">
   </span><span class="n">matically</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">converted</span><span class="o">.</span><span class="w">

   </span><span class="nc">When</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">redundancy</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reduced</span><span class="w"> </span><span class="p" data-group-id="2747388751-7">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">RAID1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">single</span><span class="p" data-group-id="2747388751-7">)</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">noted</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">log</span><span class="o">.</span><span class="w">

   </span><span class="ss">NOTE</span><span class="p">:</span><span class="w">
      </span><span class="nc">The</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">enough</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">space</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">completely</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">ENOSPC</span><span class="w"> </span><span class="n">reports</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="nc">ENOSPC</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">more</span><span class="w">
      </span><span class="n">details</span><span class="o">.</span></code></pre><p>COMPATIBILITY</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="ss">NOTE</span><span class="p">:</span><span class="w">
      </span><span class="nc">The</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">subcommand</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">namespace</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">backward</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">more</span><span class="o">.</span><span class="w">

   </span><span class="ss">NOTE</span><span class="p">:</span><span class="w">
      </span><span class="nc">A</span><span class="w"> </span><span class="n">short</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">backward</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">more</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span></code></pre><p>PERFORMANCE IMPLICATIONS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Balancing</span><span class="w">  </span><span class="n">operations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="nc">IO</span><span class="w"> </span><span class="n">intensive</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">quite</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">intensive</span><span class="p">,</span><span class="w"> </span><span class="n">impacting</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">ongoing</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">operations</span><span class="o">.</span><span class="w"> </span><span class="nc">Typically</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">amounts</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">copied</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">lo</span><span class="err">‐</span><span class="w">
   </span><span class="n">cation</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">another</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">updates</span><span class="o">.</span><span class="w">

   </span><span class="nc">Depending</span><span class="w"> </span><span class="n">upon</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">layout</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">seek</span><span class="w"> </span><span class="n">heavy</span><span class="o">.</span><span class="w"> </span><span class="nc">Performance</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">rotational</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">noticeably</span><span class="w"> </span><span class="n">worse</span><span class="w"> </span><span class="n">compared</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SSDs</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="n">arrays</span><span class="o">.</span></code></pre><p>SUBCOMMAND</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">cancel</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="n">cancels</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">paused</span><span class="w"> </span><span class="n">balance</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">processed</span><span class="w"> </span><span class="n">completes</span><span class="w">

          </span><span class="nc">Since</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="mf">5.7</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cancellation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">significantly</span><span class="w"> </span><span class="n">improved</span><span class="p">,</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">kernels</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">processed</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">completely</span><span class="w">  </span><span class="n">fin</span><span class="err">‐</span><span class="w">
          </span><span class="n">ished</span><span class="o">.</span><span class="w">

   </span><span class="n">pause</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="n">pause</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w">

   </span><span class="n">resume</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="n">resume</span><span class="w">  </span><span class="n">interrupted</span><span class="w">  </span><span class="n">balance</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">balance</span><span class="w">  </span><span class="n">status</span><span class="w">  </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">run</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">paused</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">forcibly</span><span class="w"> </span><span class="n">interrupted</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">mounted</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="k">with</span><span class="w">
          </span><span class="n">skip_balance</span><span class="w">

   </span><span class="n">start</span><span class="w"> </span><span class="p" data-group-id="9743800616-1">[</span><span class="n">options</span><span class="p" data-group-id="9743800616-1">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="n">start</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">filters</span><span class="p">,</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">moved</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">process</span><span class="w">  </span><span class="n">runs</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">fore</span><span class="err">‐</span><span class="w">
          </span><span class="n">ground</span><span class="o">.</span><span class="w">

          </span><span class="ss">NOTE</span><span class="p">:</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">basically</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">everything</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="p" data-group-id="9743800616-2">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logical</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="n">of</span><span class="w">
             </span><span class="n">file</span><span class="w">  </span><span class="n">extents</span><span class="w">  </span><span class="n">like</span><span class="w"> </span><span class="n">offsets</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">extent</span><span class="w"> </span><span class="n">sharing</span><span class="p" data-group-id="9743800616-2">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">potentially</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">size</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">by</span><span class="w">
             </span><span class="n">accident</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">warned</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">few</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">cancel</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">starts</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">warning</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">skipped</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">full</span><span class="o">-</span><span class="n">balance</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

          </span><span class="nc">Please</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">they</span><span class="sc">&#39;re optional and bare -d and -m also work and mean no filters.

          NOTE:
             When the target profile for conversion filter is raid5 or raid6, there&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">safety</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">warn</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">feature</span><span class="w">

          </span><span class="nc">Options</span><span class="w">

          </span><span class="o">-</span><span class="n">d</span><span class="p" data-group-id="9743800616-3">[</span><span class="o">&lt;</span><span class="n">filters</span><span class="o">&gt;</span><span class="p" data-group-id="9743800616-3">]</span><span class="w">
                 </span><span class="n">act</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="nc">FILTERS</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">filters</span><span class="w">

          </span><span class="o">-</span><span class="n">m</span><span class="p" data-group-id="9743800616-4">[</span><span class="o">&lt;</span><span class="n">filters</span><span class="o">&gt;</span><span class="p" data-group-id="9743800616-4">]</span><span class="w">
                 </span><span class="n">act</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">chunks</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="nc">FILTERS</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">filters</span><span class="w">

          </span><span class="o">-</span><span class="n">s</span><span class="p" data-group-id="9743800616-5">[</span><span class="o">&lt;</span><span class="n">filters</span><span class="o">&gt;</span><span class="p" data-group-id="9743800616-5">]</span><span class="w">
                 </span><span class="n">act</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">chunks</span><span class="w"> </span><span class="p" data-group-id="9743800616-6">(</span><span class="n">requires</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="p" data-group-id="9743800616-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="nc">FILTERS</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">filters</span><span class="o">.</span><span class="w">

          </span><span class="o">-</span><span class="n">f</span><span class="w">     </span><span class="n">force</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reduction</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">integrity</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">raid1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">single</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">skip</span><span class="w"> </span><span class="n">safety</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">conversion</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">raid5</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">raid6</span><span class="w">

          </span><span class="o">--</span><span class="n">background</span><span class="o">|</span><span class="o">--</span><span class="n">bg</span><span class="w">
                 </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">asynchronously</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">background</span><span class="p">,</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">fork</span><span class="p" data-group-id="9743800616-7">(</span><span class="mi">2</span><span class="p" data-group-id="9743800616-7">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">ioctl</span><span class="w">

          </span><span class="o">--</span><span class="n">enqueue</span><span class="w">
                 </span><span class="n">wait</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="sc">&#39;s another exclusive operation running, otherwise continue

          -v     (deprecated) alias for global &#39;</span><span class="o">-</span><span class="n">v</span><span class="err">&#39;</span><span class="w"> </span><span class="n">option</span><span class="w">

   </span><span class="n">status</span><span class="w"> </span><span class="p" data-group-id="9743800616-8">[</span><span class="o">-</span><span class="n">v</span><span class="p" data-group-id="9743800616-8">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Show</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">paused</span><span class="w"> </span><span class="n">balance</span><span class="o">.</span><span class="w">

          </span><span class="nc">Options</span><span class="w">

          </span><span class="o">-</span><span class="n">v</span><span class="w">     </span><span class="p" data-group-id="9743800616-9">(</span><span class="n">deprecated</span><span class="p" data-group-id="9743800616-9">)</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">option</span></code></pre><p>FILTERS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">From</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="mf">3.3</span><span class="w"> </span><span class="n">onwards</span><span class="p">,</span><span class="w"> </span><span class="nc">BTRFS</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">filesystem</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">replication</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="p" data-group-id="0417949388-1">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w">  </span><span class="n">convert</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">from</span><span class="w">  </span><span class="n">sin</span><span class="err">‐</span><span class="w">
   </span><span class="n">gle</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">RAID1</span><span class="p" data-group-id="0417949388-1">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Balance</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">options</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="p" data-group-id="0417949388-2">(</span><span class="n">also</span><span class="w"> </span><span class="n">implicitly</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="p" data-group-id="0417949388-2">)</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="p" data-group-id="0417949388-3">(</span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">mandatory</span><span class="w"> </span><span class="n">getopt</span><span class="w"> </span><span class="n">syntax</span><span class="p" data-group-id="0417949388-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="o">-</span><span class="n">dusage</span><span class="o">=</span><span class="mi">10</span><span class="o">.</span><span class="w"> </span><span class="nc">Options</span><span class="w"> </span><span class="k">for</span><span class="w">
   </span><span class="n">all</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">

   </span><span class="nc">A</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">structure</span><span class="p">:</span><span class="w"> </span><span class="n">filter</span><span class="p" data-group-id="0417949388-4">[</span><span class="o">=</span><span class="n">params</span><span class="p" data-group-id="0417949388-4">]</span><span class="p" data-group-id="0417949388-5">[</span><span class="p">,</span><span class="n">filter</span><span class="o">=</span><span class="n">...</span><span class="p" data-group-id="0417949388-5">]</span><span class="w">

   </span><span class="nc">To</span><span class="w"> </span><span class="n">combine</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="p">,</span><span class="p">,</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w"> </span><span class="ss">Example</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="n">dconvert</span><span class="o">=</span><span class="n">raid1</span><span class="p">,</span><span class="n">soft</span><span class="w">

   </span><span class="nc">BTRFS</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">reason</span><span class="w"> </span><span class="n">why</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">protection</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">fail</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">sector</span><span class="w">
   </span><span class="n">of</span><span class="w"> </span><span class="n">unrecoverable</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">break</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="p">,</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">sector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">lost</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">trivially</span><span class="w"> </span><span class="n">recovered</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">deleting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">broken</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="nc">Before</span><span class="w">  </span><span class="n">changing</span><span class="w"> </span><span class="n">profiles</span><span class="p">,</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enough</span><span class="w"> </span><span class="n">unallocated</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">drives</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="p" data-group-id="0417949388-6">(</span><span class="k">for</span><span class="w"> </span><span class="n">filesystems</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="mi">50</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">1</span><span class="nc">GB</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p" data-group-id="0417949388-7">(</span><span class="n">number_of_de</span><span class="err">‐</span><span class="w">
   </span><span class="n">vices</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="0417949388-7">)</span><span class="p" data-group-id="0417949388-6">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Default</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">BTRFS</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="ss">data</span><span class="p">:</span><span class="w"> </span><span class="n">single</span><span class="w">

   </span><span class="err">•</span><span class="w">

     </span><span class="ss">metadata</span><span class="p">:</span><span class="w">

            </span><span class="err">•</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="ss">devices</span><span class="p">:</span><span class="w"> </span><span class="n">dup</span><span class="w">

            </span><span class="err">•</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="ss">devices</span><span class="p">:</span><span class="w"> </span><span class="n">raid1</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">are</span><span class="p">:</span></code></pre><p>   Filter types</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">profiles</span><span class="o">=</span><span class="o">&lt;</span><span class="n">profiles</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Balances</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w"> </span><span class="nc">Parameters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="8615714014-1">(</span><span class="n">pipe</span><span class="p" data-group-id="8615714014-1">)</span><span class="o">.</span><span class="w">

   </span><span class="n">usage</span><span class="o">=</span><span class="o">&lt;</span><span class="n">percent</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">usage</span><span class="o">=</span><span class="o">&lt;</span><span class="n">range</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Balances</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">percentage</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">clean</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">completely</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w">  </span><span class="kn">require</span><span class="w">  </span><span class="n">any</span><span class="w">  </span><span class="n">new</span><span class="w">
          </span><span class="n">work</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">allocated</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">usage</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">returning</span><span class="w"> </span><span class="nc">ENOSPC</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">full</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">argument</span><span class="w">  </span><span class="n">may</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">range</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="nc">N</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="nc">N</span><span class="w"> </span><span class="n">percent</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">..</span><span class="nc">N</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">syntax</span><span class="o">.</span><span class="w"> </span><span class="nc">Kernels</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">4.4</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">single</span><span class="w">
          </span><span class="n">value</span><span class="w"> </span><span class="n">format</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">minimum</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">boundary</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">inclusive</span><span class="p">,</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">exclusive</span><span class="o">.</span><span class="w">

   </span><span class="n">devid</span><span class="o">=</span><span class="o">&lt;</span><span class="n">id</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Balances</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ids</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">show</span><span class="o">.</span><span class="w">

   </span><span class="n">drange</span><span class="o">=</span><span class="o">&lt;</span><span class="n">range</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Balance</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">conjunction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">devid</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="n">range</span><span class="w">  </span><span class="n">speci</span><span class="err">‐</span><span class="w">
          </span><span class="n">fied</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">start</span><span class="o">..</span><span class="k">end</span><span class="o">.</span><span class="w">

   </span><span class="n">vrange</span><span class="o">=</span><span class="o">&lt;</span><span class="n">range</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Balance</span><span class="w">  </span><span class="n">only</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="sc">&#39;s internal virtual address space. This is the address space that most reports from btrfs in
          the kernel log use. The parameter is a range specified as start..end.

   convert=&lt;profile&gt;
          Convert each selected block group to the given profile name identified by parameters.

          NOTE:
             Starting with kernel 4.5, the data chunks can be converted to/from the DUP profile on a single device.

             Starting with kernel 4.6, all profiles can be converted to/from DUP on multi-device filesystems.

          WARNING:
             Bad or missing device are not detected immediately during runtime and this depends on some later event like failed write or failed transaction commit.  If  there&#39;</span><span class="n">s</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">known</span><span class="w">
             </span><span class="n">failing</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">deleted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">block</span><span class="o">/</span><span class="o">&lt;</span><span class="n">dev</span><span class="o">&gt;</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">delete</span><span class="w"> </span><span class="n">interface</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">accessed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="o">.</span><span class="w">

             </span><span class="nc">In</span><span class="w">  </span><span class="n">such</span><span class="w">  </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="n">redundancy</span><span class="w"> </span><span class="p" data-group-id="8615714014-2">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">RAID1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SINGLE</span><span class="p" data-group-id="8615714014-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">attempts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">chunks</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">various</span><span class="w">
             </span><span class="n">problems</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">proper</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failing</span><span class="o">/</span><span class="n">missing</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">first</span><span class="o">.</span><span class="w"> </span><span class="nc">Then</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">correctly</span><span class="o">.</span><span class="w">

   </span><span class="n">limit</span><span class="o">=</span><span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">limit</span><span class="o">=</span><span class="o">&lt;</span><span class="n">range</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Process</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">chunks</span><span class="p">,</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">applied</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specifically</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="p" data-group-id="8615714014-3">(</span><span class="n">drange</span><span class="p">,</span><span class="w">  </span><span class="n">vrange</span><span class="p" data-group-id="8615714014-3">)</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">just</span><span class="w">
          </span><span class="n">simply</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">range</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="nc">N</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="nc">N</span><span class="w"> </span><span class="n">chunks</span><span class="p">,</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">..</span><span class="nc">N</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">syntax</span><span class="o">.</span><span class="w"> </span><span class="nc">Kernels</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">4.4</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">for</span><span class="err">‐</span><span class="w">
          </span><span class="n">mat</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">minimum</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">inclusive</span><span class="o">.</span><span class="w">

   </span><span class="n">stripes</span><span class="o">=</span><span class="o">&lt;</span><span class="n">range</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Balance</span><span class="w">  </span><span class="n">only</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stripes</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">start</span><span class="o">..</span><span class="k">end</span><span class="o">.</span><span class="w"> </span><span class="nc">Makes</span><span class="w"> </span><span class="n">sense</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">utilize</span><span class="w"> </span><span class="n">striping</span><span class="p">,</span><span class="w">
          </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="nc">RAID0</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">5</span><span class="o">/</span><span class="mi">6</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">minimum</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">inclusive</span><span class="o">.</span><span class="w">

   </span><span class="n">soft</span><span class="w">   </span><span class="nc">Takes</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">parameters</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">converting</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">profiles</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">doing</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">on</span><span class="p">,</span><span class="w"> </span><span class="n">chunks</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tar</span><span class="err">‐</span><span class="w">
          </span><span class="n">get</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">untouched</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">half</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="n">earlier</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">got</span><span class="w"> </span><span class="n">cancelled</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="p" data-group-id="8615714014-4">(</span><span class="n">like</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">filter</span><span class="p" data-group-id="8615714014-4">)</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">type</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">chunks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s">&quot;hard&quot;</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">converting</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">chunks</span><span class="w"> </span><span class="n">selectively</span><span class="w">
          </span><span class="k">with</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">switch</span><span class="o">.</span><span class="w">

   </span><span class="nc">Profile</span><span class="w"> </span><span class="n">names</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ss">of</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">raid0</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">raid1</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">raid1c3</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">raid1c4</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">raid10</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">raid5</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">raid6</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">dup</span><span class="w">

   </span><span class="err">•</span><span class="w"> </span><span class="n">single</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">mixed</span><span class="w"> </span><span class="n">data</span><span class="o">/</span><span class="n">metadata</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">way</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">conversion</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">mixed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">mixed</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">implemented</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">please</span><span class="w">  </span><span class="n">refer</span><span class="w">  </span><span class="n">to</span><span class="w">
   </span><span class="n">mkfs</span><span class="o">.</span><span class="n">btrfs</span><span class="p" data-group-id="8615714014-5">(</span><span class="mi">8</span><span class="p" data-group-id="8615714014-5">)</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="nc">PROFILES</span><span class="o">.</span></code></pre><p>ENOSPC</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w">  </span><span class="n">way</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operates</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">usually</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">temporarily</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">there</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">removed</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">work</span><span class="w">
   </span><span class="n">space</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">fails</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">ENOSPC</span><span class="w"> </span><span class="n">reasons</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="nc">ENOSPC</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">exhausted</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">refers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w">  </span><span class="n">are</span><span class="w">  </span><span class="n">bigger</span><span class="w">
   </span><span class="n">parts</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">extents</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">calculated</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="ss">command</span><span class="p">:</span><span class="w">

      </span><span class="ss">Label</span><span class="p">:</span><span class="w"> </span><span class="sc">&#39;BTRFS&#39;</span><span class="w">  </span><span class="ss">uuid</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="n">a9d72cd</span><span class="o">-</span><span class="n">ead3</span><span class="o">-</span><span class="mi">469</span><span class="n">d</span><span class="o">-</span><span class="n">b371</span><span class="o">-</span><span class="mi">9</span><span class="n">c7203276265</span><span class="w">
              </span><span class="nc">Total</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nc">FS</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="mf">77.03</span><span class="nc">GiB</span><span class="w">
              </span><span class="n">devid</span><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="mf">53.90</span><span class="nc">GiB</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="mf">51.90</span><span class="nc">GiB</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdc2</span><span class="w">
              </span><span class="n">devid</span><span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="mf">53.90</span><span class="nc">GiB</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="mf">51.90</span><span class="nc">GiB</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sde1</span><span class="w">

   </span><span class="n">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">space</span><span class="w">

   </span><span class="mf">53.90</span><span class="nc">GiB</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">51.90</span><span class="nc">GiB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.00</span><span class="nc">GiB</span><span class="w">

   </span><span class="nc">An</span><span class="w">  </span><span class="n">example</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">workspace</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">usage</span><span class="o">=</span><span class="mi">0</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">reclaim</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">space</span><span class="o">.</span><span class="w"> </span><span class="nc">After</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w">
   </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">filters</span><span class="o">.</span><span class="w">

   </span><span class="nc">CONVERSIONS</span><span class="w"> </span><span class="nc">ON</span><span class="w"> </span><span class="nc">MULTIPLE</span><span class="w"> </span><span class="nc">DEVICES</span><span class="w">

   </span><span class="nc">Conversion</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">striping</span><span class="w"> </span><span class="p" data-group-id="6052113941-1">(</span><span class="nc">RAID0</span><span class="p">,</span><span class="w"> </span><span class="nc">RAID5</span><span class="o">/</span><span class="mi">6</span><span class="p" data-group-id="6052113941-1">)</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">An</span><span class="w"> </span><span class="n">interrupted</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">partially</span><span class="w"> </span><span class="n">filled</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">consume</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">work</span><span class="w">
   </span><span class="n">space</span><span class="o">.</span></code></pre><p>EXAMPLES</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">comprehensive</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">devices</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">back</span><span class="p">,</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="nc">TYPICAL</span><span class="w"> </span><span class="nc">USECASES</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">btrfs</span><span class="o">-</span><span class="n">device</span><span class="p" data-group-id="5755944768-1">(</span><span class="mi">8</span><span class="p" data-group-id="5755944768-1">)</span><span class="o">.</span></code></pre><p>   MAKING BLOCK GROUP LAYOUT MORE COMPACT</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">layout</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">visible</span><span class="p">;</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">summarized</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">space</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">hints</span><span class="w"> </span><span class="n">provided</span><span class="o">.</span><span class="w">

   </span><span class="nc">Let</span><span class="sc">&#39;s use the following real life example and start with the output:

      $ btrfs filesystem df /path
      Data, single: total=75.81GiB, used=64.44GiB
      System, RAID1: total=32.00MiB, used=20.00KiB
      Metadata, RAID1: total=15.87GiB, used=8.84GiB
      GlobalReserve, single: total=512.00MiB, used=0.00B

   Roughly calculating for data, 75G - 64G = 11G, the used/total ratio is about 85%. How can we can interpret that:

   • chunks are filled by 85% on average, i.e. the usage filter with anything smaller than 85 will likely not affect anything

   • in a more realistic scenario, the space is distributed unevenly, we can assume there are completely used chunks and the remaining are partially filled

   Compacting  the layout could be used on both. In the former case it would spread data of a given chunk to the others and removing it. Here we can estimate that roughly 850 MiB of data
   have to be moved (85% of a 1 GiB chunk).

   In the latter case, targeting the partially used chunks will have to move less data and thus will be faster. A typical filter command would look like:

      # btrfs balance start -dusage=50 /path
      Done, had to relocate 2 out of 97 chunks

      $ btrfs filesystem df /path
      Data, single: total=74.03GiB, used=64.43GiB
      System, RAID1: total=32.00MiB, used=20.00KiB
      Metadata, RAID1: total=15.87GiB, used=8.84GiB
      GlobalReserve, single: total=512.00MiB, used=0.00B

   As you can see, the total amount of data is decreased by just 1 GiB, which is an expected result. Let&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">happen</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">increase</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">estimated</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">filter</span><span class="o">.</span><span class="w">

      </span><span class="c1"># btrfs balance start -dusage=85 /path</span><span class="w">
      </span><span class="nc">Done</span><span class="p">,</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">relocate</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">95</span><span class="w"> </span><span class="n">chunks</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">/</span><span class="n">path</span><span class="w">
      </span><span class="nc">Data</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">68.03</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">64.43</span><span class="nc">GiB</span><span class="w">
      </span><span class="nc">System</span><span class="p">,</span><span class="w"> </span><span class="ss">RAID1</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">32.00</span><span class="nc">MiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">20.00</span><span class="nc">KiB</span><span class="w">
      </span><span class="nc">Metadata</span><span class="p">,</span><span class="w"> </span><span class="ss">RAID1</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">15.87</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">8.85</span><span class="nc">GiB</span><span class="w">
      </span><span class="nc">GlobalReserve</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">512.00</span><span class="nc">MiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">0.00</span><span class="nc">B</span><span class="w">

   </span><span class="nc">Now</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">used</span><span class="o">/</span><span class="n">total</span><span class="w"> </span><span class="n">ratio</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="mi">94</span><span class="p">%</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">moved</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="mi">74</span><span class="nc">G</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">68</span><span class="nc">G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="nc">G</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mi">6</span><span class="nc">GiB</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">structures</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">reused</span><span class="w">
   </span><span class="k">for</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="o">.</span><span class="w">

   </span><span class="nc">We</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="k" data-group-id="9704561155-1">do</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">exercise</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">necessary</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">used</span><span class="o">/</span><span class="n">total</span><span class="w"> </span><span class="n">ratio</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">off</span><span class="o">.</span><span class="w"> </span><span class="nc">Here</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ratio</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">roughly</span><span class="w"> </span><span class="mi">50</span><span class="p">%</span><span class="w"> </span><span class="n">but</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">absolute</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="s">&quot;a few gigabytes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">workload</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">snapshots</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">reflinks</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">frequently</span><span class="o">.</span><span class="w">

      </span><span class="c1"># btrfs balance start -musage=50 /path</span><span class="w">
      </span><span class="nc">Done</span><span class="p">,</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">relocate</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="n">chunks</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">/</span><span class="n">path</span><span class="w">
      </span><span class="nc">Data</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">68.03</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">64.43</span><span class="nc">GiB</span><span class="w">
      </span><span class="nc">System</span><span class="p">,</span><span class="w"> </span><span class="ss">RAID1</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">32.00</span><span class="nc">MiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">20.00</span><span class="nc">KiB</span><span class="w">
      </span><span class="nc">Metadata</span><span class="p">,</span><span class="w"> </span><span class="ss">RAID1</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">14.87</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">8.85</span><span class="nc">GiB</span><span class="w">
      </span><span class="nc">GlobalReserve</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">512.00</span><span class="nc">MiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">0.00</span><span class="nc">B</span><span class="w">

   </span><span class="nc">Just</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nc">GiB</span><span class="w"> </span><span class="n">decrease</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">possibly</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">utilization</span><span class="o">.</span><span class="w"> </span><span class="nc">Making</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">layout</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">compact</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">turn</span><span class="w"> </span><span class="kn">require</span><span class="w">  </span><span class="n">updating</span><span class="w">  </span><span class="n">more</span><span class="w">  </span><span class="n">metadata</span><span class="w">  </span><span class="n">struc</span><span class="err">‐</span><span class="w">
   </span><span class="n">tures</span><span class="p">,</span><span class="w">  </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w">  </span><span class="n">lots</span><span class="w">  </span><span class="n">of</span><span class="w"> </span><span class="nc">IO</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">severe</span><span class="w"> </span><span class="n">problem</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="sc">&#39;s not necessary to keep the utilization ratio too high. For the purpose of this example, let&#39;</span><span class="n">s</span><span class="w">
   </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">effects</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="ss">compaction</span><span class="p">:</span><span class="w">

      </span><span class="c1"># btrfs balance start -musage=70 /path</span><span class="w">
      </span><span class="nc">Done</span><span class="p">,</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">relocate</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">88</span><span class="w"> </span><span class="n">chunks</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">.</span><span class="w">
      </span><span class="nc">Data</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">68.03</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">64.43</span><span class="nc">GiB</span><span class="w">
      </span><span class="nc">System</span><span class="p">,</span><span class="w"> </span><span class="ss">RAID1</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">32.00</span><span class="nc">MiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">20.00</span><span class="nc">KiB</span><span class="w">
      </span><span class="nc">Metadata</span><span class="p">,</span><span class="w"> </span><span class="ss">RAID1</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">11.97</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">8.83</span><span class="nc">GiB</span><span class="w">
      </span><span class="nc">GlobalReserve</span><span class="p">,</span><span class="w"> </span><span class="ss">single</span><span class="p">:</span><span class="w"> </span><span class="n">total</span><span class="o">=</span><span class="mf">512.00</span><span class="nc">MiB</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="o">=</span><span class="mf">0.00</span><span class="nc">B</span></code></pre><p>   GETTING RID OF COMPLETELY UNUSED BLOCK GROUPS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Normally</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">space</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">temporarily</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">removed</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="sc">&#39;s no work space, it ends with no space left.

   There&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">completely</span><span class="w"> </span><span class="n">unused</span><span class="p">,</span><span class="w"> </span><span class="n">possibly</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">removing</span><span class="w"> </span><span class="n">lots</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">deleting</span><span class="w"> </span><span class="n">snapshots</span><span class="o">.</span><span class="w"> </span><span class="nc">Removing</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">automatic</span><span class="w">  </span><span class="n">since</span><span class="w">
   </span><span class="mf">3.18</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">  </span><span class="n">same</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">achieved</span><span class="w"> </span><span class="n">manually</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">notable</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">space</span><span class="o">.</span><span class="w"> </span><span class="nc">Thus</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reclaim</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">it</span><span class="w">
   </span><span class="n">available</span><span class="o">.</span><span class="w">

      </span><span class="c1"># btrfs balance start -dusage=0 /path</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">decrease</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="n">output</span><span class="o">.</span></code></pre><p>EXIT STATUS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Unless</span><span class="w"> </span><span class="n">indicated</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">below</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">subcommands</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">succeed</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">non</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">pause</span><span class="p">,</span><span class="w"> </span><span class="n">cancel</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">resume</span><span class="w"> </span><span class="n">subcommands</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">running</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">subcommand</span><span class="w"> </span><span class="n">exits</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">-</span><span class="n">line</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">on</span><span class="w">  </span><span class="n">other</span><span class="w">
   </span><span class="n">errors</span><span class="o">.</span></code></pre><p>AVAILABILITY</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">btrfs</span><span class="o">-</span><span class="n">progs</span><span class="o">.</span><span class="w">  </span><span class="nc">Please</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="ss">://</span><span class="n">btrfs</span><span class="o">.</span><span class="n">readthedocs</span><span class="o">.</span><span class="n">io</span><span class="o">.</span></code></pre><p>SEE ALSO</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">mkfs</span><span class="o">.</span><span class="n">btrfs</span><span class="p" data-group-id="9625758039-1">(</span><span class="mi">8</span><span class="p" data-group-id="9625758039-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">btrfs</span><span class="o">-</span><span class="n">device</span><span class="p" data-group-id="9625758039-2">(</span><span class="mi">8</span><span class="p" data-group-id="9625758039-2">)</span></code></pre><p>6.14                                                                                     Apr 17, 2025                                                                         BTRFS-BALANCE(8)</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="btrfs-balance-least-used.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
btrfs-balance-least-used
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="btrfsck.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
btrfsck
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
