<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.23.0">
    <meta name="project" content="Kaisen-linux v0.0.1">
    <title>sslsplit — Kaisen-linux v0.0.1</title>
    <link rel="stylesheet" href="dist/elixir-9f91ebe876dc01d67920.css" />
    <script src="dist/sidebar_items-0baf9f48e2.js"></script>
      <script src="doc-versions.js"></script>
    <script async src="dist/app-60a0c9f10e9e52eae31f.js"></script>
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="#homepage_url" class="sidebar-projectName">
Kaisen-linux      </a>
      <strong class="sidebar-projectVersion">
        v0.0.1
      </strong>
    </div>
      <a href="#homepage_url">
        <img src="assets/logo.jpg" alt="Kaisen-linux" class="sidebar-projectImage">
      </a>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">MANUAL</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

<p>sslsplit(1)                                                                   SSLsplit                                                                   sslsplit(1)</p><p>NAME</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">transparent</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">interception</span></code></pre><p>SYNOPSIS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="n">sslsplit</span><span class="w"> </span><span class="p" data-group-id="2640333650-1">[</span><span class="o">-</span><span class="n">kCKqwWOPZdDgGsrRxeumjplLSFXYyTIMiab</span><span class="p" data-group-id="2640333650-1">]</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pem</span><span class="w"> </span><span class="n">proxyspecs</span><span class="w"> </span><span class="p" data-group-id="2640333650-2">[</span><span class="n">...</span><span class="p" data-group-id="2640333650-2">]</span><span class="w">
   </span><span class="n">sslsplit</span><span class="w"> </span><span class="p" data-group-id="2640333650-3">[</span><span class="o">-</span><span class="n">kCKqwWOPZdDgGsrRxeumjplLSFXYyTIMiab</span><span class="p" data-group-id="2640333650-3">]</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pem</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="n">proxyspecs</span><span class="w"> </span><span class="p" data-group-id="2640333650-4">[</span><span class="n">...</span><span class="p" data-group-id="2640333650-4">]</span><span class="w">
   </span><span class="n">sslsplit</span><span class="w"> </span><span class="p" data-group-id="2640333650-5">[</span><span class="o">-</span><span class="nc">OPZwWdDgGsrRxeumjplLSFXYyTIMiab</span><span class="p" data-group-id="2640333650-5">]</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="n">proxyspecs</span><span class="w"> </span><span class="p" data-group-id="2640333650-6">[</span><span class="n">...</span><span class="p" data-group-id="2640333650-6">]</span><span class="w">
   </span><span class="n">sslsplit</span><span class="w"> </span><span class="p" data-group-id="2640333650-7">[</span><span class="o">-</span><span class="n">kCKwWOPZdDgGsrRxeumjplLSFXYyTIMi</span><span class="p" data-group-id="2640333650-7">]</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">conffile</span><span class="w">
   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="nc">E</span><span class="w">
   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="nc">V</span><span class="w">
   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="n">h</span></code></pre><p>DESCRIPTION</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">man</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">middle</span><span class="w"> </span><span class="n">attacks</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">forensics</span><span class="p">,</span><span class="w"> </span><span class="n">applica</span><span class="err">‐</span><span class="w">
   </span><span class="n">tion</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">analysis</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">penetration</span><span class="w"> </span><span class="n">testing</span><span class="o">.</span><span class="w">

   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">transparently</span><span class="w"> </span><span class="n">terminate</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">redirected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">translation</span><span class="w"> </span><span class="n">engine</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">then</span><span class="w">  </span><span class="n">terminates</span><span class="w">
   </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">initiates</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">new</span><span class="w">  </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w">  </span><span class="n">connection</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">transmitted</span><span class="o">.</span><span class="w">  </span><span class="nc">Besides</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w">
   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">destinations</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">indicated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">SNI</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">upstream</span><span class="w"> </span><span class="n">destination</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">purely</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="n">transparent</span><span class="w">  </span><span class="n">proxy</span><span class="w">  </span><span class="ow">and</span><span class="w">
   </span><span class="n">cannot</span><span class="w">  </span><span class="n">act</span><span class="w">  </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SOCKS</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">browser</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="nc">ENGINES</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">PROXY</span><span class="w"> </span><span class="nc">SPECIFICATIONS</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">specifics</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">opera</span><span class="err">‐</span><span class="w">
   </span><span class="n">tion</span><span class="o">.</span><span class="w">

   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">plain</span><span class="w"> </span><span class="nc">TCP</span><span class="p">,</span><span class="w"> </span><span class="n">plain</span><span class="w"> </span><span class="nc">SSL</span><span class="p">,</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HTTPS</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IPv6</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="n">plain</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="nc">SSL</span><span class="w">
   </span><span class="ow">in</span><span class="w">  </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generically</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="nc">SMTP</span><span class="w"> </span><span class="nc">STARTTLS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="n">mechanisms</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">fully</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">Server</span><span class="w"> </span><span class="nc">Name</span><span class="w"> </span><span class="nc">Indication</span><span class="w"> </span><span class="p" data-group-id="5800784855-1">(</span><span class="nc">SNI</span><span class="p" data-group-id="5800784855-1">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">with</span><span class="w">
   </span><span class="nc">RSA</span><span class="p">,</span><span class="w"> </span><span class="nc">DSA</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">ECDSA</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">DHE</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">ECDHE</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="o">.</span><span class="w">  </span><span class="nc">Depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TLS</span><span class="w">  </span><span class="mf">1.2</span><span class="p">,</span><span class="w">  </span><span class="ow">and</span><span class="w">
   </span><span class="n">optionally</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w">  </span><span class="nc">SSL</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="nc">HTTPS</span><span class="w"> </span><span class="n">connections</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">generates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">signs</span><span class="w"> </span><span class="n">forged</span><span class="w"> </span><span class="nc">X509v3</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">fly</span><span class="p">,</span><span class="w"> </span><span class="n">mimicking</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">certificate</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="nc">DN</span><span class="p">,</span><span class="w">
   </span><span class="n">subjectAltName</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">characteristics</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="p">,</span><span class="w"> </span><span class="n">instead</span><span class="w">  </span><span class="n">of</span><span class="w">
   </span><span class="n">generating</span><span class="w">  </span><span class="n">forged</span><span class="w">  </span><span class="n">ones</span><span class="o">.</span><span class="w">   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">prefix</span><span class="w"> </span><span class="nc">CN</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">exploits</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">verification</span><span class="w">
   </span><span class="n">vulnerabilities</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">stacks</span><span class="o">.</span><span class="w">

   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">defences</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">mechanisms</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="nc">MitM</span><span class="w"> </span><span class="n">attacks</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">difficult</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="n">deny</span><span class="w">  </span><span class="nc">OCSP</span><span class="w">
   </span><span class="n">requests</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">generic</span><span class="w">  </span><span class="n">way</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HTTPS</span><span class="w"> </span><span class="n">connections</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">mangles</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">server</span><span class="o">-</span><span class="n">instructed</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">pinning</span><span class="w"> </span><span class="p" data-group-id="5800784855-2">(</span><span class="nc">HPKP</span><span class="p" data-group-id="5800784855-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">strict</span><span class="w">
   </span><span class="n">transport</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">restrictions</span><span class="w"> </span><span class="p" data-group-id="5800784855-3">(</span><span class="nc">HSTS</span><span class="p" data-group-id="5800784855-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="nc">Certificate</span><span class="w"> </span><span class="nc">Transparency</span><span class="w"> </span><span class="n">enforcement</span><span class="w"> </span><span class="p" data-group-id="5800784855-4">(</span><span class="nc">Expect</span><span class="o">-</span><span class="nc">CT</span><span class="p" data-group-id="5800784855-4">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">switching</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">QUIC</span><span class="o">/</span><span class="nc">SPDY</span><span class="p">,</span><span class="w"> </span><span class="nc">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">WebSockets</span><span class="w">  </span><span class="p" data-group-id="5800784855-5">(</span><span class="nc">Up</span><span class="err">‐</span><span class="w">
   </span><span class="n">grade</span><span class="p">,</span><span class="w"> </span><span class="nc">Alternate</span><span class="w"> </span><span class="nc">Protocols</span><span class="p" data-group-id="5800784855-5">)</span><span class="o">.</span><span class="w">  </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">compression</span><span class="p">,</span><span class="w"> </span><span class="n">encodings</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">keep</span><span class="o">-</span><span class="n">alive</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logs</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">readable</span><span class="o">.</span><span class="w">

   </span><span class="nc">Logging</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">traditional</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">PCAP</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">mirroring</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">  </span><span class="nc">Ad</span><span class="err">‐</span><span class="w">
   </span><span class="n">ditionally</span><span class="p">,</span><span class="w"> </span><span class="n">certificates</span><span class="p">,</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">secrets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">logged</span><span class="o">.</span><span class="w">

   </span><span class="nc">In</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chances</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">split</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">upstream</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">  </span><span class="nc">Instead</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w">
   </span><span class="n">certificates</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">self</span><span class="o">-</span><span class="n">signed</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accepted</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">hostname</span><span class="w"> </span><span class="n">signalled</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">SNI</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">dy</span><span class="err">‐</span><span class="w">
   </span><span class="n">namically</span><span class="w"> </span><span class="n">forged</span><span class="w"> </span><span class="n">certificates</span><span class="o">.</span><span class="w">

   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">automagically</span><span class="w"> </span><span class="n">redirect</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">traffic</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">actually</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attack</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">redirect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">system</span><span class="w">  </span><span class="n">running</span><span class="w">
   </span><span class="n">sslsplit</span><span class="o">.</span><span class="w">  </span><span class="nc">Your</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sslsplit</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">legitimate</span><span class="w"> </span><span class="n">router</span><span class="p">,</span><span class="w"> </span><span class="nc">ARP</span><span class="w"> </span><span class="n">spoofing</span><span class="p">,</span><span class="w"> </span><span class="nc">ND</span><span class="w"> </span><span class="n">spoofing</span><span class="p">,</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">poisoning</span><span class="p">,</span><span class="w"> </span><span class="n">deploying</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rogue</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="p" data-group-id="5800784855-6">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">using</span><span class="w">
   </span><span class="n">hostap</span><span class="w"> </span><span class="n">mode</span><span class="p" data-group-id="5800784855-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">recabling</span><span class="p">,</span><span class="w"> </span><span class="n">malicious</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="n">reconfiguration</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">injection</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span><span class="w"> </span><span class="n">modification</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">on</span><span class="o">.</span></code></pre><p>OPTIONS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="n">pemfile</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="o">.</span><span class="w">  </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w">  </span><span class="n">certificate</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">certificate</span><span class="w">
          </span><span class="n">chain</span><span class="w">  </span><span class="n">from</span><span class="w"> </span><span class="nc">PEM</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">leaf</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">generating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">leaf</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fly</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="nc">PEM</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w">
          </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">intermediate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">attempt</span><span class="w">  </span><span class="n">to</span><span class="w">
          </span><span class="kn">use</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">matching</span><span class="w">  </span><span class="n">certificate</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">certdir</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w">
          </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">instead</span><span class="p">,</span><span class="w"> </span><span class="n">taking</span><span class="w"> </span><span class="n">precedence</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="n">pemfile</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pemfile</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">forged</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">fly</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w"> </span><span class="n">oth</span><span class="err">‐</span><span class="w">
          </span><span class="n">erwise</span><span class="w">  </span><span class="n">it</span><span class="w">  </span><span class="n">must</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="nc">Diffie</span><span class="o">-</span><span class="nc">Hellman</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">parameters</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">provided</span><span class="w">
          </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">forge</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">C</span><span class="w"> </span><span class="n">pemfile</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">sub</span><span class="o">-</span><span class="nc">CA</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">which</span><span class="w">
          </span><span class="k">case</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">intermediate</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">d</span><span class="w">     </span><span class="nc">Detach</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">TTY</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">daemon</span><span class="p">,</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">syslog</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">D</span><span class="w">     </span><span class="nc">Run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">lots</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">debugging</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">forces</span><span class="w"> </span><span class="n">foreground</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">engine</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">proxyspecs</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SNI</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">  </span><span class="n">engine</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NAT</span><span class="w">
          </span><span class="n">engines</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="nc">E</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">E</span><span class="w">     </span><span class="nc">List</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engines</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="nc">ENGINES</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engines</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">conffile</span><span class="w">
          </span><span class="nc">Read</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">conffile</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">F</span><span class="w"> </span><span class="n">logspec</span><span class="w">
          </span><span class="nc">Log</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="p" data-group-id="6228898476-1">(</span><span class="n">see</span><span class="w"> </span><span class="nc">LOG</span><span class="w"> </span><span class="nc">SPECIFICATIONS</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="6228898476-1">)</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">log</span><span class="w">  </span><span class="n">file</span><span class="w">  </span><span class="n">will</span><span class="w">
          </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">directions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">transmitted</span><span class="o">.</span><span class="w">  </span><span class="nc">Information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w">
          </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">-</span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">L</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="6228898476-2">(</span><span class="n">last</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">wins</span><span class="p" data-group-id="6228898476-2">)</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">pemfile</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">Diffie</span><span class="o">-</span><span class="nc">Hellman</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">pemfile</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Ephemereal</span><span class="w"> </span><span class="nc">Diffie</span><span class="o">-</span><span class="nc">Hellman</span><span class="w"> </span><span class="p" data-group-id="6228898476-3">(</span><span class="nc">EDH</span><span class="o">/</span><span class="nc">DHE</span><span class="p" data-group-id="6228898476-3">)</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">first</span><span class="w">  </span><span class="n">tries</span><span class="w">  </span><span class="n">to</span><span class="w">
          </span><span class="n">load</span><span class="w">  </span><span class="nc">DH</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PEM</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="nc">K</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="nc">DH</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">automati</span><span class="err">‐</span><span class="w">
          </span><span class="n">cally</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">Diffie</span><span class="o">-</span><span class="nc">Hellman</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">G</span><span class="w"> </span><span class="n">curve</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Ephemereal</span><span class="w"> </span><span class="nc">Elliptic</span><span class="w"> </span><span class="nc">Curve</span><span class="w"> </span><span class="nc">Diffie</span><span class="o">-</span><span class="nc">Hellman</span><span class="w"> </span><span class="p" data-group-id="6228898476-4">(</span><span class="nc">ECDHE</span><span class="p" data-group-id="6228898476-4">)</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="o">-</span><span class="nc">G</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="p" data-group-id="6228898476-5">(</span><span class="n">prime256v1</span><span class="p" data-group-id="6228898476-5">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w">  </span><span class="n">au</span><span class="err">‐</span><span class="w">
          </span><span class="n">tomatically</span><span class="o">.</span><span class="w">   </span><span class="nc">The</span><span class="w">  </span><span class="o">-</span><span class="nc">G</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">Elliptic</span><span class="w"> </span><span class="nc">Curve</span><span class="w"> </span><span class="nc">Diffie</span><span class="o">-</span><span class="nc">Hellman</span><span class="w"> </span><span class="n">cipher</span><span class="w">
          </span><span class="n">suites</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">h</span><span class="w">     </span><span class="nc">Display</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">i</span><span class="w">     </span><span class="nc">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">owning</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">owner</span><span class="ss">:group</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">executable</span><span class="w">  </span><span class="n">path</span><span class="w">  </span><span class="k">for</span><span class="w">
          </span><span class="n">connections</span><span class="w">  </span><span class="n">originating</span><span class="w">  </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">enables</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="o">-</span><span class="nc">F</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="n">directives</span><span class="o">.</span><span class="w">  </span><span class="o">-</span><span class="n">i</span><span class="w">
          </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Mac</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">FreeBSD</span><span class="p">;</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">platforms</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="n">yet</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">I</span><span class="w"> </span><span class="k">if</span><span class="w">  </span><span class="nc">Mirror</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">emulated</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="nc">T</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">available</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">was</span><span class="w">
          </span><span class="n">built</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">mirroring</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">jaildir</span><span class="w">
          </span><span class="nc">Change</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">jaildir</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">chroot</span><span class="p" data-group-id="6228898476-6">(</span><span class="mi">2</span><span class="p" data-group-id="6228898476-6">)</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">opening</span><span class="w"> </span><span class="n">files</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">implications</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sni</span><span class="w"> </span><span class="n">proxyspecs</span><span class="o">.</span><span class="w">  </span><span class="nc">Depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">op</span><span class="err">‐</span><span class="w">
          </span><span class="n">erating</span><span class="w"> </span><span class="n">system</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">resolv</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">jaildir</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">work</span><span class="o">.</span><span class="w">  </span><span class="nc">Using</span><span class="w"> </span><span class="n">sni</span><span class="w"> </span><span class="n">proxyspecs</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w">
          </span><span class="n">name</span><span class="w"> </span><span class="n">resolution</span><span class="o">.</span><span class="w">  </span><span class="nc">Some</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">jail</span><span class="o">.</span><span class="w">  </span><span class="nc">Check</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">system</span><span class="sc">&#39;s documenta‐
          tion for details.

   -k pemfile
          Use CA private key from pemfile to sign certificates forged on-the-fly.  If pemfile also contains the matching CA certificate, it is also loaded, oth‐
          erwise  it  must  be provided with -c.  If pemfile also contains Diffie-Hellman group parameters, they are also loaded, otherwise they can be provided
          with -g.  If -t is also given, SSLsplit will only forge a certificate if there is no matching certificate in the provided certificate directory.

   -K pemfile
          Use private key from pemfile for the leaf certificates forged on-the-fly.  If -K is not given, SSLsplit will generate a random 2048 bit RSA key.

   -l logfile
          Log connections to logfile in a single line per connection format, including addresses and ports and some HTTP and SSL information, if available.  SI‐
          GUSR1 will cause logfile to be re-opened.

   -L logfile
          Log  connection  content to logfile.  The content log will contain a parsable log format with transmitted data, prepended with headers identifying the
          connection and the data length of each logged segment.  SIGUSR1 will cause logfile to be re-opened.  Only one of -F, -L and -S may be used  (last  one
          wins).

   -m     When dropping privileges using -u, override the target primary group to be set to group.

   -M logfile
          Log master keys to logfile in SSLKEYLOGFILE format as defined by Mozilla.  Logging master keys in this format allows for decryption of SSL/TLS traffic
          using Wireshark.  Note that unlike browsers implementing this feature, setting the SSLKEYLOGFILE environment variable has no effect on SSLsplit.   SI‐
          GUSR1 will cause logfile to be re-opened.

   -O     Deny all Online Certificate Status Protocol (OCSP) requests on all proxyspecs and for all OCSP servers with an OCSP response of tryLater, causing OCSP
          clients to temporarily accept even revoked certificates.  HTTP requests are being treated as OCSP requests if the method is GET and the URI contains a
          syntactically  valid  OCSPRequest ASN.1 structure parsable by OpenSSL, or if the method is POST and the Content-Type is application/ocsp-request.  For
          this to be effective, SSLsplit must be handling traffic destined to the port used by the OCSP server.  In particular, SSLsplit must be  configured  to
          receive traffic to all ports used by OCSP servers of targeted certificates within the certdir specified by -t.

   -p pidfile
          Write the process ID to pidfile and refuse to run if the pidfile is already in use by another process.

   -P     Passthrough  SSL/TLS  connections which cannot be split instead of dropping them.  Connections cannot be split if -c and -k are not given and the site
          does not match any certificate loaded using -t, or if the connection to the original server gives SSL/TLS errors.  Specifically, this happens  if  the
          site  requests a client certificate.  In these situations, passthrough with -P results in uninterrupted service for the clients, while dropping is the
          more secure alternative if unmonitored connections must be prevented.  Passthrough mode currently does not apply to SSL/TLS errors in  the  connection
          from  the client, since the connection from the client cannot easily be retried.  Specifically, -P does not currently work for clients that do not ac‐
          cept forged certificates.

   -q crlurl
          Set CRL distribution point (CDP) crlurl on forged leaf certificates.  Some clients, such as some .NET applications, reject certificates  that  do  not
          carry  a  CDP.  When using -q, you will need to generate an empty CRL signed by the CA certificate and key provided with -c and -k, and make it avail‐
          able at crlurl.

   -r proto
          Force SSL/TLS protocol version on both client and server side to proto by selecting the respective OpenSSL method constructor instead of  the  default
          SSLv23_method()  which  supports  all  protocol  versions.  This is useful when analyzing traffic to a server that only supports a specific version of
          SSL/TLS and does not implement proper protocol negotiation.  Depending on build options and the version of OpenSSL that is used, the following  values
          for  proto  are  accepted: ssl2, ssl3, tls10, tls11 and tls12.  Note that SSL 2.0 support is not built in by default because some servers don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">handle</span><span class="w">
          </span><span class="nc">SSL</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="nc">Client</span><span class="w"> </span><span class="nc">Hello</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">gracefully</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">R</span><span class="w"> </span><span class="n">proto</span><span class="w">
          </span><span class="nc">Disable</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">disabling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">multiple</span><span class="w">  </span><span class="n">pro</span><span class="err">‐</span><span class="w">
          </span><span class="n">tocol</span><span class="w">  </span><span class="n">versions</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">R</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">times</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">disabling</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">versions</span><span class="o">.</span><span class="w">  </span><span class="nc">Disabling</span><span class="w"> </span><span class="n">proto</span><span class="err">‐</span><span class="w">
          </span><span class="n">col</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">analyzing</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">well</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">behaviour</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">proto</span><span class="err">‐</span><span class="w">
          </span><span class="n">col</span><span class="w">  </span><span class="n">versions</span><span class="o">.</span><span class="w">   </span><span class="nc">Depending</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="n">build</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ss">accepted</span><span class="p">:</span><span class="w"> </span><span class="n">ssl2</span><span class="p">,</span><span class="w"> </span><span class="n">ssl3</span><span class="p">,</span><span class="w"> </span><span class="n">tls10</span><span class="p">,</span><span class="w">
          </span><span class="n">tls11</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tls12</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">servers</span><span class="w"> </span><span class="n">don</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="nc">Client</span><span class="w"> </span><span class="nc">Hello</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">gracefully</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">ciphers</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">ALL</span><span class="ss">:-</span><span class="n">aNULL</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">Normally</span><span class="p">,</span><span class="w">
          </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w">  </span><span class="n">implementations</span><span class="w"> </span><span class="n">choose</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fastest</span><span class="w"> </span><span class="n">ones</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ci</span><span class="err">‐</span><span class="w">
          </span><span class="n">pher</span><span class="w"> </span><span class="n">suites</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="n">algorithms</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">eNULL</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">successful</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">cipher</span><span class="w">
          </span><span class="n">suites</span><span class="w">  </span><span class="n">must</span><span class="w">  </span><span class="n">include</span><span class="w">  </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suite</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="n">ciphers</span><span class="p" data-group-id="6228898476-7">(</span><span class="mi">1</span><span class="p" data-group-id="6228898476-7">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w">
          </span><span class="n">construct</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">lists</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="n">logdir</span><span class="w">
          </span><span class="nc">Log</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">logdir</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="n">contain</span><span class="w">  </span><span class="n">both</span><span class="w">  </span><span class="n">directions</span><span class="w">  </span><span class="n">of</span><span class="w">
          </span><span class="n">data</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">transmitted</span><span class="o">.</span><span class="w">  </span><span class="nc">Information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">-</span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">L</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="6228898476-8">(</span><span class="n">last</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">wins</span><span class="p" data-group-id="6228898476-8">)</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">certdir</span><span class="w">
          </span><span class="nc">Use</span><span class="w">  </span><span class="n">private</span><span class="w">  </span><span class="n">key</span><span class="p">,</span><span class="w">  </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">PEM</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">certdir</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">hostnames</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="n">certificates</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
          </span><span class="n">stead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">forged</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">fly</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="nc">PEM</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">optionally</span><span class="w">  </span><span class="n">intermediate</span><span class="w">
          </span><span class="ow">and</span><span class="w">  </span><span class="n">root</span><span class="w">  </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">certdir</span><span class="o">.</span><span class="w">
          </span><span class="nc">If</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">certdir</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PEM</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="n">op</span><span class="err">‐</span><span class="w">
          </span><span class="n">tion</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">used</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span><span class="w">  </span><span class="nc">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">forged</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">fly</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sites</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="ow">in</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">certdir</span><span class="o">.</span><span class="w">  </span><span class="nc">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dropped</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w">  </span><span class="o">-</span><span class="nc">P</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">given</span><span class="p">,</span><span class="w">  </span><span class="n">passed</span><span class="w">  </span><span class="n">through</span><span class="w">  </span><span class="n">without</span><span class="w">
          </span><span class="n">splitting</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">T</span><span class="w"> </span><span class="n">addr</span><span class="w">
          </span><span class="nc">Mirror</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">emulated</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="nc">I</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">sup</span><span class="err">‐</span><span class="w">
          </span><span class="n">ported</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">mirroring</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">user</span><span class="w">
          </span><span class="nc">Drop</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">opening</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">real</span><span class="p">,</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="nc">IDs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">loading</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="n">primary</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">an</span><span class="err">‐</span><span class="w">
          </span><span class="n">cillary</span><span class="w">  </span><span class="n">groups</span><span class="o">.</span><span class="w">   </span><span class="nc">If</span><span class="w">  </span><span class="o">-</span><span class="n">u</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="nc">UID</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">EUID</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nc">UID</span><span class="w"> </span><span class="p" data-group-id="6228898476-9">(</span><span class="n">setuid</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">scenario</span><span class="p" data-group-id="6228898476-9">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">nobody</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">running</span><span class="w">
          </span><span class="k">with</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="p" data-group-id="6228898476-10">(</span><span class="nc">EUID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">UID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="6228898476-10">)</span><span class="o">.</span><span class="w">  </span><span class="nc">User</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">outbound</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connections</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">some</span><span class="w">  </span><span class="n">configurations</span><span class="p">,</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">also</span><span class="w">
          </span><span class="n">perform</span><span class="w">  </span><span class="nc">DNS</span><span class="w">  </span><span class="n">resolution</span><span class="o">.</span><span class="w">  </span><span class="nc">Dropping</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">enables</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">separation</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">incurs</span><span class="w"> </span><span class="n">latency</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">connection</span><span class="w">
          </span><span class="n">log</span><span class="w"> </span><span class="n">files</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">dropping</span><span class="w"> </span><span class="n">privileges</span><span class="o">.</span><span class="w">  </span><span class="nc">Due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">Apple</span><span class="w"> </span><span class="n">bug</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">pf</span><span class="w">  </span><span class="n">proxyspecs</span><span class="w">  </span><span class="n">on</span><span class="w">
          </span><span class="nc">Mac</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">engine</span><span class="w">
          </span><span class="nc">Use</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">OpenSSL</span><span class="w">  </span><span class="n">engine</span><span class="w">  </span><span class="k">with</span><span class="w">  </span><span class="n">identifier</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">engine</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">ecosystem</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w">
          </span><span class="n">identifier</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">configuration</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">absolute</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">path</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">an</span><span class="w">
          </span><span class="n">engine</span><span class="w">  </span><span class="n">dynamically</span><span class="w">  </span><span class="n">linked</span><span class="w">  </span><span class="n">library</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">configuration</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w">
          </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">X</span><span class="w"> </span><span class="n">pcapfile</span><span class="w">
          </span><span class="nc">Log</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pcapfile</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">PCAP</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">emulated</span><span class="w"> </span><span class="nc">TCP</span><span class="p">,</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">headers</span><span class="o">.</span><span class="w">  </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">pcapfile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">opened</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">one</span><span class="w">
          </span><span class="n">of</span><span class="w"> </span><span class="o">-</span><span class="nc">X</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">Y</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="6228898476-11">(</span><span class="n">last</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">wins</span><span class="p" data-group-id="6228898476-11">)</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">Y</span><span class="w"> </span><span class="n">pcapdir</span><span class="w">
          </span><span class="nc">Log</span><span class="w">  </span><span class="n">connection</span><span class="w">  </span><span class="n">content</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="nc">PCAP</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">pcapdir</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="nc">PCAP</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">-</span><span class="nc">X</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">Y</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w">
          </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="6228898476-12">(</span><span class="n">last</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">wins</span><span class="p" data-group-id="6228898476-12">)</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">pcapspec</span><span class="w">
          </span><span class="nc">Log</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="nc">PCAP</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="p" data-group-id="6228898476-13">(</span><span class="n">see</span><span class="w"> </span><span class="nc">LOG</span><span class="w"> </span><span class="nc">SPECIFICATIONS</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="6228898476-13">)</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">separate</span><span class="w">  </span><span class="nc">PCAP</span><span class="w">
          </span><span class="n">file</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">-</span><span class="nc">X</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">Y</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="6228898476-14">(</span><span class="n">last</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">wins</span><span class="p" data-group-id="6228898476-14">)</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">V</span><span class="w">     </span><span class="nc">Display</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">gendir</span><span class="w">
          </span><span class="nc">Write</span><span class="w">  </span><span class="n">generated</span><span class="w">  </span><span class="n">keys</span><span class="w">  </span><span class="ow">and</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">individual</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">gendir</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">1</span><span class="w">
          </span><span class="n">hash</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">ASN</span><span class="o">.</span><span class="mi">1</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">referenced</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subjectKeyIdentifier</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">certificates</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">certificates</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">fin</span><span class="err">‐</span><span class="w">
          </span><span class="n">gerprints</span><span class="w">  </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="6228898476-15">(</span><span class="n">forged</span><span class="p" data-group-id="6228898476-15">)</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filename</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">newly</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">writ</span><span class="err">‐</span><span class="w">
          </span><span class="n">ten</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disk</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">W</span><span class="w"> </span><span class="n">gendir</span><span class="w">
          </span><span class="nc">Same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">newly</span><span class="w"> </span><span class="n">generated</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="o">.</span><span class="w">

   </span><span class="o">-</span><span class="nc">Z</span><span class="w">     </span><span class="nc">Disable</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">limiting</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">CPU</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">bandwidth</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="o">-</span><span class="nc">Z</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">avail</span><span class="err">‐</span><span class="w">
          </span><span class="n">able</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">disabling</span><span class="w"> </span><span class="n">compression</span><span class="o">.</span></code></pre><p>PROXY SPECIFICATIONS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Proxy</span><span class="w">  </span><span class="n">specifications</span><span class="w"> </span><span class="p" data-group-id="9538057820-1">(</span><span class="n">proxyspecs</span><span class="p" data-group-id="9538057820-1">)</span><span class="w"> </span><span class="n">consist</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">listen</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">forward</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="p" data-group-id="9538057820-2">(</span><span class="nc">NAT</span><span class="w"> </span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="nc">SNI</span><span class="w">
   </span><span class="nc">DNS</span><span class="w"> </span><span class="n">lookup</span><span class="p" data-group-id="9538057820-2">)</span><span class="p">:</span><span class="w">

   </span><span class="n">https</span><span class="w"> </span><span class="n">listenaddr</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="9538057820-3">[</span><span class="n">nat</span><span class="o">-</span><span class="n">engine</span><span class="o">|</span><span class="n">fwdaddr</span><span class="w"> </span><span class="n">port</span><span class="o">|</span><span class="n">sni</span><span class="w"> </span><span class="n">port</span><span class="p" data-group-id="9538057820-3">]</span><span class="w">
   </span><span class="n">ssl</span><span class="w">   </span><span class="n">listenaddr</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="9538057820-4">[</span><span class="n">nat</span><span class="o">-</span><span class="n">engine</span><span class="o">|</span><span class="n">fwdaddr</span><span class="w"> </span><span class="n">port</span><span class="o">|</span><span class="n">sni</span><span class="w"> </span><span class="n">port</span><span class="p" data-group-id="9538057820-4">]</span><span class="w">
   </span><span class="n">http</span><span class="w">  </span><span class="n">listenaddr</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="9538057820-5">[</span><span class="n">nat</span><span class="o">-</span><span class="n">engine</span><span class="o">|</span><span class="n">fwdaddr</span><span class="w"> </span><span class="n">port</span><span class="p" data-group-id="9538057820-5">]</span><span class="w">
   </span><span class="n">tcp</span><span class="w">   </span><span class="n">listenaddr</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="9538057820-6">[</span><span class="n">nat</span><span class="o">-</span><span class="n">engine</span><span class="o">|</span><span class="n">fwdaddr</span><span class="w"> </span><span class="n">port</span><span class="p" data-group-id="9538057820-6">]</span><span class="w">
   </span><span class="n">autossl</span><span class="w"> </span><span class="n">listenaddr</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="9538057820-7">[</span><span class="n">nat</span><span class="o">-</span><span class="n">engine</span><span class="o">|</span><span class="n">fwdaddr</span><span class="w"> </span><span class="n">port</span><span class="p" data-group-id="9538057820-7">]</span><span class="w">

   </span><span class="n">https</span><span class="w">  </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">interception</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">decoding</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">removal</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">HPKP</span><span class="p">,</span><span class="w"> </span><span class="nc">HSTS</span><span class="p">,</span><span class="w"> </span><span class="nc">Upgrade</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Alternate</span><span class="w"> </span><span class="nc">Protocol</span><span class="w">  </span><span class="n">response</span><span class="w">  </span><span class="n">headers</span><span class="o">.</span><span class="w">   </span><span class="nc">This</span><span class="w">  </span><span class="n">mode</span><span class="w">
          </span><span class="n">currently</span><span class="w"> </span><span class="n">suppresses</span><span class="w"> </span><span class="nc">WebSockets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="w">

   </span><span class="n">ssl</span><span class="w">    </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">interception</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">decoding</span><span class="p">;</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">treated</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">opaque</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">modified</span><span class="o">.</span><span class="w">

   </span><span class="n">http</span><span class="w">   </span><span class="nc">Plain</span><span class="w">  </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">decoding</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">removal</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">HPKP</span><span class="p">,</span><span class="w"> </span><span class="nc">HSTS</span><span class="p">,</span><span class="w"> </span><span class="nc">Upgrade</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Alternate</span><span class="w"> </span><span class="nc">Protocol</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">head</span><span class="err">‐</span><span class="w">
          </span><span class="n">ers</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">suppresses</span><span class="w"> </span><span class="nc">WebSockets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="w">

   </span><span class="n">tcp</span><span class="w">    </span><span class="nc">Plain</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">decoding</span><span class="p">;</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">treated</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">opaque</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="n">bytes</span><span class="w">
          </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">modified</span><span class="o">.</span><span class="w">

   </span><span class="n">autossl</span><span class="w">
          </span><span class="nc">Plain</span><span class="w">  </span><span class="nc">TCP</span><span class="w">  </span><span class="n">connection</span><span class="w">  </span><span class="n">until</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="nc">Client</span><span class="w">  </span><span class="nc">Hello</span><span class="w">  </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w">  </span><span class="n">message</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">automatic</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">interception</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w">
          </span><span class="n">generic</span><span class="p">,</span><span class="w"> </span><span class="n">protocol</span><span class="o">-</span><span class="n">independent</span><span class="w"> </span><span class="nc">STARTTLS</span><span class="w"> </span><span class="n">support</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">erroneously</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">sequences</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="nc">Client</span><span class="w"> </span><span class="nc">Hello</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">though</span><span class="w">  </span><span class="n">there</span><span class="w">
          </span><span class="n">was</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="nc">STARTTLS</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">issued</span><span class="o">.</span><span class="w">

   </span><span class="n">listenaddr</span><span class="w"> </span><span class="n">port</span><span class="w">
          </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">listen</span><span class="w"> </span><span class="n">on</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">redirect</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">to</span><span class="o">.</span><span class="w">

   </span><span class="n">nat</span><span class="o">-</span><span class="n">engine</span><span class="w">
          </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">determining</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">transparently</span><span class="w"> </span><span class="n">redirected</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">de</span><span class="err">‐</span><span class="w">
          </span><span class="n">fault</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">overridden</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="n">sslsplit</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">rules</span><span class="w">  </span><span class="n">redirecting</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">traffic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sslsplit</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="nc">ENGINES</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engines</span><span class="o">.</span><span class="w">

   </span><span class="n">fwdaddr</span><span class="w"> </span><span class="n">port</span><span class="w">
          </span><span class="nc">Static</span><span class="w">  </span><span class="n">destination</span><span class="w">  </span><span class="n">address</span><span class="p">,</span><span class="w">  </span><span class="nc">IPv4</span><span class="w">  </span><span class="ow">or</span><span class="w"> </span><span class="nc">IPv6</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">forwarded</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">port</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">fwdaddr</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">resolved</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">

   </span><span class="n">sni</span><span class="w"> </span><span class="n">port</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Server</span><span class="w"> </span><span class="nc">Name</span><span class="w"> </span><span class="nc">Indication</span><span class="w"> </span><span class="p" data-group-id="9538057820-8">(</span><span class="nc">SNI</span><span class="p" data-group-id="9538057820-8">)</span><span class="w"> </span><span class="n">hostname</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Client</span><span class="w"> </span><span class="nc">Hello</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">nect</span><span class="w">  </span><span class="n">to</span><span class="o">.</span><span class="w">   </span><span class="nc">This</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">works</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">ssl</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">https</span><span class="w"> </span><span class="n">proxyspecs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="o">.</span><span class="w">  </span><span class="nc">Because</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">lookups</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w">
          </span><span class="n">preferable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">lookups</span><span class="w"> </span><span class="p" data-group-id="9538057820-9">(</span><span class="n">see</span><span class="w"> </span><span class="n">above</span><span class="p" data-group-id="9538057820-9">)</span><span class="p">,</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">possible</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">supported</span><span class="w">  </span><span class="nc">NAT</span><span class="w">  </span><span class="n">engine</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="ow">when</span><span class="w">  </span><span class="n">running</span><span class="w">
          </span><span class="n">sslsplit</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">different</span><span class="w">  </span><span class="n">system</span><span class="w">  </span><span class="n">than</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">redirecting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">sni</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prepare</span><span class="w">
          </span><span class="n">jaildir</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chroot</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span></code></pre><p>LOG SPECIFICATIONS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Log</span><span class="w"> </span><span class="n">specifications</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">composed</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">printf</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">directives</span><span class="p">;</span><span class="w"> </span><span class="n">ordinary</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">sup</span><span class="err">‐</span><span class="w">
   </span><span class="n">ports</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">directives</span><span class="p">:</span><span class="w">

   </span><span class="p">%</span><span class="nc">T</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">ISO</span><span class="w"> </span><span class="mi">8601</span><span class="w"> </span><span class="nc">UTC</span><span class="w"> </span><span class="n">timestamp</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="n">d</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="p">,</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">underscore</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">colon</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="nc">D</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">underscore</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">colon</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="n">p</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="n">s</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="p">,</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">underscore</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">colon</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="nc">S</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">underscore</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">colon</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="n">q</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">port</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="n">x</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">  </span><span class="nc">Requires</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unavailable</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="nc">X</span><span class="w">     </span><span class="nc">The</span><span class="w">  </span><span class="n">full</span><span class="w">  </span><span class="n">path</span><span class="w">  </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">  </span><span class="nc">Requires</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unavailable</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w">
          </span><span class="n">path</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="n">u</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">uid</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">  </span><span class="nc">Requires</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unavailable</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">from</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="n">g</span><span class="w">     </span><span class="nc">The</span><span class="w">  </span><span class="n">group</span><span class="w">  </span><span class="n">name</span><span class="w">  </span><span class="ow">or</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">gid</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">  </span><span class="nc">Requires</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unavailable</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">omitted</span><span class="w">
          </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w">

   </span><span class="p">%</span><span class="p">%</span><span class="w">     </span><span class="nc">A</span><span class="w"> </span><span class="n">literal</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="w"> </span><span class="n">character</span><span class="o">.</span></code></pre><p>NAT ENGINES</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="ss">engines</span><span class="p">:</span><span class="w">

   </span><span class="n">pf</span><span class="w">     </span><span class="nc">OpenBSD</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="6498738257-1">(</span><span class="n">pf</span><span class="p" data-group-id="6498738257-1">)</span><span class="w"> </span><span class="n">rdr</span><span class="o">/</span><span class="n">rdr</span><span class="o">-</span><span class="n">to</span><span class="w"> </span><span class="nc">NAT</span><span class="w"> </span><span class="n">redirects</span><span class="p">,</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">FreeBSD</span><span class="p">,</span><span class="w"> </span><span class="nc">NetBSD</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Mac</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="w">  </span><span class="nc">Fully</span><span class="w">  </span><span class="n">supported</span><span class="p">,</span><span class="w">  </span><span class="n">including</span><span class="w">  </span><span class="nc">IPv6</span><span class="o">.</span><span class="w">   </span><span class="nc">Note</span><span class="w">  </span><span class="n">that</span><span class="w">
          </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">needs</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">pf</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">reading</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">privileges</span><span class="o">.</span><span class="w">  </span><span class="nc">Assuming</span><span class="w"> </span><span class="n">inbound</span><span class="w"> </span><span class="n">interface</span><span class="w">
          </span><span class="n">em0</span><span class="p">,</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="p" data-group-id="6498738257-2">(</span><span class="nc">FreeBSD</span><span class="p">,</span><span class="w"> </span><span class="nc">Mac</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="p" data-group-id="6498738257-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="p" data-group-id="6498738257-3">(</span><span class="nc">OpenBSD</span><span class="w"> </span><span class="mf">4.7</span><span class="o">+</span><span class="p" data-group-id="6498738257-3">)</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

          </span><span class="n">rdr</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">port</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-&gt;</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">rdr</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-&gt;</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">
          </span><span class="n">rdr</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w">  </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">port</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">rdr</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w">  </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">

          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="n">rdr</span><span class="o">-</span><span class="n">to</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">rdr</span><span class="o">-</span><span class="n">to</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">
          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w">  </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="n">rdr</span><span class="o">-</span><span class="n">to</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w">  </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">rdr</span><span class="o">-</span><span class="n">to</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">

   </span><span class="n">ipfw</span><span class="w">   </span><span class="nc">FreeBSD</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="p" data-group-id="6498738257-4">(</span><span class="nc">IPFW</span><span class="p" data-group-id="6498738257-4">)</span><span class="w"> </span><span class="n">divert</span><span class="w"> </span><span class="n">sockets</span><span class="p">,</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Mac</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="w">  </span><span class="nc">Available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">FreeBSD</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">OpenBSD</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">pf</span><span class="w"> </span><span class="n">divert</span><span class="o">-</span><span class="n">to</span><span class="o">.</span><span class="w">  </span><span class="nc">Fully</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Free</span><span class="err">‐</span><span class="w">
          </span><span class="nc">BSD</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="nc">OpenBSD</span><span class="p">,</span><span class="w">  </span><span class="n">including</span><span class="w">  </span><span class="nc">IPv6</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Mac</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ancient</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">IPFW</span><span class="w"> </span><span class="n">included</span><span class="o">.</span><span class="w">  </span><span class="nc">First</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">IPFW</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pf</span><span class="w"> </span><span class="n">divert</span><span class="o">-</span><span class="n">to</span><span class="w">
          </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

          </span><span class="n">ipfw</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">fwd</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="p">,</span><span class="mi">10080</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w">  </span><span class="mi">80</span><span class="w">
          </span><span class="n">ipfw</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">fwd</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="p">,</span><span class="mi">10443</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="mi">443</span><span class="w">
          </span><span class="n">ipfw</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">fwd</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10080</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w">  </span><span class="mi">80</span><span class="w">
          </span><span class="n">ipfw</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">fwd</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10443</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="mi">443</span><span class="w">

          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="n">divert</span><span class="o">-</span><span class="n">to</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">divert</span><span class="o">-</span><span class="n">to</span><span class="w">       </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">
          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w">  </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="n">divert</span><span class="o">-</span><span class="n">to</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">pass</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quick</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">em0</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">from</span><span class="w">  </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="n">port</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">divert</span><span class="o">-</span><span class="n">to</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">

   </span><span class="n">ipfilter</span><span class="w">
          </span><span class="nc">IPFilter</span><span class="w"> </span><span class="p" data-group-id="6498738257-5">(</span><span class="n">ipfilter</span><span class="p">,</span><span class="w"> </span><span class="n">ipf</span><span class="p" data-group-id="6498738257-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">systems</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="nc">FreeBSD</span><span class="p">,</span><span class="w"> </span><span class="nc">NetBSD</span><span class="p">,</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Solaris</span><span class="o">.</span><span class="w">   </span><span class="nc">Note</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">needs</span><span class="w">  </span><span class="n">permission</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">open</span><span class="w">
          </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ipnat</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">reading</span><span class="p">,</span><span class="w">  </span><span class="n">which</span><span class="w">  </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">privileges</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">limitations</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SIOCGNATL</span><span class="w">
          </span><span class="n">ioctl</span><span class="p" data-group-id="6498738257-6">(</span><span class="mi">2</span><span class="p" data-group-id="6498738257-6">)</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">  </span><span class="nc">Assuming</span><span class="w"> </span><span class="n">inbound</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="ss">bge0</span><span class="p">:</span><span class="w">

          </span><span class="n">rdr</span><span class="w"> </span><span class="n">bge0</span><span class="w"> </span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="n">port</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">rdr</span><span class="w"> </span><span class="n">bge0</span><span class="w"> </span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">

   </span><span class="n">netfilter</span><span class="w">
          </span><span class="nc">Linux</span><span class="w"> </span><span class="n">netfilter</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">iptables</span><span class="w"> </span><span class="nc">REDIRECT</span><span class="w"> </span><span class="n">target</span><span class="o">.</span><span class="w">  </span><span class="nc">Fully</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">v3</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="n">rc1</span><span class="p">;</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">kernels</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">IPv4</span><span class="w">  </span><span class="n">due</span><span class="w">  </span><span class="n">to</span><span class="w">
          </span><span class="n">limitations</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SO_ORIGINAL_DST</span><span class="w"> </span><span class="n">getsockopt</span><span class="p" data-group-id="6498738257-7">(</span><span class="mi">2</span><span class="p" data-group-id="6498738257-7">)</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">

          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">--</span><span class="n">dport</span><span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">REDIRECT</span><span class="w"> </span><span class="o">--</span><span class="n">to</span><span class="o">-</span><span class="n">ports</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">--</span><span class="n">dport</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">REDIRECT</span><span class="w"> </span><span class="o">--</span><span class="n">to</span><span class="o">-</span><span class="n">ports</span><span class="w"> </span><span class="mi">10443</span><span class="w">
          </span><span class="c1"># please contribute a tested ip6tables config</span><span class="w">

          </span><span class="nc">Note</span><span class="w">  </span><span class="n">that</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">binds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correct</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p" data-group-id="6498738257-8">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="p" data-group-id="6498738257-8">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="p" data-group-id="6498738257-9">(</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p" data-group-id="6498738257-9">)</span><span class="o">.</span><span class="w">
          </span><span class="nc">REDIRECT</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">locally</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

   </span><span class="n">tproxy</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">netfilter</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">iptables</span><span class="w"> </span><span class="nc">TPROXY</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">local</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">originate</span><span class="w"> </span><span class="n">on</span><span class="w">  </span><span class="n">local</span><span class="w">  </span><span class="n">sockets</span><span class="o">.</span><span class="w">   </span><span class="nc">Fully</span><span class="w">
          </span><span class="n">supported</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="nc">IPv6</span><span class="o">.</span><span class="w">

          </span><span class="n">ip</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">inet6</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">fwmark</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="mi">100</span><span class="w">
          </span><span class="n">ip</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">inet6</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="n">lo</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="mi">100</span><span class="w">
          </span><span class="n">ip6tables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">N</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w">
          </span><span class="n">ip6tables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">MARK</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">mark</span><span class="w"> </span><span class="mi">1</span><span class="w">
          </span><span class="n">ip6tables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">ACCEPT</span><span class="w">
          </span><span class="n">ip6tables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w">
          </span><span class="n">ip6tables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="err">\</span><span class="w">
                    </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">--</span><span class="n">dport</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="err">\</span><span class="w">
                    </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">TPROXY</span><span class="w"> </span><span class="o">--</span><span class="n">tproxy</span><span class="o">-</span><span class="n">mark</span><span class="w"> </span><span class="mh">0x1</span><span class="o">/</span><span class="mh">0x1</span><span class="w"> </span><span class="o">--</span><span class="n">on</span><span class="o">-</span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">ip6tables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="o">::</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="err">\</span><span class="w">
                    </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">--</span><span class="n">dport</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="err">\</span><span class="w">
                    </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">TPROXY</span><span class="w"> </span><span class="o">--</span><span class="n">tproxy</span><span class="o">-</span><span class="n">mark</span><span class="w"> </span><span class="mh">0x1</span><span class="o">/</span><span class="mh">0x1</span><span class="w"> </span><span class="o">--</span><span class="n">on</span><span class="o">-</span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">
          </span><span class="n">ip</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">inet</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">fwmark</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="mi">100</span><span class="w">
          </span><span class="n">ip</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">inet</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="n">lo</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="mi">100</span><span class="w">
          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">N</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w">
          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">MARK</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">mark</span><span class="w"> </span><span class="mi">1</span><span class="w">
          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">ACCEPT</span><span class="w">
          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">DIVERT</span><span class="w">
          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">--</span><span class="n">dport</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">TPROXY</span><span class="w"> </span><span class="o">--</span><span class="n">tproxy</span><span class="o">-</span><span class="n">mark</span><span class="w"> </span><span class="mh">0x1</span><span class="o">/</span><span class="mh">0x1</span><span class="w"> </span><span class="o">--</span><span class="n">on</span><span class="o">-</span><span class="n">port</span><span class="w"> </span><span class="mi">10080</span><span class="w">
          </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">mangle</span><span class="w"> </span><span class="o">-</span><span class="nc">A</span><span class="w"> </span><span class="nc">PREROUTING</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="o">--</span><span class="n">dport</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="err">\</span><span class="w">
                   </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="nc">TPROXY</span><span class="w"> </span><span class="o">--</span><span class="n">tproxy</span><span class="o">-</span><span class="n">mark</span><span class="w"> </span><span class="mh">0x1</span><span class="o">/</span><span class="mh">0x1</span><span class="w"> </span><span class="o">--</span><span class="n">on</span><span class="o">-</span><span class="n">port</span><span class="w"> </span><span class="mi">10443</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">filtering</span><span class="w"> </span><span class="p" data-group-id="6498738257-10">(</span><span class="n">rp_filter</span><span class="p" data-group-id="6498738257-10">)</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="nc">TPROXY</span><span class="w"> </span><span class="n">redirected</span><span class="w"> </span><span class="n">traffic</span><span class="o">.</span></code></pre><p>SIGNALS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">A</span><span class="w">  </span><span class="n">running</span><span class="w">  </span><span class="n">sslsplit</span><span class="w"> </span><span class="n">accepts</span><span class="w"> </span><span class="nc">SIGINT</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">clean</span><span class="w"> </span><span class="n">shutdown</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">open</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="n">file</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="p" data-group-id="7008105157-1">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">L</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="nc">X</span><span class="p" data-group-id="7008105157-1">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">canonical</span><span class="w">
   </span><span class="n">way</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">rotate</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">process</span><span class="w"> </span><span class="n">logs</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PID</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PID</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">some</span><span class="w">  </span><span class="n">time</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">flush</span><span class="w">
   </span><span class="n">buffers</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">closing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">process</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">renamed</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">Per</span><span class="o">-</span><span class="n">connection</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="p" data-group-id="7008105157-2">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="nc">F</span><span class="p" data-group-id="7008105157-2">)</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">opened</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">their</span><span class="w">
   </span><span class="n">filename</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span></code></pre><p>EXIT STATUS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">sslsplit</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">shutdown</span><span class="w"> </span><span class="p" data-group-id="5315603111-1">(</span><span class="nc">SIGINT</span><span class="p">,</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="p" data-group-id="5315603111-1">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">controlled</span><span class="w"> </span><span class="n">shutdown</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w">  </span><span class="n">receiving</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">different</span><span class="w">
   </span><span class="n">signal</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">  </span><span class="nc">Exit</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="o">.</span><span class="mi">127</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">conditions</span><span class="o">.</span></code></pre><p>EXAMPLES</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Matching</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">above</span><span class="w">  </span><span class="nc">NAT</span><span class="w">  </span><span class="n">engine</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HTTPS</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">forged</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="ow">and</span><span class="w">
   </span><span class="n">certificate</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="p">,</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="w"> </span><span class="p" data-group-id="3427702527-1">(</span><span class="n">add</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">nat</span><span class="o">-</span><span class="n">engine</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="n">engine</span><span class="w">
   </span><span class="k">if</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">engines</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">system</span><span class="p" data-group-id="3427702527-1">)</span><span class="p">:</span><span class="w">

   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">https</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10443</span><span class="w">  </span><span class="n">https</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10443</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">http</span><span class="w">  </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10080</span><span class="w">  </span><span class="n">http</span><span class="w">  </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10080</span><span class="w">

   </span><span class="nc">If</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">Linux</span><span class="w"> </span><span class="n">netfilter</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">iptables</span><span class="w"> </span><span class="nc">REDIRECT</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">listen</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correct</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p" data-group-id="3427702527-2">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="p" data-group-id="3427702527-2">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
   </span><span class="n">terfaces</span><span class="w"> </span><span class="p" data-group-id="3427702527-3">(</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p" data-group-id="3427702527-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w">

   </span><span class="nc">Intercepting</span><span class="w"> </span><span class="nc">IMAP</span><span class="o">/</span><span class="nc">IMAPS</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="ss">settings</span><span class="p">:</span><span class="w">

   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">ssl</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10993</span><span class="w">  </span><span class="n">ssl</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10993</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">tcp</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10143</span><span class="w">  </span><span class="n">tcp</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10143</span><span class="w">

   </span><span class="nc">A</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">targeted</span><span class="w"> </span><span class="n">setup</span><span class="p">,</span><span class="w"> </span><span class="nc">HTTPS</span><span class="w"> </span><span class="n">only</span><span class="p">,</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">certificate</span><span class="o">/</span><span class="n">chain</span><span class="o">/</span><span class="n">key</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">cert</span><span class="o">.</span><span class="n">d</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">statically</span><span class="w"> </span><span class="n">redirecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">org</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">querying</span><span class="w"> </span><span class="n">a</span><span class="w">
   </span><span class="nc">NAT</span><span class="w"> </span><span class="ss">engine</span><span class="p">:</span><span class="w">

   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">cert</span><span class="o">.</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">https</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w">       </span><span class="mi">10443</span><span class="w"> </span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">org</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">https</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10443</span><span class="w"> </span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">org</span><span class="w"> </span><span class="mi">443</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">plain</span><span class="w"> </span><span class="n">ssl</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">proxyspecs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">modifications</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="nc">PCAP</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">processing</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ex</span><span class="err">‐</span><span class="w">
   </span><span class="n">ternal</span><span class="w"> </span><span class="n">tool</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">facilitate</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">rotation</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">rotation</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PID</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PID</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="o">-</span><span class="nc">X</span><span class="w"> </span><span class="n">log</span><span class="o">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">sslsplit</span><span class="o">.</span><span class="n">pid</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">ssl</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10443</span><span class="w">  </span><span class="n">ssl</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10443</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">tcp</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10080</span><span class="w">  </span><span class="n">tcp</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10080</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">optimized</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">disabling</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">selecting</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">precomputed</span><span class="w">
   </span><span class="n">private</span><span class="w">  </span><span class="n">key</span><span class="w">  </span><span class="n">leaf</span><span class="o">.</span><span class="n">key</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">forged</span><span class="w"> </span><span class="n">certificates</span><span class="o">.</span><span class="w">  </span><span class="nc">Most</span><span class="w"> </span><span class="n">significant</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="n">increase</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">gained</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">choosing</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="n">algorithms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">keysizes</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="ow">and</span><span class="w">
   </span><span class="n">leaf</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">keys</span><span class="o">.</span><span class="w">  </span><span class="nc">Check</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">algorithms</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">key</span><span class="w">  </span><span class="n">sizes</span><span class="o">.</span><span class="w">   </span><span class="nc">Also</span><span class="p">,</span><span class="w">
   </span><span class="n">some</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">warn</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="n">weak</span><span class="o">.</span><span class="w">

   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="nc">Z</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="nc">NULL</span><span class="ss">:RC4</span><span class="ss">:AES128</span><span class="ss">:-</span><span class="nc">DHE</span><span class="w"> </span><span class="o">-</span><span class="nc">K</span><span class="w"> </span><span class="n">leaf</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">https</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10443</span><span class="w">  </span><span class="n">https</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10443</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">http</span><span class="w">  </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10080</span><span class="w">  </span><span class="n">http</span><span class="w">  </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10080</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">daemon</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">sslsplit</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">writing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">PID</span><span class="w"> </span><span class="ss">file</span><span class="p">:</span><span class="w">

   </span><span class="n">sslsplit</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">sslsplit</span><span class="o">.</span><span class="n">pid</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">sslsplit</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">https</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10443</span><span class="w">  </span><span class="n">https</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10443</span><span class="w"> </span><span class="err">\</span><span class="w">
            </span><span class="n">http</span><span class="w">  </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="mi">10080</span><span class="w">  </span><span class="n">http</span><span class="w">  </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10080</span><span class="w">

   </span><span class="nc">To</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w">  </span><span class="ow">and</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="ss">OpenSSL</span><span class="p">:</span><span class="w">

   </span><span class="n">cat</span><span class="w"> </span><span class="o">&gt;</span><span class="n">x509v3ca</span><span class="o">.</span><span class="n">cnf</span><span class="w"> </span><span class="p" data-group-id="3427702527-4">&lt;&lt;</span><span class="sc">&#39;EOF&#39;</span><span class="w">
   </span><span class="p" data-group-id="3427702527-5">[</span><span class="w"> </span><span class="n">req</span><span class="w"> </span><span class="p" data-group-id="3427702527-5">]</span><span class="w">
   </span><span class="n">distinguished_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reqdn</span><span class="w">

   </span><span class="p" data-group-id="3427702527-6">[</span><span class="w"> </span><span class="n">reqdn</span><span class="w"> </span><span class="p" data-group-id="3427702527-6">]</span><span class="w">

   </span><span class="p" data-group-id="3427702527-7">[</span><span class="w"> </span><span class="n">v3_ca</span><span class="w"> </span><span class="p" data-group-id="3427702527-7">]</span><span class="w">
   </span><span class="n">basicConstraints</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nc">CA</span><span class="ss">:TRUE</span><span class="w">
   </span><span class="n">subjectKeyIdentifier</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">hash</span><span class="w">
   </span><span class="n">authorityKeyIdentifier</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">keyid</span><span class="ss">:always</span><span class="p">,</span><span class="n">issuer</span><span class="ss">:always</span><span class="w">
   </span><span class="nc">EOF</span><span class="w">

   </span><span class="n">openssl</span><span class="w"> </span><span class="n">genrsa</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="mi">2048</span><span class="w">
   </span><span class="n">openssl</span><span class="w"> </span><span class="n">req</span><span class="w"> </span><span class="o">-</span><span class="n">new</span><span class="w"> </span><span class="o">-</span><span class="n">nodes</span><span class="w"> </span><span class="o">-</span><span class="n">x509</span><span class="w"> </span><span class="o">-</span><span class="n">sha256</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="o">-</span><span class="n">key</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="err">\</span><span class="w">
           </span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="n">x509v3ca</span><span class="o">.</span><span class="n">cnf</span><span class="w"> </span><span class="o">-</span><span class="n">extensions</span><span class="w"> </span><span class="n">v3_ca</span><span class="w"> </span><span class="err">\</span><span class="w">
           </span><span class="o">-</span><span class="n">subj</span><span class="w"> </span><span class="sc">&#39;/O=SSLsplit Root CA/CN=SSLsplit Root CA/&#39;</span><span class="w"> </span><span class="err">\</span><span class="w">
           </span><span class="o">-</span><span class="n">set_serial</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="n">days</span><span class="w"> </span><span class="mi">3650</span></code></pre><p>NOTES</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">SSLsplit</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">relatively</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">listeners</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">multithreaded</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">architecture</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">libevent</span><span class="p">,</span><span class="w"> </span><span class="n">taking</span><span class="w">
   </span><span class="n">advantage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">select</span><span class="p" data-group-id="4387267078-1">(</span><span class="p" data-group-id="4387267078-1">)</span><span class="w"> </span><span class="n">replacements</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">kqueue</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">thread</span><span class="w"> </span><span class="n">handles</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">listeners</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">signaling</span><span class="p">,</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="n">worker</span><span class="w">  </span><span class="n">threads</span><span class="w">
   </span><span class="n">equal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">twice</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">cores</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CPU</span><span class="o">-</span><span class="n">intensive</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">handling</span><span class="o">.</span><span class="w">

   </span><span class="nc">Care</span><span class="w">  </span><span class="n">has</span><span class="w">  </span><span class="n">been</span><span class="w">  </span><span class="n">taken</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">choose</span><span class="w"> </span><span class="n">well</span><span class="o">-</span><span class="n">performing</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">structures</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">caching</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="n">sessions</span><span class="o">.</span><span class="w">  </span><span class="nc">Logging</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">writer</span><span class="w">
   </span><span class="n">threads</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="n">threads</span><span class="w"> </span><span class="n">don</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="o">.</span><span class="w">  </span><span class="nc">DNS</span><span class="w"> </span><span class="n">lookups</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="n">asynchronously</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">uses</span><span class="w">  </span><span class="nc">SSL</span><span class="w">  </span><span class="n">session</span><span class="w">
   </span><span class="n">caching</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">ends</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">minimize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="n">handshakes</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">then</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">limiting</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="nc">SSL</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">bignum</span><span class="w"> </span><span class="n">com</span><span class="err">‐</span><span class="w">
   </span><span class="n">putations</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="n">latency</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">separation</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">priv</span><span class="err">‐</span><span class="w">
   </span><span class="n">ileged</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">separation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">connection</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="ss">types</span><span class="p">:</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">stream</span><span class="w">
   </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">filespec</span><span class="w"> </span><span class="p" data-group-id="4387267078-2">(</span><span class="o">-</span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nc">S</span><span class="p" data-group-id="4387267078-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">stream</span><span class="w"> </span><span class="nc">PCAP</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">filespec</span><span class="w"> </span><span class="p" data-group-id="4387267078-3">(</span><span class="o">-</span><span class="nc">Y</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="p" data-group-id="4387267078-3">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">files</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">directory</span><span class="w">  </span><span class="p" data-group-id="4387267078-4">(</span><span class="o">-</span><span class="n">w</span><span class="p">,</span><span class="w">
   </span><span class="o">-</span><span class="nc">W</span><span class="p" data-group-id="4387267078-4">)</span><span class="o">.</span><span class="w">   </span><span class="nc">Instead</span><span class="p">,</span><span class="w">  </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="n">file</span><span class="w"> </span><span class="n">variants</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">available</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="p">,</span><span class="w"> </span><span class="n">albeit</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">recommended</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">separation</span><span class="w">
   </span><span class="ow">when</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">thereby</span><span class="w"> </span><span class="n">bypassing</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">separation</span><span class="w"> </span><span class="n">entirely</span><span class="o">.</span></code></pre><p>SEE ALSO</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="n">sslsplit</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="4933529236-1">(</span><span class="mi">5</span><span class="p" data-group-id="4933529236-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">openssl</span><span class="p" data-group-id="4933529236-2">(</span><span class="mi">1</span><span class="p" data-group-id="4933529236-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">ciphers</span><span class="p" data-group-id="4933529236-3">(</span><span class="mi">1</span><span class="p" data-group-id="4933529236-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">speed</span><span class="p" data-group-id="4933529236-4">(</span><span class="mi">1</span><span class="p" data-group-id="4933529236-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p" data-group-id="4933529236-5">(</span><span class="mi">4</span><span class="p" data-group-id="4933529236-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">ipfw</span><span class="p" data-group-id="4933529236-6">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">iptables</span><span class="p" data-group-id="4933529236-7">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-7">)</span><span class="p">,</span><span class="w"> </span><span class="n">ip6tables</span><span class="p" data-group-id="4933529236-8">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-8">)</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="p" data-group-id="4933529236-9">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-9">)</span><span class="p">,</span><span class="w">  </span><span class="n">hostapd</span><span class="p" data-group-id="4933529236-10">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-10">)</span><span class="p">,</span><span class="w">  </span><span class="n">arpspoof</span><span class="p" data-group-id="4933529236-11">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-11">)</span><span class="p">,</span><span class="w">  </span><span class="n">parasite6</span><span class="p" data-group-id="4933529236-12">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-12">)</span><span class="p">,</span><span class="w">  </span><span class="n">yersinia</span><span class="p" data-group-id="4933529236-13">(</span><span class="mi">8</span><span class="p" data-group-id="4933529236-13">)</span><span class="p">,</span><span class="w">
   </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">roe</span><span class="o">.</span><span class="n">ch</span><span class="o">/</span><span class="nc">SSLsplit</span></code></pre><p>AUTHORS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Daniel</span><span class="w"> </span><span class="nc">Roethlisberger</span><span class="w"> </span><span class="o">&lt;</span><span class="n">daniel</span><span class="na">@roe</span><span class="o">.</span><span class="n">ch</span><span class="o">&gt;</span><span class="o">.</span><span class="w">  </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">maintained</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Daniel</span><span class="w"> </span><span class="nc">Roethlisberger</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Soner</span><span class="w"> </span><span class="nc">Tari</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w">  </span><span class="n">following</span><span class="w">  </span><span class="n">individuals</span><span class="w">  </span><span class="n">have</span><span class="w">  </span><span class="n">contributed</span><span class="w">  </span><span class="n">code</span><span class="w">  </span><span class="ow">or</span><span class="w"> </span><span class="n">documentation</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">chronological</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="ss">contribution</span><span class="p">:</span><span class="w"> </span><span class="nc">Steve</span><span class="w"> </span><span class="nc">Wills</span><span class="p">,</span><span class="w"> </span><span class="nc">Landon</span><span class="w"> </span><span class="nc">Fuller</span><span class="p">,</span><span class="w"> </span><span class="nc">Wayne</span><span class="w">
   </span><span class="nc">Jensen</span><span class="p">,</span><span class="w"> </span><span class="nc">Rory</span><span class="w"> </span><span class="nc">McNamara</span><span class="p">,</span><span class="w"> </span><span class="nc">Alexander</span><span class="w"> </span><span class="nc">Neumann</span><span class="p">,</span><span class="w"> </span><span class="nc">Adam</span><span class="w"> </span><span class="nc">Jacob</span><span class="w"> </span><span class="nc">Muller</span><span class="p">,</span><span class="w"> </span><span class="nc">Richard</span><span class="w"> </span><span class="nc">Poole</span><span class="p">,</span><span class="w"> </span><span class="nc">Maciej</span><span class="w"> </span><span class="nc">Kotowicz</span><span class="p">,</span><span class="w"> </span><span class="nc">Eun</span><span class="w"> </span><span class="nc">Soo</span><span class="w"> </span><span class="nc">Park</span><span class="p">,</span><span class="w"> </span><span class="nc">Christian</span><span class="w"> </span><span class="nc">Groschupp</span><span class="p">,</span><span class="w"> </span><span class="nc">Alexander</span><span class="w">  </span><span class="nc">Savchenkov</span><span class="p">,</span><span class="w">  </span><span class="nc">Soner</span><span class="w">
   </span><span class="nc">Tari</span><span class="p">,</span><span class="w"> </span><span class="nc">Petr</span><span class="w"> </span><span class="nc">Vanek</span><span class="p">,</span><span class="w"> </span><span class="nc">Hilko</span><span class="w"> </span><span class="nc">Bengen</span><span class="p">,</span><span class="w"> </span><span class="nc">Philip</span><span class="w"> </span><span class="nc">Duldig</span><span class="p">,</span><span class="w"> </span><span class="nc">Levente</span><span class="w"> </span><span class="nc">Polyak</span><span class="p">,</span><span class="w"> </span><span class="nc">Nick</span><span class="w"> </span><span class="nc">French</span><span class="p">,</span><span class="w"> </span><span class="nc">Cihan</span><span class="w"> </span><span class="nc">Komecoglu</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Sergey</span><span class="w"> </span><span class="nc">Pinaev</span><span class="o">.</span><span class="w">

   </span><span class="nc">SSLsplit</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">sponsored</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">HackerOne</span><span class="o">.</span></code></pre><p>BUGS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Use</span><span class="w"> </span><span class="nc">Github</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">submission</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bug</span><span class="w"> </span><span class="n">reports</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ss">patches</span><span class="p">:</span><span class="w">

          </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">droe</span><span class="o">/</span><span class="n">sslsplit</span></code></pre><p>sslsplit 0.5.5                                                               2019-11-13                                                                  sslsplit(1)</p>      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.23.0) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>
