<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="Manpages v3.0.0">


    <title>btrfs-device — Manpages v3.0.0</title>

    <link rel="stylesheet" href="dist/html-elixir-KV3YOVJ3.css" />

    <script defer src="dist/sidebar_items-C9959D41.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>
<link rel="stylesheet" href="assets/doc.css">
  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Manpages" />
        </a>

      <div>
        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectName" translate="no">
Manpages
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v3.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras="MANUALS"></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Manpages</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>btrfs-device</h1>


  </div>


<p>BTRFS-DEVICE(8)                                                                              BTRFS                                                                             BTRFS-DEVICE(8)</p><p>NAME</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="o">-</span><span class="n">device</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">manage</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystems</span></code></pre><p>SYNOPSIS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">&lt;</span><span class="n">subcommand</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span></code></pre><p>DESCRIPTION</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">manage</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystems</span><span class="o">.</span></code></pre><p>DEVICE MANAGEMENT</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">BTRFS</span><span class="w">  </span><span class="n">filesystem</span><span class="w">  </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">devices</span><span class="o">.</span><span class="w">  </span><span class="nc">Devices</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">added</span><span class="p">,</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">demand</span><span class="o">.</span><span class="w">  </span><span class="nc">Data</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">organized</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">allocation</span><span class="w">
   </span><span class="n">profiles</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">various</span><span class="w"> </span><span class="n">redundancy</span><span class="w"> </span><span class="n">policies</span><span class="o">.</span><span class="w">  </span><span class="nc">There</span><span class="sc">&#39;s some similarity with traditional RAID levels, but this could be confusing to users familiar with the traditional  meaning.  Due  to
   the similarity, the RAID terminology is widely used in the documentation.  See mkfs.btrfs(8) for more details and the exact profile capabilities and constraints.

   The device management works on a mounted filesystem. Devices can be added, removed or replaced, by commands provided by btrfs device and btrfs replace.

   The profiles can be also changed, provided there&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">enough</span><span class="w"> </span><span class="n">workspace</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7198964011-1">do</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversion</span><span class="p">,</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">namely</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">convert</span><span class="o">.</span><span class="w">

   </span><span class="nc">Type</span><span class="w">   </span><span class="nc">The</span><span class="w">  </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">distinction</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">User</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="nc">Data</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">structures</span><span class="w"> </span><span class="n">managed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">filesys</span><span class="err">‐</span><span class="w">
          </span><span class="n">tem</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="nc">Metadata</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">System</span><span class="o">.</span><span class="w">

   </span><span class="nc">Profile</span><span class="w">
          </span><span class="nc">A</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">allocation</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">redundancy</span><span class="o">/</span><span class="n">replication</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">devices</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">profile</span><span class="w">  </span><span class="n">applies</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">data</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">metadata</span><span class="w">
          </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">separately</span><span class="o">.</span><span class="w"> </span><span class="nc">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">single</span><span class="p">,</span><span class="w"> </span><span class="nc">RAID1</span><span class="o">.</span><span class="w">

   </span><span class="nc">RAID</span><span class="w"> </span><span class="n">level</span><span class="w">
          </span><span class="nc">Where</span><span class="w">  </span><span class="n">applicable</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">level</span><span class="w">  </span><span class="n">refers</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="nc">RAID</span><span class="w"> </span><span class="n">levels</span><span class="o">.</span><span class="w"> </span><span class="nc">At</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">ones</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w"> </span><span class="nc">RAID0</span><span class="p">,</span><span class="w"> </span><span class="nc">RAID1</span><span class="p">,</span><span class="w"> </span><span class="nc">RAID10</span><span class="p">,</span><span class="w"> </span><span class="nc">RAID5</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="nc">RAID6</span><span class="o">.</span></code></pre><p>TYPICAL USE CASES
   Starting with a single-device filesystem</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Assume</span><span class="w"> </span><span class="n">we</span><span class="sc">&#39;ve created a filesystem on a block device /dev/sda with profile single/single (data/metadata), the device size is 50GiB and we&#39;</span><span class="n">ve</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">for</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">filesystem</span><span class="o">.</span><span class="w">
   </span><span class="nc">The</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">16</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">allocated</span><span class="w"> </span><span class="mi">2</span><span class="nc">GiB</span><span class="o">.</span></code></pre><p>   Add new device</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">We</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">increase</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">100</span><span class="nc">GiB</span><span class="o">.</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">increases</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">100</span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allocated</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">metadata</span><span class="o">.</span></code></pre><p>   Convert to RAID1</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Now</span><span class="w">  </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">increase</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">redundancy</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">we</span><span class="sc">&#39;ll do that in steps. Note, that the device sizes are not equal and we&#39;</span><span class="n">ll</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">capabili</span><span class="err">‐</span><span class="w">
   </span><span class="n">ties</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">data</span><span class="o">/</span><span class="n">metadata</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">independent</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">constraint</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">RAID1</span><span class="w"> </span><span class="n">gives</span><span class="w"> </span><span class="n">us</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="mi">50</span><span class="nc">GiB</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">usable</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">copies</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">devices</span><span class="o">.</span><span class="w">

   </span><span class="nc">First</span><span class="w"> </span><span class="n">we</span><span class="sc">&#39;ll convert the metadata. As the metadata occupy less than 50GiB and there&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">enough</span><span class="w"> </span><span class="n">workspace</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversion</span><span class="w"> </span><span class="n">process</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">-</span><span class="n">mconvert</span><span class="o">=</span><span class="n">raid1</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">while</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">moved</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">pointers</span><span class="w"> </span><span class="n">updated</span><span class="o">.</span><span class="w"> </span><span class="nc">Depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">disk</span><span class="w">  </span><span class="n">seeking</span><span class="w">
   </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="n">affecting</span><span class="w"> </span><span class="n">performance</span><span class="o">.</span><span class="w">

   </span><span class="nc">You</span><span class="sc">&#39;ll note that the system block group has been also converted to RAID1, this normally happens as the system block group also holds metadata (the physical to logical mappings).

   What changed:

   • available data space decreased by 3GiB, usable roughly (50 - 3) + (100 - 3) = 144 GiB

   • metadata redundancy increased

   In  other  words,  the unequal device sizes allow for combined space for data yet improved redundancy for metadata. If we decide to increase redundancy of data as well, we&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">to</span><span class="w">
   </span><span class="n">lose</span><span class="w"> </span><span class="mi">50</span><span class="nc">GiB</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">obvious</span><span class="w"> </span><span class="n">reasons</span><span class="o">.</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">-</span><span class="n">dconvert</span><span class="o">=</span><span class="n">raid1</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">workspace</span><span class="w"> </span><span class="p" data-group-id="3865663267-1">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="p" data-group-id="3865663267-1">)</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">or</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">block</span><span class="w">  </span><span class="n">groups</span><span class="w">
   </span><span class="n">occupy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">remains</span><span class="w"> </span><span class="n">unchanged</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logical</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">50</span><span class="o">-</span><span class="mi">100</span><span class="nc">GiB</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">unused</span><span class="o">.</span></code></pre><p>   Remove device</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Device</span><span class="w"> </span><span class="n">removal</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">satisfy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">constraints</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">fails</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="ss">example</span><span class="p">:</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">
      </span><span class="ss">ERROR</span><span class="p">:</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">removing</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="ss">&#39;/dev/sda&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">raid1</span><span class="w">

   </span><span class="nc">In</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ss">case</span><span class="p">:</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">-</span><span class="n">mconvert</span><span class="o">=</span><span class="n">dup</span><span class="w"> </span><span class="o">-</span><span class="n">dconvert</span><span class="o">=</span><span class="n">single</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">
      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

   </span><span class="ss">WARNING</span><span class="p">:</span><span class="w">
      </span><span class="nc">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">redundancy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">redundancy</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">failing</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">filesystem</span><span class="o">.</span><span class="w">

      </span><span class="nc">Balance</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">metadata</span><span class="o">/</span><span class="n">data</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">chunk</span><span class="o">.</span><span class="w">  </span><span class="nc">Thus</span><span class="w"> </span><span class="n">it</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failing</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">

      </span><span class="nc">Use</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span></code></pre><p>SUBCOMMAND</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">add</span><span class="w"> </span><span class="p" data-group-id="7064430154-1">[</span><span class="o">-</span><span class="nc">Kf</span><span class="p" data-group-id="7064430154-1">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="7064430154-2">[</span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="n">...</span><span class="p" data-group-id="7064430154-2">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Add</span><span class="w"> </span><span class="n">device</span><span class="p" data-group-id="7064430154-3">(</span><span class="n">s</span><span class="p" data-group-id="7064430154-3">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">identified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">applicable</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">discard</span><span class="w"> </span><span class="p" data-group-id="7064430154-4">(</span><span class="nc">TRIM</span><span class="p" data-group-id="7064430154-4">)</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">detected</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">blkid</span><span class="p" data-group-id="7064430154-5">(</span><span class="mi">8</span><span class="p" data-group-id="7064430154-5">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">addi</span><span class="err">‐</span><span class="w">
          </span><span class="n">tion</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">forced</span><span class="o">.</span><span class="w"> </span><span class="nc">Alternatively</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">wiped</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">wipefs</span><span class="p" data-group-id="7064430154-6">(</span><span class="mi">8</span><span class="p" data-group-id="7064430154-6">)</span><span class="w"> </span><span class="n">tool</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">instant</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">merely</span><span class="w"> </span><span class="n">adds</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">structures</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">creates</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">headers</span><span class="o">.</span><span class="w">

          </span><span class="nc">Options</span><span class="w">

          </span><span class="o">-</span><span class="nc">K</span><span class="o">|</span><span class="o">--</span><span class="n">nodiscard</span><span class="w">
                 </span><span class="k" data-group-id="7064430154-7">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">discard</span><span class="w"> </span><span class="p" data-group-id="7064430154-8">(</span><span class="nc">TRIM</span><span class="p" data-group-id="7064430154-8">)</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w">

          </span><span class="o">-</span><span class="n">f</span><span class="o">|</span><span class="o">--</span><span class="n">force</span><span class="w">
                 </span><span class="n">force</span><span class="w"> </span><span class="n">overwrite</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">disk</span><span class="p" data-group-id="7064430154-9">(</span><span class="n">s</span><span class="p" data-group-id="7064430154-9">)</span><span class="w">

          </span><span class="o">--</span><span class="n">enqueue</span><span class="w">
                 </span><span class="n">wait</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="sc">&#39;s another exclusive operation running, otherwise continue

   remove [options] &lt;device&gt;|&lt;devid&gt; [&lt;device&gt;|&lt;devid&gt;...] &lt;path&gt;
          Remove device(s) from a filesystem identified by &lt;path&gt;

          Device removal must satisfy the profile constraints, otherwise the command fails and cannot be enforced. The filesystem must be converted to profile(s) that would allow the re‐
          moval. This can for example happen when going down from 2 devices to 1 and using the RAID1 profile. See the section Typical use cases.

          The operation can take long as it needs to move all data from the device.

          NOTE:
             It&#39;</span><span class="n">s</span><span class="w">  </span><span class="n">possible</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">specify</span><span class="w">  </span><span class="n">more</span><span class="w">  </span><span class="n">than</span><span class="w">  </span><span class="n">one</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">once</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w">
             </span><span class="n">deleted</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">writes</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">there</span><span class="sc">&#39;s a warning and safety timeout as this can be confusing and unexpected. The timeout  can  be  overridden  by  option
             --force.

          It  is possible to delete the device that was used to mount the filesystem. The device entry in the mount table (/proc/self/mounts) will be replaced by another device name with
          the lowest device id.

          If the filesystem is mounted in degraded mode (-o degraded), special term missing can be used for device. In that case, the first device that is  described  by  the  filesystem
          metadata, but not present at the mount time will be removed.

          NOTE:
             In  most cases, there is only one missing device in degraded mode, otherwise mount fails. If there are two or more devices missing (e.g. possible in RAID6), you need specify
             missing as many times as the number of missing devices to remove all of them.

          Options

          --enqueue
                 wait if there&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">exclusive</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">continue</span><span class="w">

          </span><span class="o">--</span><span class="n">force</span><span class="w">
                 </span><span class="n">skip</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">safety</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">removal</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="n">removing</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">break</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">constraints</span><span class="w">

   </span><span class="n">delete</span><span class="w"> </span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="o">|</span><span class="o">&lt;</span><span class="n">devid</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="7064430154-10">[</span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="o">|</span><span class="o">&lt;</span><span class="n">devid</span><span class="o">&gt;</span><span class="n">...</span><span class="p" data-group-id="7064430154-10">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Alias</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">kept</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">backward</span><span class="w"> </span><span class="n">compatibility</span><span class="w">

   </span><span class="n">replace</span><span class="w"> </span><span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="7064430154-11">[</span><span class="n">options</span><span class="p" data-group-id="7064430154-11">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Alias</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">convenience</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">btrfs</span><span class="o">-</span><span class="n">replace</span><span class="p" data-group-id="7064430154-12">(</span><span class="mi">8</span><span class="p" data-group-id="7064430154-12">)</span><span class="o">.</span><span class="w">

   </span><span class="n">ready</span><span class="w"> </span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Wait</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">multiple</span><span class="o">-</span><span class="n">device</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">scanned</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">module</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">automatic</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="n">tools</span><span class="w">  </span><span class="n">to</span><span class="w">
          </span><span class="n">wait</span><span class="w">  </span><span class="n">before</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">preconditions</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">reasons</span><span class="o">.</span><span class="w">  </span><span class="nc">Normal</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">usually</span><span class="w"> </span><span class="k" data-group-id="7064430154-13">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">may</span><span class="w"> </span><span class="n">safely</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w">

   </span><span class="n">scan</span><span class="w"> </span><span class="p" data-group-id="7064430154-14">[</span><span class="n">options</span><span class="p" data-group-id="7064430154-14">]</span><span class="w"> </span><span class="p" data-group-id="7064430154-15">[</span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="7064430154-16">[</span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="n">...</span><span class="p" data-group-id="7064430154-16">]</span><span class="p" data-group-id="7064430154-15">]</span><span class="w">
          </span><span class="nc">Scan</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">register</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">module</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="n">multiple</span><span class="o">-</span><span class="n">device</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">group</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">passed</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">blkid</span><span class="w"> </span><span class="n">reports</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">scanned</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">--</span><span class="n">all</span><span class="o">-</span><span class="n">devices</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">blkid</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">available</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">passed</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">repeatedly</span><span class="o">.</span><span class="w"> </span><span class="nc">Devices</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">such</span><span class="o">.</span><span class="w"> </span><span class="nc">Reloading</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">information</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="sc">&#39;s an alternative  way
          of mounting multiple-device filesystem without the need for prior scanning. See the mount option device (in btrfs-man5).

          Options

          -d|--all-devices
                 Enumerate and register all devices, use as a fallback in case blkid is not available.

          -u|--forget
                 Unregister a given device or all stale devices if no path is given, the device must be unmounted otherwise it&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">

   </span><span class="n">stats</span><span class="w"> </span><span class="p" data-group-id="7064430154-17">[</span><span class="n">options</span><span class="p" data-group-id="7064430154-17">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="o">|</span><span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span><span class="w">
          </span><span class="nc">Read</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">print</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="nc">IO</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">statistics</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">identified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">mounted</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="n">section</span><span class="w">
          </span><span class="nc">DEVICE</span><span class="w"> </span><span class="nc">STATS</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reported</span><span class="w"> </span><span class="n">statistics</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">meaning</span><span class="o">.</span><span class="w">

          </span><span class="nc">Options</span><span class="w">

          </span><span class="o">-</span><span class="n">z</span><span class="o">|</span><span class="o">--</span><span class="n">reset</span><span class="w">
                 </span><span class="nc">Print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">afterwards</span><span class="o">.</span><span class="w">

          </span><span class="o">-</span><span class="n">c</span><span class="o">|</span><span class="o">--</span><span class="n">check</span><span class="w">
                 </span><span class="nc">Check</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">zeros</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">so</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">statistics</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="o">-</span><span class="n">zero</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="n">from</span><span class="w">
                 </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">it</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="mi">64</span><span class="o">.</span><span class="w">

          </span><span class="o">-</span><span class="nc">T</span><span class="w">     </span><span class="nc">Print</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tabular</span><span class="w"> </span><span class="n">form</span><span class="p">,</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">rows</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">columns</span><span class="w">

   </span><span class="n">usage</span><span class="w"> </span><span class="p" data-group-id="7064430154-18">[</span><span class="n">options</span><span class="p" data-group-id="7064430154-18">]</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="7064430154-19">[</span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="n">...</span><span class="p" data-group-id="7064430154-19">]</span><span class="o">::</span><span class="w">
          </span><span class="nc">Show</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">allocations</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">devices</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">detail</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">differ</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p" data-group-id="7064430154-20">(</span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">restricted</span><span class="w"> </span><span class="n">ioctls</span><span class="p" data-group-id="7064430154-20">)</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p" data-group-id="7064430154-21">(</span><span class="n">warning</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
          </span><span class="n">cluded</span><span class="p" data-group-id="7064430154-21">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="ss">filesystem</span><span class="p">:</span><span class="w">

             </span><span class="ss">WARNING</span><span class="p">:</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">device</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shown</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">root</span><span class="w">
             </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdc1</span><span class="p">,</span><span class="w"> </span><span class="ss">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
                </span><span class="nc">Device</span><span class="w"> </span><span class="ss">size</span><span class="p">:</span><span class="w">           </span><span class="mf">931.51</span><span class="nc">GiB</span><span class="w">
                </span><span class="nc">Device</span><span class="w"> </span><span class="ss">slack</span><span class="p">:</span><span class="w">              </span><span class="mf">0.00</span><span class="nc">B</span><span class="w">
                </span><span class="ss">Unallocated</span><span class="p">:</span><span class="w">           </span><span class="mf">931.51</span><span class="nc">GiB</span><span class="w">

             </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdc1</span><span class="p">,</span><span class="w"> </span><span class="ss">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
                </span><span class="nc">Device</span><span class="w"> </span><span class="ss">size</span><span class="p">:</span><span class="w">           </span><span class="mf">931.51</span><span class="nc">GiB</span><span class="w">
                </span><span class="nc">Device</span><span class="w"> </span><span class="ss">slack</span><span class="p">:</span><span class="w">              </span><span class="mf">0.00</span><span class="nc">B</span><span class="w">
                </span><span class="nc">Data</span><span class="p">,</span><span class="ss">single</span><span class="p">:</span><span class="w">           </span><span class="mf">641.00</span><span class="nc">GiB</span><span class="w">
                </span><span class="nc">Data</span><span class="p">,</span><span class="nc">RAID0</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span><span class="w">            </span><span class="mf">1.00</span><span class="nc">GiB</span><span class="w">
                </span><span class="nc">Metadata</span><span class="p">,</span><span class="ss">single</span><span class="p">:</span><span class="w">        </span><span class="mf">19.00</span><span class="nc">GiB</span><span class="w">
                </span><span class="nc">System</span><span class="p">,</span><span class="ss">single</span><span class="p">:</span><span class="w">          </span><span class="mf">32.00</span><span class="nc">MiB</span><span class="w">
                </span><span class="ss">Unallocated</span><span class="p">:</span><span class="w">           </span><span class="mf">271.48</span><span class="nc">GiB</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Device</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="p" data-group-id="7064430154-22">(</span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">size</span><span class="p" data-group-id="7064430154-22">)</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Device</span><span class="w"> </span><span class="n">slack</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">portion</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w">  </span><span class="k" data-group-id="7064430154-13">after</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">shrink</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Data</span><span class="p">,</span><span class="n">single</span><span class="p">,</span><span class="w"> </span><span class="nc">Metadata</span><span class="p">,</span><span class="n">single</span><span class="p">,</span><span class="w"> </span><span class="nc">System</span><span class="p">,</span><span class="n">single</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">general</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="7064430154-23">(</span><span class="nc">Data</span><span class="p">,</span><span class="w"> </span><span class="nc">Metadata</span><span class="p">,</span><span class="w"> </span><span class="nc">System</span><span class="p" data-group-id="7064430154-23">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="p" data-group-id="7064430154-24">(</span><span class="n">single</span><span class="p">,</span><span class="w"> </span><span class="nc">RAID1</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="p" data-group-id="7064430154-24">)</span><span class="w"> </span><span class="n">allocated</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Data</span><span class="p">,</span><span class="nc">RAID0</span><span class="o">/</span><span class="mi">3</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">particular</span><span class="p">,</span><span class="w"> </span><span class="n">striped</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="nc">RAID0</span><span class="o">/</span><span class="nc">RAID10</span><span class="o">/</span><span class="nc">RAID5</span><span class="o">/</span><span class="nc">RAID6</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stripes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">allocated</span><span class="p">,</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">occurrences</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w">  </span><span class="n">pro</span><span class="err">‐</span><span class="w">
            </span><span class="n">file</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">stripes</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">writes</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Unallocated</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">groups</span><span class="w">

          </span><span class="nc">Options</span><span class="w">

          </span><span class="o">-</span><span class="n">b</span><span class="o">|</span><span class="o">--</span><span class="n">raw</span><span class="w">
                 </span><span class="n">raw</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">B</span><span class="w"> </span><span class="n">suffix</span><span class="w">

          </span><span class="o">-</span><span class="n">h</span><span class="o">|</span><span class="o">--</span><span class="n">human</span><span class="o">-</span><span class="n">readable</span><span class="w">
                 </span><span class="n">print</span><span class="w"> </span><span class="n">human</span><span class="w"> </span><span class="n">friendly</span><span class="w"> </span><span class="n">numbers</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w">

          </span><span class="o">-</span><span class="nc">H</span><span class="w">     </span><span class="n">print</span><span class="w"> </span><span class="n">human</span><span class="w"> </span><span class="n">friendly</span><span class="w"> </span><span class="n">numbers</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="mi">1000</span><span class="w">

          </span><span class="o">--</span><span class="n">iec</span><span class="w">  </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IEC</span><span class="w"> </span><span class="n">standard</span><span class="w">

          </span><span class="o">--</span><span class="n">si</span><span class="w">   </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SI</span><span class="w"> </span><span class="n">standard</span><span class="w">

          </span><span class="o">-</span><span class="n">k</span><span class="o">|</span><span class="o">--</span><span class="n">kbytes</span><span class="w">
                 </span><span class="n">show</span><span class="w"> </span><span class="n">sizes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">KiB</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">si</span><span class="w">

          </span><span class="o">-</span><span class="n">m</span><span class="o">|</span><span class="o">--</span><span class="n">mbytes</span><span class="w">
                 </span><span class="n">show</span><span class="w"> </span><span class="n">sizes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">MiB</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">MB</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">si</span><span class="w">

          </span><span class="o">-</span><span class="n">g</span><span class="o">|</span><span class="o">--</span><span class="n">gbytes</span><span class="w">
                 </span><span class="n">show</span><span class="w"> </span><span class="n">sizes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">GiB</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">GB</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">si</span><span class="w">

          </span><span class="o">-</span><span class="n">t</span><span class="o">|</span><span class="o">--</span><span class="n">tbytes</span><span class="w">
                 </span><span class="n">show</span><span class="w"> </span><span class="n">sizes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">TiB</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">TB</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">si</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">conflicting</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">passed</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">precedence</span><span class="o">.</span></code></pre><p>DEVICE STATS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w">  </span><span class="n">device</span><span class="w">  </span><span class="n">stats</span><span class="w">  </span><span class="n">keep</span><span class="w">  </span><span class="n">persistent</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">classes</span><span class="w"> </span><span class="n">related</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">doing</span><span class="w"> </span><span class="nc">IO</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w">
   </span><span class="n">scrub</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">

      </span><span class="err">$</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="w">
      </span><span class="p" data-group-id="6867007705-1">[</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="p" data-group-id="6867007705-1">]</span><span class="o">.</span><span class="n">write_io_errs</span><span class="w">   </span><span class="mi">0</span><span class="w">
      </span><span class="p" data-group-id="6867007705-2">[</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="p" data-group-id="6867007705-2">]</span><span class="o">.</span><span class="n">read_io_errs</span><span class="w">    </span><span class="mi">0</span><span class="w">
      </span><span class="p" data-group-id="6867007705-3">[</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="p" data-group-id="6867007705-3">]</span><span class="o">.</span><span class="n">flush_io_errs</span><span class="w">   </span><span class="mi">0</span><span class="w">
      </span><span class="p" data-group-id="6867007705-4">[</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="p" data-group-id="6867007705-4">]</span><span class="o">.</span><span class="n">corruption_errs</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p" data-group-id="6867007705-5">[</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="p" data-group-id="6867007705-5">]</span><span class="o">.</span><span class="n">generation_errs</span><span class="w"> </span><span class="mi">0</span><span class="w">

   </span><span class="n">write_io_errs</span><span class="w">
          </span><span class="nc">Failed</span><span class="w"> </span><span class="n">writes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">devices</span><span class="p">,</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">layers</span><span class="w"> </span><span class="n">beneath</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">satisfy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="w">

   </span><span class="n">read_io_errors</span><span class="w">
          </span><span class="nc">Read</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">analogy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">write_io_errs</span><span class="o">.</span><span class="w">

   </span><span class="n">flush_io_errs</span><span class="w">
          </span><span class="nc">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="n">writes</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">FLUSH</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">flushing</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">forcing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">crucial</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">implementing</span><span class="w">  </span><span class="n">crash</span><span class="w">  </span><span class="n">consis</span><span class="err">‐</span><span class="w">
          </span><span class="n">tency</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">btrfs</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">permanently</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">superblock</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="o">.</span><span class="w">

   </span><span class="n">corruption_errs</span><span class="w">
          </span><span class="nc">A</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">mismatched</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">corrupted</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">found</span><span class="o">.</span><span class="w">

   </span><span class="n">generation_errs</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">generation</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p" data-group-id="6867007705-6">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="n">node</span><span class="p" data-group-id="6867007705-6">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Since</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="mf">5.14</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">textual</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">fs</span><span class="o">/</span><span class="n">btrfs</span><span class="o">/</span><span class="nc">FSID</span><span class="o">/</span><span class="n">devinfo</span><span class="o">/</span><span class="nc">DEVID</span><span class="o">/</span><span class="n">error_stats</span><span class="o">.</span></code></pre><p>EXIT STATUS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">succeeds</span><span class="o">.</span><span class="w"> </span><span class="nc">Non</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">stats</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">counters</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="o">.</span></code></pre><p>AVAILABILITY</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">btrfs</span><span class="o">-</span><span class="n">progs</span><span class="o">.</span><span class="w">  </span><span class="nc">Please</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="ss">://</span><span class="n">btrfs</span><span class="o">.</span><span class="n">readthedocs</span><span class="o">.</span><span class="n">io</span><span class="o">.</span></code></pre><p>SEE ALSO</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">btrfs</span><span class="o">-</span><span class="n">balance</span><span class="p" data-group-id="0594285241-1">(</span><span class="mi">8</span><span class="p" data-group-id="0594285241-1">)</span><span class="w"> </span><span class="n">btrfs</span><span class="o">-</span><span class="n">device</span><span class="p" data-group-id="0594285241-2">(</span><span class="mi">8</span><span class="p" data-group-id="0594285241-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">btrfs</span><span class="o">-</span><span class="n">replace</span><span class="p" data-group-id="0594285241-3">(</span><span class="mi">8</span><span class="p" data-group-id="0594285241-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">mkfs</span><span class="o">.</span><span class="n">btrfs</span><span class="p" data-group-id="0594285241-4">(</span><span class="mi">8</span><span class="p" data-group-id="0594285241-4">)</span></code></pre><p>6.14                                                                                     Apr 17, 2025                                                                          BTRFS-DEVICE(8)</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="btrfs-convert.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
btrfs-convert
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="btrfs-filesystem.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
btrfs-filesystem
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
