<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="Manpages v3.0.0">


    <title>gitformat-pack — Manpages v3.0.0</title>

    <link rel="stylesheet" href="dist/html-elixir-KV3YOVJ3.css" />

    <script defer src="dist/sidebar_items-23381D40.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>
<link rel="stylesheet" href="assets/doc.css">
  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Manpages" />
        </a>

      <div>
        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectName" translate="no">
Manpages
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v3.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras="MANUALS"></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Manpages</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>gitformat-pack</h1>


  </div>


<p>GITFORMAT-PACK(5)                                                                         Git Manual                                                                         GITFORMAT-PACK(5)</p><p>NAME</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">gitformat</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Git</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">format</span></code></pre><p>SYNOPSIS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="err">$</span><span class="nc">GIT_DIR</span><span class="o">/</span><span class="n">objects</span><span class="o">/</span><span class="n">pack</span><span class="o">/</span><span class="n">pack</span><span class="o">-</span><span class="o">.</span><span class="p" data-group-id="6258846475-1">{</span><span class="n">pack</span><span class="p">,</span><span class="n">idx</span><span class="p" data-group-id="6258846475-1">}</span><span class="w">
   </span><span class="err">$</span><span class="nc">GIT_DIR</span><span class="o">/</span><span class="n">objects</span><span class="o">/</span><span class="n">pack</span><span class="o">/</span><span class="n">pack</span><span class="o">-</span><span class="o">.</span><span class="n">rev</span><span class="w">
   </span><span class="err">$</span><span class="nc">GIT_DIR</span><span class="o">/</span><span class="n">objects</span><span class="o">/</span><span class="n">pack</span><span class="o">/</span><span class="n">pack</span><span class="o">-</span><span class="o">*</span><span class="o">.</span><span class="n">mtimes</span><span class="w">
   </span><span class="err">$</span><span class="nc">GIT_DIR</span><span class="o">/</span><span class="n">objects</span><span class="o">/</span><span class="n">pack</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="o">-</span><span class="n">index</span></code></pre><p>DESCRIPTION</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="nc">Git</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="nc">Git</span><span class="w"> </span><span class="n">stores</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">primary</span><span class="w"> </span><span class="n">repository</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w"> </span><span class="nc">Over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">repository</span><span class="p">,</span><span class="w"> </span><span class="n">loose</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="p" data-group-id="3362114935-1">(</span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="p" data-group-id="3362114935-1">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">smaller</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">consolidated</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">larger</span><span class="w">
   </span><span class="n">pack</span><span class="p" data-group-id="3362114935-2">(</span><span class="n">s</span><span class="p" data-group-id="3362114935-2">)</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">gc</span><span class="p" data-group-id="3362114935-3">(</span><span class="mi">1</span><span class="p" data-group-id="3362114935-3">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">pack</span><span class="o">-</span><span class="n">objects</span><span class="p" data-group-id="3362114935-4">(</span><span class="mi">1</span><span class="p" data-group-id="3362114935-4">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">over</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">wire</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">gitprotocol</span><span class="o">-</span><span class="n">v2</span><span class="p" data-group-id="3362114935-5">(</span><span class="mi">5</span><span class="p" data-group-id="3362114935-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">container</span><span class="w"> </span><span class="n">formats</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">gitformat</span><span class="o">-</span><span class="n">bundle</span><span class="p" data-group-id="3362114935-6">(</span><span class="mi">5</span><span class="p" data-group-id="3362114935-6">)</span><span class="o">.</span></code></pre><p>CHECKSUMS AND OBJECT IDS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">In</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">repository</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">traditional</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">checksums</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">checksums</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="nc">IDs</span><span class="w"> </span><span class="p" data-group-id="6426790221-1">(</span><span class="n">object</span><span class="w"> </span><span class="n">names</span><span class="p" data-group-id="6426790221-1">)</span><span class="w"> </span><span class="n">mentioned</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="nc">Similarly</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">256</span><span class="w">
   </span><span class="n">repositories</span><span class="p">,</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">256</span><span class="o">.</span></code></pre><p>PACK-*.PACK FILES HAVE THE FOLLOWING FORMAT:</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">beginning</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">following</span><span class="p">:</span><span class="w">

           </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="ss">signature</span><span class="p">:</span><span class="w">
               </span><span class="nc">The</span><span class="w"> </span><span class="n">signature</span><span class="w"> </span><span class="ss">is</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="2792277620-1">{</span><span class="sc">&#39;P&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;K&#39;</span><span class="p" data-group-id="2792277620-1">}</span><span class="w">

           </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p" data-group-id="2792277620-2">(</span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="2792277620-2">)</span><span class="p">:</span><span class="w">
               </span><span class="nc">Git</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">accepts</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">but</span><span class="w">
               </span><span class="n">generates</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w">

           </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="p" data-group-id="2792277620-3">(</span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="2792277620-3">)</span><span class="w">

           </span><span class="ss">Observation</span><span class="p">:</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">4</span><span class="nc">G</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="p">;</span><span class="o">-</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w">
           </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">4</span><span class="nc">G</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">entries</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">looks</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="ss">this</span><span class="p">:</span><span class="w">

           </span><span class="p" data-group-id="2792277620-4">(</span><span class="n">undeltified</span><span class="w"> </span><span class="n">representation</span><span class="p" data-group-id="2792277620-4">)</span><span class="w">
           </span><span class="n">n</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p" data-group-id="2792277620-5">(</span><span class="mi">3</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2792277620-6">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="2792277620-6">)</span><span class="o">*</span><span class="mi">7</span><span class="o">+</span><span class="mi">4</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">length</span><span class="p" data-group-id="2792277620-5">)</span><span class="w">
           </span><span class="n">compressed</span><span class="w"> </span><span class="n">data</span><span class="w">

           </span><span class="p" data-group-id="2792277620-7">(</span><span class="n">deltified</span><span class="w"> </span><span class="n">representation</span><span class="p" data-group-id="2792277620-7">)</span><span class="w">
           </span><span class="n">n</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p" data-group-id="2792277620-8">(</span><span class="mi">3</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2792277620-9">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="2792277620-9">)</span><span class="o">*</span><span class="mi">7</span><span class="o">+</span><span class="mi">4</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">length</span><span class="p" data-group-id="2792277620-8">)</span><span class="w">
           </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">OBJ_REF_DELTA</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">negative</span><span class="w"> </span><span class="n">relative</span><span class="w">
               </span><span class="n">offset</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="n">object</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">this</span><span class="w">
               </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OBJ_OFS_DELTA</span><span class="w"> </span><span class="n">object</span><span class="w">
           </span><span class="n">compressed</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="n">data</span><span class="w">

           </span><span class="ss">Observation</span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variable</span><span class="w">
           </span><span class="n">length</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">constrained</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">32</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">anything</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">trailer</span><span class="w"> </span><span class="n">records</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="o">.</span></code></pre><p>   Object types</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Valid</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">OBJ_COMMIT</span><span class="w"> </span><span class="p" data-group-id="6039966928-1">(</span><span class="mi">1</span><span class="p" data-group-id="6039966928-1">)</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">OBJ_TREE</span><span class="w"> </span><span class="p" data-group-id="6039966928-2">(</span><span class="mi">2</span><span class="p" data-group-id="6039966928-2">)</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">OBJ_BLOB</span><span class="w"> </span><span class="p" data-group-id="6039966928-3">(</span><span class="mi">3</span><span class="p" data-group-id="6039966928-3">)</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">OBJ_TAG</span><span class="w"> </span><span class="p" data-group-id="6039966928-4">(</span><span class="mi">4</span><span class="p" data-group-id="6039966928-4">)</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">OBJ_OFS_DELTA</span><span class="w"> </span><span class="p" data-group-id="6039966928-5">(</span><span class="mi">6</span><span class="p" data-group-id="6039966928-5">)</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">OBJ_REF_DELTA</span><span class="w"> </span><span class="p" data-group-id="6039966928-6">(</span><span class="mi">7</span><span class="p" data-group-id="6039966928-6">)</span><span class="w">

   </span><span class="nc">Type</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reserved</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">expansion</span><span class="o">.</span><span class="w"> </span><span class="nc">Type</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">invalid</span><span class="o">.</span></code></pre><p>   Size encoding</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">This</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="s">&quot;size encoding&quot;</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">negative</span><span class="w"> </span><span class="ss">integers</span><span class="p">:</span><span class="w"> </span><span class="nc">From</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">byte</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">seven</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">significant</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resulting</span><span class="w"> </span><span class="n">integer</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">most</span><span class="w">
   </span><span class="n">significant</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">continues</span><span class="p">;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">MSB</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">seven</span><span class="w"> </span><span class="n">bits</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">seven</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">chunks</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">concatenated</span><span class="o">.</span><span class="w"> </span><span class="nc">Later</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">significant</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">confused</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s">&quot;offset encoding&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">document</span><span class="o">.</span></code></pre><p>   Deltified representation</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Conceptually</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">four</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ss">types</span><span class="p">:</span><span class="w"> </span><span class="n">commit</span><span class="p">,</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">blob</span><span class="o">.</span><span class="w"> </span><span class="nc">However</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="n">space</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;delta&quot;</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="n">object</span><span class="o">.</span><span class="w"> </span><span class="nc">These</span><span class="w">
   </span><span class="n">representations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">ofs</span><span class="o">-</span><span class="n">delta</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ref</span><span class="o">-</span><span class="n">delta</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="nc">Both</span><span class="w"> </span><span class="n">ofs</span><span class="o">-</span><span class="n">delta</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ref</span><span class="o">-</span><span class="n">delta</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s">&quot;delta&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="p" data-group-id="6360577568-1">(</span><span class="n">called</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="p" data-group-id="6360577568-1">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reconstruct</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">is</span><span class="p">,</span><span class="w"> </span><span class="n">ref</span><span class="o">-</span><span class="n">delta</span><span class="w"> </span><span class="n">directly</span><span class="w">
   </span><span class="n">encodes</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="n">ofs</span><span class="o">-</span><span class="n">delta</span><span class="w"> </span><span class="n">encodes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">deltified</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w"> </span><span class="nc">Ref</span><span class="o">-</span><span class="n">delta</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="p" data-group-id="6360577568-2">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">so</span><span class="o">-</span><span class="n">called</span><span class="w"> </span><span class="s">&quot;thin pack&quot;</span><span class="p" data-group-id="6360577568-2">)</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">however</span><span class="p">,</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">cyclic</span><span class="w"> </span><span class="n">dependency</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reconstructed</span><span class="o">.</span><span class="w"> </span><span class="nc">These</span><span class="w"> </span><span class="n">sizes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">above</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">remainder</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">delta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">instructions</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reconstruct</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deltified</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">canonical</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">first</span><span class="o">.</span><span class="w"> </span><span class="nc">Each</span><span class="w">
   </span><span class="n">instruction</span><span class="w"> </span><span class="n">appends</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">it</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">complete</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">instructions</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="ss">far</span><span class="p">:</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">copying</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">and</span><span class="w">
   </span><span class="n">one</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">inserting</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">embedded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">itself</span><span class="o">.</span><span class="w">

   </span><span class="nc">Each</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">length</span><span class="o">.</span><span class="w"> </span><span class="nc">Instruction</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">determined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">seventh</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">octet</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">diagrams</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">convention</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">RFC</span><span class="w"> </span><span class="mi">1951</span><span class="w"> </span><span class="p" data-group-id="6360577568-3">(</span><span class="nc">Deflate</span><span class="w">
   </span><span class="n">compressed</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">format</span><span class="p" data-group-id="6360577568-3">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Instruction</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w">

           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
           </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="n">xxxxxxx</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">size1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">size2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">size3</span><span class="w"> </span><span class="o">|</span><span class="w">
           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">object</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">encodes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">copy</span><span class="o">.</span><span class="w"> </span><span class="nc">Offset</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">in</span><span class="w">
       </span><span class="n">little</span><span class="o">-</span><span class="n">endian</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="w">

       </span><span class="nc">All</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">optional</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">offsets</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">sizes</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">seven</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">octet</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">next</span><span class="w"> </span><span class="n">seven</span><span class="w"> </span><span class="n">octets</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">offset1</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">offset2</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">on</span><span class="o">.</span><span class="w">

       </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">compact</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">encoding</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">offset2</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">below</span><span class="p">,</span><span class="w"> </span><span class="n">offset3</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="mi">16</span><span class="o">-</span><span class="mi">23</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w">
       </span><span class="n">become</span><span class="w"> </span><span class="n">offset2</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="mi">8</span><span class="o">-</span><span class="mi">15</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">offset1</span><span class="o">.</span><span class="w">

           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
           </span><span class="o">|</span><span class="w"> </span><span class="mi">10000101</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset3</span><span class="w"> </span><span class="o">|</span><span class="w">
           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">

       </span><span class="nc">In</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">compact</span><span class="w"> </span><span class="n">form</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="p" data-group-id="6360577568-4">(</span><span class="mh">0x80</span><span class="p" data-group-id="6360577568-4">)</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">zero</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="ss">exception</span><span class="p">:</span><span class="w"> </span><span class="n">size</span><span class="w">
       </span><span class="n">zero</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mh">0x10000</span><span class="o">.</span><span class="w">

   </span><span class="nc">Instruction</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">data</span><span class="w">

           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">+</span><span class="w">
           </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="n">xxxxxxx</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="n">data</span><span class="w">    </span><span class="o">|</span><span class="w">
           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">+</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">construct</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">appended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">object</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">seven</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">octet</span><span class="w">
       </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="o">.</span><span class="w">

   </span><span class="nc">Reserved</span><span class="w"> </span><span class="n">instruction</span><span class="w">

           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="w">
           </span><span class="o">|</span><span class="w"> </span><span class="mi">00000000</span><span class="w"> </span><span class="o">|</span><span class="w">
           </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">reserved</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">expansion</span><span class="o">.</span></code></pre><p>ORIGINAL (VERSION 1) PACK-*.IDX FILES HAVE THE FOLLOWING FORMAT:</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">integers</span><span class="o">.</span><span class="w"> </span><span class="nc">N</span><span class="o">-</span><span class="n">th</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">records</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">whose</span><span class="w"> </span><span class="n">object</span><span class="w">
       </span><span class="n">name</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">N</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">fan</span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sorted</span><span class="w"> </span><span class="mi">24</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">entries</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w"> </span><span class="nc">Each</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="ss">is</span><span class="p">:</span><span class="w">

           </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">integer</span><span class="p">,</span><span class="w"> </span><span class="n">recording</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">object</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">beginning</span><span class="o">.</span><span class="w">

           </span><span class="n">one</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="n">size</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">concluded</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ss">trailer</span><span class="p">:</span><span class="w">

           </span><span class="nc">A</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w">
           </span><span class="n">packfile</span><span class="o">.</span><span class="w">

           </span><span class="nc">Index</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="o">.</span><span class="w">

   </span><span class="nc">Pack</span><span class="w"> </span><span class="nc">Idx</span><span class="w"> </span><span class="ss">file</span><span class="p">:</span><span class="w">

               </span><span class="o">--</span><span class="w">  </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">
       </span><span class="n">fanout</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">fanout</span><span class="p" data-group-id="6179355269-1">[</span><span class="mi">0</span><span class="p" data-group-id="6179355269-1">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p" data-group-id="6179355269-2">(</span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p" data-group-id="6179355269-2">)</span><span class="w">    </span><span class="o">|</span><span class="o">-</span><span class="o">.</span><span class="w">
       </span><span class="n">table</span><span class="w">       </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">|</span><span class="w"> </span><span class="n">fanout</span><span class="p" data-group-id="6179355269-3">[</span><span class="mi">1</span><span class="p" data-group-id="6179355269-3">]</span><span class="w">                      </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">|</span><span class="w"> </span><span class="n">fanout</span><span class="p" data-group-id="6179355269-4">[</span><span class="mi">2</span><span class="p" data-group-id="6179355269-4">]</span><span class="w">                      </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="err">~</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">|</span><span class="w"> </span><span class="n">fanout</span><span class="p" data-group-id="6179355269-5">[</span><span class="mi">255</span><span class="p" data-group-id="6179355269-5">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">objects</span><span class="w">    </span><span class="o">|</span><span class="o">--</span><span class="o">-</span><span class="o">.</span><span class="w">
               </span><span class="o">--</span><span class="w">  </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="n">main</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="n">offset</span><span class="w">                         </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="n">index</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="mi">00</span><span class="nc">XXXXXXXXXXXXXXXX</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="n">table</span><span class="w">       </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">|</span><span class="w"> </span><span class="n">offset</span><span class="w">                         </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">|</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="mi">00</span><span class="nc">XXXXXXXXXXXXXXXX</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">
                   </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">&lt;</span><span class="o">+</span><span class="w"> </span><span class="o">|</span><span class="w">
                 </span><span class="o">.</span><span class="o">-</span><span class="o">|</span><span class="w"> </span><span class="n">offset</span><span class="w">                         </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="mi">01</span><span class="nc">XXXXXXXXXXXXXXXX</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">   </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset</span><span class="w">                         </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="mi">01</span><span class="nc">XXXXXXXXXXXXXXXX</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="o">~~~</span><span class="err">~</span><span class="w">   </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">offset</span><span class="w">                         </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="nc">FFXXXXXXXXXXXXXXXX</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w">
               </span><span class="o">--</span><span class="o">|</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">&lt;-</span><span class="o">-</span><span class="o">+</span><span class="w">
       </span><span class="n">trailer</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="n">checksum</span><span class="w">              </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">idxfile</span><span class="w"> </span><span class="n">checksum</span><span class="w">               </span><span class="o">|</span><span class="w">
                 </span><span class="o">|</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">
                 </span><span class="o">.</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">.</span><span class="w">
                         </span><span class="o">|</span><span class="w">
       </span><span class="nc">Pack</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ss">entry</span><span class="p">:</span><span class="w"> </span><span class="o">&lt;</span><span class="o">+</span><span class="w">

       </span><span class="n">packed</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ss">header</span><span class="p">:</span><span class="w">
          </span><span class="mi">1</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="p" data-group-id="6179355269-6">(</span><span class="nc">MSB</span><span class="p" data-group-id="6179355269-6">)</span><span class="w">
                 </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="6179355269-7">(</span><span class="n">next</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">bit</span><span class="p" data-group-id="6179355269-7">)</span><span class="w">
                 </span><span class="n">size0</span><span class="w"> </span><span class="p" data-group-id="6179355269-8">(</span><span class="n">lower</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">bit</span><span class="p" data-group-id="6179355269-8">)</span><span class="w">
          </span><span class="n">n</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">sizeN</span><span class="w"> </span><span class="p" data-group-id="6179355269-9">(</span><span class="n">as</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">MSB</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="mi">7</span><span class="o">-</span><span class="n">bit</span><span class="p" data-group-id="6179355269-9">)</span><span class="w">
                  </span><span class="n">size0</span><span class="o">..</span><span class="n">sizeN</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="mi">4</span><span class="o">+</span><span class="mi">7</span><span class="o">+</span><span class="mi">7</span><span class="o">+</span><span class="o">..</span><span class="o">+</span><span class="mi">7</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">integer</span><span class="p">,</span><span class="w"> </span><span class="n">size0</span><span class="w">
                  </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">significant</span><span class="w"> </span><span class="n">part</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">sizeN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w">
                  </span><span class="n">most</span><span class="w"> </span><span class="n">significant</span><span class="w"> </span><span class="n">part</span><span class="o">.</span><span class="w">
       </span><span class="n">packed</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ss">data</span><span class="p">:</span><span class="w">
          </span><span class="nc">If</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nc">DELTA</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">deflated</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="p" data-group-id="6179355269-10">(</span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">above</span><span class="w">
                  </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">compression</span><span class="p" data-group-id="6179355269-10">)</span><span class="o">.</span><span class="w">
          </span><span class="nc">If</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">REF_DELTA</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w">
            </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p" data-group-id="6179355269-11">(</span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w">
                  </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">follows</span><span class="p" data-group-id="6179355269-11">)</span><span class="o">.</span><span class="w">
            </span><span class="n">delta</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">deflated</span><span class="o">.</span><span class="w">
          </span><span class="nc">If</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">OFS_DELTA</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w">
            </span><span class="n">n</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="p" data-group-id="6179355269-12">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="6179355269-12">)</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">negative</span><span class="w">
                  </span><span class="n">offset</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
                  </span><span class="n">ofs</span><span class="o">-</span><span class="n">delta</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="p" data-group-id="6179355269-13">(</span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w">
                  </span><span class="n">the</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">follows</span><span class="p" data-group-id="6179355269-13">)</span><span class="o">.</span><span class="w">
            </span><span class="n">delta</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">deflated</span><span class="o">.</span><span class="w">

       </span><span class="n">offset</span><span class="w"> </span><span class="ss">encoding</span><span class="p">:</span><span class="w">
            </span><span class="n">n</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">MSB</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">one</span><span class="o">.</span><span class="w">
            </span><span class="nc">The</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">constructed</span><span class="w"> </span><span class="n">by</span><span class="w">
            </span><span class="n">concatenating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">byte</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">
            </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="p" data-group-id="6179355269-14">(</span><span class="mi">7</span><span class="o">*</span><span class="p" data-group-id="6179355269-15">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="6179355269-15">)</span><span class="p" data-group-id="6179355269-14">)</span><span class="w">
            </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">result</span><span class="o">.</span></code></pre><p>VERSION 2 PACK-*.IDX FILES SUPPORT PACKS LARGER THAN 4 GIB, AND</p><pre><code class="makeup elixir" translate="no"><span class="w">       </span><span class="n">have</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">reorganizations</span><span class="o">.</span><span class="w">  </span><span class="nc">They</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">format</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="err">\</span><span class="mi">377</span><span class="n">tOc</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">unreasonable</span><span class="w"> </span><span class="n">fanout</span><span class="p" data-group-id="3802823483-1">[</span><span class="mi">0</span><span class="p" data-group-id="3802823483-1">]</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p" data-group-id="3802823483-2">(</span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="3802823483-2">)</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">256</span><span class="o">-</span><span class="n">entry</span><span class="w"> </span><span class="n">fan</span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">v1</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">sorted</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">names</span><span class="o">.</span><span class="w"> </span><span class="nc">These</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">packed</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">footprint</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="nc">CRC32</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packed</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">compressed</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">copied</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">repacking</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">undetected</span><span class="w"> </span><span class="n">data</span><span class="w">
       </span><span class="n">corruption</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="p" data-group-id="3802823483-3">(</span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="3802823483-3">)</span><span class="o">.</span><span class="w"> </span><span class="nc">These</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">usually</span><span class="w"> </span><span class="mi">31</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">offsets</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">offsets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">msbit</span><span class="w">
       </span><span class="n">set</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">8</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="p" data-group-id="3802823483-4">(</span><span class="n">empty</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nc">GiB</span><span class="p" data-group-id="3802823483-4">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Pack</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">organized</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">heavily</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">toward</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">front</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">references</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w">
       </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">trailer</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="ss">file</span><span class="p">:</span><span class="w">

           </span><span class="nc">A</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">corresponding</span><span class="w"> </span><span class="n">packfile</span><span class="o">.</span><span class="w">

           </span><span class="nc">Index</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="o">.</span></code></pre><p>PACK-*.REV FILES HAVE THE FORMAT:</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mh">0x52494458</span><span class="w"> </span><span class="p" data-group-id="1248010441-1">(</span><span class="nc">RIDX</span><span class="p" data-group-id="1248010441-1">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="p" data-group-id="1248010441-2">(</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1248010441-2">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="p" data-group-id="1248010441-3">(</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">256</span><span class="p" data-group-id="1248010441-3">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">positions</span><span class="w"> </span><span class="p" data-group-id="1248010441-4">(</span><span class="n">one</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">packed</span><span class="w"> </span><span class="n">object</span><span class="p">,</span><span class="w"> </span><span class="n">num_objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">integer</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="1248010441-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">sorted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">offsets</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packfile</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">trailer</span><span class="p">,</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="ss">a</span><span class="p">:</span><span class="w">

           </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">packfile</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">

           </span><span class="n">a</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="o">.</span><span class="w">

   </span><span class="nc">All</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">order</span><span class="o">.</span></code></pre><p>PACK-*.MTIMES FILES HAVE THE FORMAT:</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">All</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mh">0x4d544d45</span><span class="w"> </span><span class="p" data-group-id="1739930425-1">(</span><span class="nc">MTME</span><span class="p" data-group-id="1739930425-1">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="p" data-group-id="1739930425-2">(</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1739930425-2">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="p" data-group-id="1739930425-3">(</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">256</span><span class="p" data-group-id="1739930425-3">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">integers</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">modification</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p" data-group-id="1739930425-4">(</span><span class="n">mtime</span><span class="p" data-group-id="1739930425-4">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">lexicographic</span><span class="w"> </span><span class="p" data-group-id="1739930425-5">(</span><span class="n">index</span><span class="p" data-group-id="1739930425-5">)</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">mtimes</span><span class="w"> </span><span class="n">count</span><span class="w">
       </span><span class="n">standard</span><span class="w"> </span><span class="n">epoch</span><span class="w"> </span><span class="n">seconds</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">trailer</span><span class="p">,</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">packfile</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="p" data-group-id="1739930425-6">(</span><span class="n">each</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">function</span><span class="p" data-group-id="1739930425-6">)</span><span class="o">.</span></code></pre><p>MULTI-PACK-INDEX (MIDX) FILES HAVE THE FOLLOWING FORMAT:</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="o">-</span><span class="n">index</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">pack</span><span class="o">-</span><span class="n">files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">loose</span><span class="w"> </span><span class="n">objects</span><span class="o">.</span><span class="w">

   </span><span class="nc">In</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">organize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;chunks&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">beginning</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">certain</span><span class="w">
   </span><span class="n">length</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">lengths</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">types</span><span class="o">.</span><span class="w">

   </span><span class="nc">All</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="w">

   </span><span class="ss">HEADER</span><span class="p">:</span><span class="w">

       </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="ss">signature</span><span class="p">:</span><span class="w">
           </span><span class="nc">The</span><span class="w"> </span><span class="n">signature</span><span class="w"> </span><span class="ss">is</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4035033469-1">{</span><span class="sc">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;I&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;X&#39;</span><span class="p" data-group-id="4035033469-1">}</span><span class="w">

       </span><span class="mi">1</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="ss">number</span><span class="p">:</span><span class="w">
           </span><span class="nc">Git</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">writes</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">recognizes</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w">

       </span><span class="mi">1</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="nc">Object</span><span class="w"> </span><span class="nc">Id</span><span class="w"> </span><span class="nc">Version</span><span class="w">
           </span><span class="nc">We</span><span class="w"> </span><span class="n">infer</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="nc">IDs</span><span class="w"> </span><span class="p" data-group-id="4035033469-2">(</span><span class="nc">OIDs</span><span class="p" data-group-id="4035033469-2">)</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ss">value</span><span class="p">:</span><span class="w">
               </span><span class="mi">1</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">1</span><span class="w">
               </span><span class="mi">2</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nc">SHA</span><span class="o">-</span><span class="mi">256</span><span class="w">
           </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">repository</span><span class="sc">&#39;s hash algorithm,
           the multi-pack-index file should be ignored with a warning
           presented to the user.

       1-byte number of &quot;chunks&quot;

       1-byte number of base multi-pack-index files:
           This value is currently always zero.

       4-byte number of pack files

   CHUNK LOOKUP:

       (C + 1) * 12 bytes providing the chunk offsets:
           First 4 bytes describe chunk id. Value 0 is a terminating label.
           Other 8 bytes provide offset in current file for chunk to start.
           (Chunks are provided in file-order, so you can infer the length
           using the next chunk position if necessary.)

       The CHUNK LOOKUP matches the table of contents from
       the chunk-based file format, see linkgit:gitformat-chunk[5].

       The remaining data in the body is described one chunk at a time, and
       these chunks may be given in any order. Chunks are required unless
       otherwise specified.

   CHUNK DATA:

       Packfile Names (ID: {&#39;</span><span class="nc">P</span><span class="sc">&#39;, &#39;</span><span class="nc">N</span><span class="sc">&#39;, &#39;</span><span class="nc">A</span><span class="sc">&#39;, &#39;</span><span class="nc">M</span><span class="sc">&#39;})
           Store the names of packfiles as a sequence of NUL-terminated
           strings. There is no extra padding between the filenames,
           and they are listed in lexicographic order. The chunk itself
           is padded at the end with between 0 and 3 NUL bytes to make the
           chunk size a multiple of 4 bytes.

       Bitmapped Packfiles (ID: {&#39;</span><span class="nc">B</span><span class="sc">&#39;, &#39;</span><span class="nc">T</span><span class="sc">&#39;, &#39;</span><span class="nc">M</span><span class="sc">&#39;, &#39;</span><span class="nc">P</span><span class="sc">&#39;})
           Stores a table of two 4-byte unsigned integers in network order.
           Each table entry corresponds to a single pack (in the order that
           they appear above in the `PNAM` chunk). The values for each table
           entry are as follows:
           - The first bit position (in pseudo-pack order, see below) to
             contain an object from that pack.
           - The number of bits whose objects are selected from that pack.

       OID Fanout (ID: {&#39;</span><span class="nc">O</span><span class="sc">&#39;, &#39;</span><span class="nc">I</span><span class="sc">&#39;, &#39;</span><span class="nc">D</span><span class="sc">&#39;, &#39;</span><span class="nc">F</span><span class="sc">&#39;})
           The ith entry, F[i], stores the number of OIDs with first
           byte at most i. Thus F[255] stores the total
           number of objects.

       OID Lookup (ID: {&#39;</span><span class="nc">O</span><span class="sc">&#39;, &#39;</span><span class="nc">I</span><span class="sc">&#39;, &#39;</span><span class="nc">D</span><span class="sc">&#39;, &#39;</span><span class="nc">L</span><span class="sc">&#39;})
           The OIDs for all objects in the MIDX are stored in lexicographic
           order in this chunk.

       Object Offsets (ID: {&#39;</span><span class="nc">O</span><span class="sc">&#39;, &#39;</span><span class="nc">O</span><span class="sc">&#39;, &#39;</span><span class="nc">F</span><span class="sc">&#39;, &#39;</span><span class="nc">F</span><span class="sc">&#39;})
           Stores two 4-byte values for every object.
           1: The pack-int-id for the pack storing this object.
           2: The offset within the pack.
               If all offsets are less than 2^32, then the large offset chunk
               will not exist and offsets are stored as in IDX v1.
               If there is at least one offset value larger than 2^32-1, then
               the large offset chunk must exist, and offsets larger than
               2^31-1 must be stored in it instead. If the large offset chunk
               exists and the 31st bit is on, then removing that bit reveals
               the row in the large offsets containing the 8-byte offset of
               this object.

       [Optional] Object Large Offsets (ID: {&#39;</span><span class="nc">L</span><span class="sc">&#39;, &#39;</span><span class="nc">O</span><span class="sc">&#39;, &#39;</span><span class="nc">F</span><span class="sc">&#39;, &#39;</span><span class="nc">F</span><span class="sc">&#39;})
           8-byte offsets into large packfiles.

       [Optional] Bitmap pack order (ID: {&#39;</span><span class="nc">R</span><span class="sc">&#39;, &#39;</span><span class="nc">I</span><span class="sc">&#39;, &#39;</span><span class="nc">D</span><span class="sc">&#39;, &#39;</span><span class="nc">X</span><span class="err">&#39;</span><span class="err">}</span><span class="p">)</span><span class="w">
           </span><span class="nc">A</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">positions</span><span class="w"> </span><span class="p" data-group-id="4035033469-3">(</span><span class="n">one</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p">,</span><span class="w"> </span><span class="n">num_objects</span><span class="w"> </span><span class="ow">in</span><span class="w">
           </span><span class="n">total</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">integer</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="4035033469-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">sorted</span><span class="w">
           </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">bitmap</span><span class="o">/</span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">positions</span><span class="o">.</span><span class="w">

   </span><span class="ss">TRAILER</span><span class="p">:</span><span class="w">

       </span><span class="nc">Index</span><span class="w"> </span><span class="n">checksum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">contents</span><span class="o">.</span></code></pre><p>MULTI-PACK-INDEX REVERSE INDEXES</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="w">

   </span><span class="nc">Instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">pack</span><span class="o">-</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">maps</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">object</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w">
   </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="p" data-group-id="4348593757-1">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">holds</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="4348593757-1">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">To</span><span class="w"> </span><span class="n">clarify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">orderings</span><span class="p">,</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">reachability</span><span class="w"> </span><span class="n">bitmap</span><span class="w"> </span><span class="p" data-group-id="4348593757-2">(</span><span class="n">which</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">yet</span><span class="w"> </span><span class="n">exist</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">building</span><span class="w"> </span><span class="n">towards</span><span class="w"> </span><span class="n">here</span><span class="p" data-group-id="4348593757-2">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Each</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w">
   </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">efficient</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">position</span><span class="o">.</span><span class="w">

   </span><span class="nc">One</span><span class="w"> </span><span class="n">solution</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">let</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">occupy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">oid</span><span class="o">-</span><span class="n">sorted</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="o">.</span><span class="w"> </span><span class="nc">But</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">oids</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">effectively</span><span class="w"> </span><span class="n">random</span><span class="p">,</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">resulting</span><span class="w"> </span><span class="n">reachability</span><span class="w"> </span><span class="n">bitmaps</span><span class="w"> </span><span class="n">would</span><span class="w">
   </span><span class="n">have</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">locality</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">thus</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="n">poorly</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="4348593757-3">(</span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reason</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">bitmaps</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">ordering</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">.</span><span class="n">idx</span><span class="w"> </span><span class="n">ordering</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">purpose</span><span class="o">.</span><span class="p" data-group-id="4348593757-3">)</span><span class="w">

   </span><span class="nc">So</span><span class="w"> </span><span class="n">we</span><span class="err">’</span><span class="n">d</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">ordering</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="n">better</span><span class="w"> </span><span class="n">locality</span><span class="w"> </span><span class="p" data-group-id="4348593757-4">(</span><span class="ow">and</span><span class="w"> </span><span class="n">thus</span><span class="w"> </span><span class="n">compresses</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">efficiently</span><span class="p" data-group-id="4348593757-4">)</span><span class="o">.</span><span class="w"> </span><span class="nc">We</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">think</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w">
   </span><span class="n">created</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">concatenation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="o">.</span><span class="w"> </span><span class="nc">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="p" data-group-id="4348593757-5">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p" data-group-id="4348593757-5">)</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">respectively</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">imagine</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ordering</span><span class="w">
   </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ss">like</span><span class="p">:</span><span class="w">

       </span><span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="o">|</span><span class="n">...</span><span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="mi">9</span><span class="o">|</span><span class="n">b</span><span class="p">,</span><span class="mi">0</span><span class="o">|</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="o">|</span><span class="n">...</span><span class="o">|</span><span class="n">b</span><span class="p">,</span><span class="mi">14</span><span class="o">|</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="o">|</span><span class="n">c</span><span class="p">,</span><span class="mi">1</span><span class="o">|</span><span class="n">...</span><span class="o">|</span><span class="n">c</span><span class="p">,</span><span class="mi">19</span><span class="o">|</span><span class="w">

   </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">packfile</span><span class="o">.</span><span class="w">

   </span><span class="nc">Given</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">counts</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">objects</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">naïvely</span><span class="w"> </span><span class="n">reconstruct</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="p" data-group-id="4348593757-6">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="p" data-group-id="4348593757-7">(</span><span class="n">c</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="4348593757-7">)</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="w">
   </span><span class="n">consumed</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">slots</span><span class="p" data-group-id="4348593757-6">)</span><span class="o">.</span><span class="w"> </span><span class="nc">But</span><span class="w"> </span><span class="n">there</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">catch</span><span class="o">.</span><span class="w"> </span><span class="nc">Objects</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">duplicated</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">packs</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">stores</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="p" data-group-id="4348593757-8">(</span><span class="ow">and</span><span class="w"> </span><span class="n">thus</span><span class="w"> </span><span class="n">we</span><span class="err">’</span><span class="n">d</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">slot</span><span class="w">
   </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bitmap</span><span class="p" data-group-id="4348593757-8">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Callers</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">duplicates</span><span class="w"> </span><span class="n">themselves</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">bit</span><span class="o">-</span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">that</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">linear</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">objects</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">expensive</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ordinary</span><span class="w"> </span><span class="n">bitmap</span><span class="w">
   </span><span class="n">lookups</span><span class="o">.</span><span class="w"> </span><span class="nc">Building</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">solves</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logical</span><span class="w"> </span><span class="n">inverse</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">duplicates</span><span class="o">.</span><span class="w"> </span><span class="nc">But</span><span class="p">,</span><span class="w"> </span><span class="n">building</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fly</span><span class="w">
   </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">expensive</span><span class="o">.</span><span class="w"> </span><span class="nc">Since</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">disk</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pack</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">indexes</span><span class="p">,</span><span class="w"> </span><span class="n">let</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">reuse</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="n">too</span><span class="o">.</span><span class="w">

   </span><span class="nc">Objects</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">ordered</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">follows</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="o">.</span><span class="w"> </span><span class="nc">Let</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-9">(</span><span class="n">o</span><span class="p" data-group-id="4348593757-9">)</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packs</span><span class="w">
   </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="p" data-group-id="4348593757-10">(</span><span class="n">as</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p" data-group-id="4348593757-10">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Let</span><span class="w"> </span><span class="n">offset</span><span class="p" data-group-id="4348593757-11">(</span><span class="n">o</span><span class="p" data-group-id="4348593757-11">)</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-12">(</span><span class="n">o</span><span class="p" data-group-id="4348593757-12">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Then</span><span class="p">,</span><span class="w"> </span><span class="n">compare</span><span class="w"> </span><span class="n">o1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">o2</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">If</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-13">(</span><span class="n">o1</span><span class="p" data-group-id="4348593757-13">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-14">(</span><span class="n">o2</span><span class="p" data-group-id="4348593757-14">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">preferred</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">preferred</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">sorts</span><span class="w"> </span><span class="n">first</span><span class="o">.</span><span class="w">

       </span><span class="p" data-group-id="4348593757-15">(</span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">detail</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">bitmap</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="o">-</span><span class="n">reuse</span><span class="w"> </span><span class="n">mechanism</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">at</span><span class="w">
       </span><span class="n">bit</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="4348593757-15">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">If</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-16">(</span><span class="n">o1</span><span class="p" data-group-id="4348593757-16">)</span><span class="w"> </span><span class="err">≠</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-17">(</span><span class="n">o2</span><span class="p" data-group-id="4348593757-17">)</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">descending</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="nc">ID</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-18">(</span><span class="n">o1</span><span class="p" data-group-id="4348593757-18">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="4348593757-19">(</span><span class="n">o2</span><span class="p" data-group-id="4348593757-19">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">sorted</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pack</span><span class="o">-</span><span class="n">order</span><span class="w"> </span><span class="p" data-group-id="4348593757-20">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="n">o1</span><span class="w"> </span><span class="n">sorts</span><span class="w"> </span><span class="n">ahead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">o2</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">offset</span><span class="p" data-group-id="4348593757-21">(</span><span class="n">o1</span><span class="p" data-group-id="4348593757-21">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">offset</span><span class="p" data-group-id="4348593757-22">(</span><span class="n">o2</span><span class="p" data-group-id="4348593757-22">)</span><span class="p" data-group-id="4348593757-20">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">In</span><span class="w"> </span><span class="n">short</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">MIDX</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">de</span><span class="o">-</span><span class="n">duplicated</span><span class="w"> </span><span class="n">concatenation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p">,</span><span class="w"> </span><span class="n">laid</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">arranged</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="p" data-group-id="4348593757-23">(</span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">preferred</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">coming</span><span class="w"> </span><span class="n">first</span><span class="p" data-group-id="4348593757-23">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="nc">MIDX</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="nc">RIDX</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">itself</span><span class="o">.</span></code></pre><p>   BTMP chunk</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="nc">Bitmapped</span><span class="w"> </span><span class="nc">Packfiles</span><span class="w"> </span><span class="p" data-group-id="9372405461-1">(</span><span class="nc">BTMP</span><span class="p" data-group-id="9372405461-1">)</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">encodes</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">index</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">reachability</span><span class="w"> </span><span class="n">bitmap</span><span class="o">.</span><span class="w"> </span><span class="nc">Recall</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">arranged</span><span class="w"> </span><span class="ow">in</span><span class="w">
   </span><span class="s">&quot;pseudo-pack&quot;</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="p" data-group-id="9372405461-2">(</span><span class="n">see</span><span class="w"> </span><span class="n">above</span><span class="p" data-group-id="9372405461-2">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">reachability</span><span class="w"> </span><span class="n">bitmaps</span><span class="o">.</span><span class="w">

   </span><span class="nc">From</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">above</span><span class="p">,</span><span class="w"> </span><span class="n">suppose</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="n">objects</span><span class="p">,</span><span class="w"> </span><span class="n">respectively</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">arranged</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="o">|</span><span class="n">...</span><span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="mi">9</span><span class="o">|</span><span class="n">b</span><span class="p">,</span><span class="mi">0</span><span class="o">|</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="o">|</span><span class="n">...</span><span class="o">|</span><span class="n">b</span><span class="p">,</span><span class="mi">14</span><span class="o">|</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="o">|</span><span class="n">c</span><span class="p">,</span><span class="mi">1</span><span class="o">|</span><span class="n">...</span><span class="o">|</span><span class="n">c</span><span class="p">,</span><span class="mi">19</span><span class="o">|</span><span class="w">

   </span><span class="nc">When</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">bitmaps</span><span class="w"> </span><span class="p" data-group-id="9372405461-3">(</span><span class="ow">or</span><span class="p">,</span><span class="w"> </span><span class="n">equivalently</span><span class="p">,</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">reachability</span><span class="w"> </span><span class="n">bitmaps</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">preferred</span><span class="w"> </span><span class="n">pack</span><span class="p" data-group-id="9372405461-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">pack</span><span class="o">-</span><span class="n">objects</span><span class="p" data-group-id="9372405461-4">(</span><span class="mi">1</span><span class="p" data-group-id="9372405461-4">)</span><span class="w"> </span><span class="n">performs</span><span class="w"> </span><span class="err">“</span><span class="n">verbatim</span><span class="err">”</span><span class="w"> </span><span class="n">reuse</span><span class="p">,</span><span class="w"> </span><span class="n">attempting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reuse</span><span class="w">
   </span><span class="n">chunks</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bitmapped</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">preferred</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packing</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

   </span><span class="nc">When</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reused</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="n">therein</span><span class="w"> </span><span class="k" data-group-id="9372405461-5">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packing</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">saving</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="w"> </span><span class="nc">But</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w">
   </span><span class="n">existing</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reused</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">conditions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ss">met</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">requested</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="p" data-group-id="9372405461-6">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="n">didn</span><span class="err">’</span><span class="n">t</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">implicitly</span><span class="p" data-group-id="9372405461-6">)</span><span class="o">.</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">All</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">thin</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">offset</span><span class="o">-</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">reference</span><span class="o">-</span><span class="n">deltas</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resulting</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="nc">BTMP</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">encodes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">necessary</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">reuse</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packfiles</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="n">above</span><span class="o">.</span><span class="w"> </span><span class="nc">Specifically</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">BTMP</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">encodes</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">pieces</span><span class="w">
   </span><span class="n">of</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="p" data-group-id="9372405461-7">(</span><span class="n">all</span><span class="w"> </span><span class="mi">32</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">integers</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="o">-</span><span class="n">order</span><span class="p" data-group-id="9372405461-7">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIDX</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

   </span><span class="n">bitmap_pos</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="p" data-group-id="9372405461-8">(</span><span class="ow">in</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">order</span><span class="p" data-group-id="9372405461-8">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">pack</span><span class="w"> </span><span class="n">index</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">reachability</span><span class="w"> </span><span class="n">bitmap</span><span class="w"> </span><span class="n">occupied</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="w">

   </span><span class="n">bitmap_nr</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">positions</span><span class="w"> </span><span class="p" data-group-id="9372405461-9">(</span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">bitmap_pos</span><span class="p" data-group-id="9372405461-9">)</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">BTMP</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="p" data-group-id="9372405461-10">(</span><span class="k">with</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="err">“</span><span class="n">a</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="err">“</span><span class="n">b</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">“</span><span class="n">c</span><span class="err">”</span><span class="p" data-group-id="9372405461-10">)</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="ss">like</span><span class="p">:</span><span class="w">
   </span><span class="err">┌</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┬</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┐</span><span class="w">
   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">
   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="n">bitmap_pos</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">bitmap_nr</span><span class="w"> </span><span class="err">│</span><span class="w">
   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┤</span><span class="w">
   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">
   </span><span class="err">│</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="err">“</span><span class="n">a</span><span class="err">”</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="mi">10</span><span class="w">        </span><span class="err">│</span><span class="w">
   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┤</span><span class="w">
   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">
   </span><span class="err">│</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="err">“</span><span class="n">b</span><span class="err">”</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">10</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="mi">15</span><span class="w">        </span><span class="err">│</span><span class="w">
   </span><span class="err">├</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┼</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┤</span><span class="w">
   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">
   </span><span class="err">│</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="err">“</span><span class="n">c</span><span class="err">”</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">25</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="mi">20</span><span class="w">        </span><span class="err">│</span><span class="w">
   </span><span class="err">└</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┴</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┴</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">─</span><span class="err">┘</span><span class="w">

   </span><span class="nc">With</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">place</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">treat</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">packfile</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">individually</span><span class="w"> </span><span class="n">reusable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">fashion</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">verbatim</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">reuse</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">individual</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">implementation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">BTMP</span><span class="w"> </span><span class="n">chunk</span><span class="o">.</span></code></pre><p>CRUFT PACKS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">cruft</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">offer</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">alternative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">Git</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">traditional</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">removing</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">overview</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">Git</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">pruning</span><span class="w"> </span><span class="n">mechanism</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">a</span><span class="w">
   </span><span class="n">cruft</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">accomplish</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="o">.</span></code></pre><p>   Background</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">To</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">repository</span><span class="p">,</span><span class="w"> </span><span class="nc">Git</span><span class="w"> </span><span class="n">offers</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">repack</span><span class="w"> </span><span class="o">-</span><span class="nc">Ad</span><span class="w"> </span><span class="p" data-group-id="8513553830-1">(</span><span class="n">see</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">repack</span><span class="p" data-group-id="8513553830-2">(</span><span class="mi">1</span><span class="p" data-group-id="8513553830-2">)</span><span class="p" data-group-id="8513553830-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Quoting</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">documentation</span><span class="p">:</span><span class="w">

       </span><span class="p" data-group-id="8513553830-3">[</span><span class="n">...</span><span class="p" data-group-id="8513553830-3">]</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">loose</span><span class="p">,</span><span class="w"> </span><span class="n">unpacked</span><span class="w"> </span><span class="n">objects</span><span class="p">,</span><span class="w">
       </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="8513553830-4">[</span><span class="n">...</span><span class="p" data-group-id="8513553830-4">]</span><span class="w"> </span><span class="n">loose</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w">
       </span><span class="n">pruned</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">expiry</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="sc">&#39;git gc&#39;</span><span class="w"> </span><span class="n">invocation</span><span class="o">.</span><span class="w">

   </span><span class="nc">Unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">aren</span><span class="err">’</span><span class="n">t</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">immediately</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">doing</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">race</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">deleted</span><span class="o">.</span><span class="w"> </span><span class="nc">Instead</span><span class="p">,</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">unreachable</span><span class="w">
   </span><span class="n">objects</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">loose</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stay</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">expiration</span><span class="w"> </span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">prune</span><span class="p" data-group-id="8513553830-5">(</span><span class="mi">1</span><span class="p" data-group-id="8513553830-5">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Git</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">loose</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">object</span><span class="w"> </span><span class="n">mtimes</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">big</span><span class="w"> </span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">freshening</span><span class="w">
   </span><span class="n">that</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="p" data-group-id="8513553830-6">(</span><span class="n">because</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">written</span><span class="p" data-group-id="8513553830-6">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">mtime</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">updated</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">it</span><span class="w">
   </span><span class="n">would</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">expiration</span><span class="w"> </span><span class="n">window</span><span class="o">.</span><span class="w"> </span><span class="nc">Instead</span><span class="p">,</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">loose</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">individual</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">mtimes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">situation</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">cruft</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">are</span><span class="w">
   </span><span class="n">freshened</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">once</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">undesirable</span><span class="w"> </span><span class="n">situations</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">repository</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">yet</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">grace</span><span class="w"> </span><span class="n">period</span><span class="o">.</span><span class="w"> </span><span class="nc">Having</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">directories</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">shards</span><span class="w"> </span><span class="n">of</span><span class="w">
   </span><span class="o">.</span><span class="n">git</span><span class="o">/</span><span class="n">objects</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">decreased</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">repository</span><span class="o">.</span><span class="w"> </span><span class="nc">But</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">enough</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">lead</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">inode</span><span class="w"> </span><span class="n">starvation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">degrade</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w">
   </span><span class="n">system</span><span class="o">.</span><span class="w"> </span><span class="nc">Since</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">objects</span><span class="p">,</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">repositories</span><span class="w"> </span><span class="n">often</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">space</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">zlib</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="n">them</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="n">chains</span><span class="o">.</span></code></pre><p>   Cruft packs</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">cruft</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">eliminates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">storing</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loose</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">object</span><span class="w"> </span><span class="n">mtimes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">alongside</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">loose</span><span class="w">
   </span><span class="n">objects</span><span class="o">.</span><span class="w">

   </span><span class="nc">A</span><span class="w"> </span><span class="n">cruft</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">repack</span><span class="w"> </span><span class="o">--</span><span class="n">cruft</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">generating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">pack</span><span class="o">-</span><span class="n">objects</span><span class="p" data-group-id="4369868188-1">(</span><span class="mi">1</span><span class="p" data-group-id="4369868188-1">)</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="o">--</span><span class="n">cruft</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">repack</span><span class="w"> </span><span class="o">--</span><span class="n">cruft</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">classic</span><span class="w"> </span><span class="n">all</span><span class="o">-</span><span class="n">into</span><span class="o">-</span><span class="n">one</span><span class="w"> </span><span class="n">repack</span><span class="p">,</span><span class="w"> </span><span class="n">meaning</span><span class="w">
   </span><span class="n">that</span><span class="w"> </span><span class="n">everything</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resulting</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reachable</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">everything</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unreachable</span><span class="o">.</span><span class="w"> </span><span class="nc">Once</span><span class="w"> </span><span class="n">written</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">cruft</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">instructs</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">repack</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">only</span><span class="w">
   </span><span class="n">objects</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">packed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="p" data-group-id="4369868188-2">(</span><span class="n">which</span><span class="w"> </span><span class="n">equates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">packing</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">together</span><span class="p" data-group-id="4369868188-2">)</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">progresses</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

    </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="nc">Enumerate</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">object</span><span class="p">,</span><span class="w"> </span><span class="n">marking</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="p" data-group-id="4369868188-3">(</span><span class="n">a</span><span class="p" data-group-id="4369868188-3">)</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">kept</span><span class="o">-</span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p" data-group-id="4369868188-4">(</span><span class="n">b</span><span class="p" data-group-id="4369868188-4">)</span><span class="w"> </span><span class="n">whose</span><span class="w"> </span><span class="n">mtime</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">grace</span><span class="w"> </span><span class="n">period</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">traversal</span><span class="w"> </span><span class="n">tip</span><span class="o">.</span><span class="w">

    </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="nc">Perform</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reachability</span><span class="w"> </span><span class="n">traversal</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tips</span><span class="w"> </span><span class="n">gathered</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">step</span><span class="p">,</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w">

    </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="nc">Write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">.</span><span class="n">mtimes</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">records</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">object</span><span class="w"> </span><span class="n">timestamps</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="n">internally</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">repack</span><span class="p" data-group-id="4369868188-5">(</span><span class="mi">1</span><span class="p" data-group-id="4369868188-5">)</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">instructed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">cruft</span><span class="w"> </span><span class="n">pack</span><span class="o">.</span><span class="w"> </span><span class="nc">Crucially</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="ow">in</span><span class="o">-</span><span class="n">core</span><span class="w"> </span><span class="n">kept</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packs</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">deleted</span><span class="w">
   </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">repack</span><span class="p">;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">words</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">repository</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="n">reachable</span><span class="w"> </span><span class="n">objects</span><span class="o">.</span><span class="w">

   </span><span class="nc">When</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">repository</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">cruft</span><span class="w"> </span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">repack</span><span class="w"> </span><span class="o">--</span><span class="n">cruft</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">adds</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w"> </span><span class="nc">An</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">repack</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">cruft</span><span class="o">-</span><span class="n">expiration</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w">
   </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">cruft</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">omit</span><span class="w"> </span><span class="n">expired</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">waiting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">gc</span><span class="p" data-group-id="4369868188-6">(</span><span class="mi">1</span><span class="p" data-group-id="4369868188-6">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">expire</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">on</span><span class="o">.</span><span class="w">

   </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">gc</span><span class="p" data-group-id="4369868188-7">(</span><span class="mi">1</span><span class="p" data-group-id="4369868188-7">)</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">responsible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">removing</span><span class="w"> </span><span class="n">expired</span><span class="w"> </span><span class="n">unreachable</span><span class="w"> </span><span class="n">objects</span><span class="o">.</span></code></pre><p>   Alternatives</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Notable</span><span class="w"> </span><span class="n">alternatives</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">design</span><span class="w"> </span><span class="ss">include</span><span class="p">:</span><span class="w">

   </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">object</span><span class="w"> </span><span class="n">mtime</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">mtime</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">auxiliary</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">tied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">chosen</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">complicating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">.</span><span class="n">idx</span><span class="w"> </span><span class="n">format</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">.</span><span class="n">idx</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">ever</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">gain</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">chunks</span><span class="w">
   </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sense</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">consolidate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">.</span><span class="n">mtimes</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">.</span><span class="n">idx</span><span class="w"> </span><span class="n">itself</span><span class="o">.</span></code></pre><p>GIT</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">git</span><span class="p" data-group-id="1830991493-1">(</span><span class="mi">1</span><span class="p" data-group-id="1830991493-1">)</span><span class="w"> </span><span class="n">suite</span></code></pre><p>Git 2.47.2                                                                                06/22/2025                                                                         GITFORMAT-PACK(5)</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="gitformat-index.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
gitformat-index
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="gitformat-signature.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
gitformat-signature
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
