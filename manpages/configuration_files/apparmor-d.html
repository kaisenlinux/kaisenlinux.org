<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.4">
    <meta name="project" content="Manpages v2.3.0">

    <title>apparmor.d â€” Manpages v2.3.0</title>
    <link rel="stylesheet" href="dist/html-elixir-HHVY3JYD.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-XWGFFSCD.js"></script>
    <script src="dist/sidebar_items-357E47FD.js"></script>

      <script src="doc-versions.js"></script>

    <script async src="dist/html-JDI3AVDD.js"></script>

<link rel="stylesheet" href="assets/doc.css">
  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="https://kaisenlinux.org/manpages/">
        <img src="assets/logo.jpg" alt="Manpages" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectName" translate="no">
Manpages
      </a>
      <div class="sidebar-projectVersion" translate="no">
        v2.3.0
      </div>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">MANUALS</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="icon-action display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>



  <span>apparmor.d</span>
</h1>

<p>APPARMOR.D(5)                                                                            AppArmor                                                                            APPARMOR.D(5)</p><p>NAME</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">AppArmor</span><span class="o">.</span></code></pre><p>DESCRIPTION</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">describe</span><span class="w"> </span><span class="n">mandatory</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">rights</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">fed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">enforcement</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">apparmor_parser</span><span class="p" data-group-id="1057769915-1">(</span><span class="mi">8</span><span class="p" data-group-id="1057769915-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">man</span><span class="w"> </span><span class="n">page</span><span class="w">
   </span><span class="n">describes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">apparmor</span><span class="p" data-group-id="1057769915-2">(</span><span class="mi">7</span><span class="p" data-group-id="1057769915-2">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">overview</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">AppArmor</span><span class="o">.</span><span class="w">

   </span><span class="nc">Some</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Debian</span><span class="w"> </span><span class="ss">yet</span><span class="p">:</span><span class="w">

   </span><span class="nc">Network</span><span class="w"> </span><span class="nc">Rules</span><span class="w">
   </span><span class="nc">DBus</span><span class="w"> </span><span class="n">rules</span><span class="w">
   </span><span class="nc">Unix</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">rules</span></code></pre><p>FORMAT</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">declarative</span><span class="w"> </span><span class="n">language</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">matter</span><span class="o">.</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">convention</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w">
   </span><span class="n">contained</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">requirement</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">easily</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">language</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">architecture</span><span class="w"> </span><span class="n">independent</span><span class="w">
   </span><span class="n">binary</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">enforcement</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">confinement</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">enforced</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">program</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">profile</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">whitelist</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">allowed</span><span class="p">,</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">few</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">sections</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">preamble</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">definitions</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">preamble</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">occur</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">definitions</span><span class="w">
   </span><span class="n">begin</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">preamble</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="p" data-group-id="5971386978-1">(</span><span class="n">even</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="p" data-group-id="5971386978-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="p" data-group-id="5971386978-2">(</span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">profiles</span><span class="p" data-group-id="5971386978-2">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">can</span><span class="w">
   </span><span class="n">have</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">preamble</span><span class="w"> </span><span class="n">section</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">preamble</span><span class="o">.</span><span class="w"> </span><span class="nc">Files</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">preamble</span><span class="w"> </span><span class="n">section</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">BNF</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">line</span><span class="o">-</span><span class="n">oriented</span><span class="p">;</span><span class="w"> </span><span class="c1">#</span><span class="w">
   </span><span class="n">introduces</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comment</span><span class="p">,</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">scripting</span><span class="w"> </span><span class="n">languages</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="c1">#include will include the contents of a file inline to the policy; this behaviour is</span><span class="w">
   </span><span class="n">modelled</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">cpp</span><span class="p" data-group-id="5971386978-3">(</span><span class="mi">1</span><span class="p" data-group-id="5971386978-3">)</span><span class="o">.</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-4">(</span><span class="w"> </span><span class="p" data-group-id="5971386978-5">[</span><span class="w"> </span><span class="nc">PREAMBLE</span><span class="w"> </span><span class="p" data-group-id="5971386978-5">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-6">[</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="p" data-group-id="5971386978-6">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-4">)</span><span class="o">*</span><span class="w">

       </span><span class="nc">PREAMBLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-7">(</span><span class="w"> </span><span class="nc">COMMENT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">VARIABLE</span><span class="w"> </span><span class="nc">ASSIGNMENT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">ALIAS</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">INCLUDE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">ABI</span><span class="w"> </span><span class="p" data-group-id="5971386978-7">)</span><span class="o">*</span><span class="w">
         </span><span class="nc">Variable</span><span class="w"> </span><span class="n">assignment</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">come</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w">

       </span><span class="nc">VARIABLE</span><span class="w"> </span><span class="nc">ASSIGNMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">VARIABLE</span><span class="w"> </span><span class="p" data-group-id="5971386978-8">(</span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;+=&#39;</span><span class="p" data-group-id="5971386978-8">)</span><span class="w"> </span><span class="p" data-group-id="5971386978-9">(</span><span class="n">space</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">values</span><span class="p" data-group-id="5971386978-9">)</span><span class="w">

       </span><span class="nc">VARIABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;@{&#39;</span><span class="w"> </span><span class="nc">ALPHA</span><span class="w"> </span><span class="p" data-group-id="5971386978-10">[</span><span class="w"> </span><span class="p" data-group-id="5971386978-11">(</span><span class="w"> </span><span class="nc">ALPHANUMERIC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;_&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-11">)</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="p" data-group-id="5971386978-10">]</span><span class="w"> </span><span class="sc">&#39;}&#39;</span><span class="w">

       </span><span class="nc">ALIAS</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;alias&#39;</span><span class="w"> </span><span class="nc">ABS</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="sc">&#39;-&gt;&#39;</span><span class="w"> </span><span class="nc">REWRITTEN</span><span class="w"> </span><span class="nc">ABS</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="sc">&#39;,&#39;</span><span class="w">

       </span><span class="nc">INCLUDE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-12">(</span><span class="w"> </span><span class="sc">&#39;#include&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;include&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-12">)</span><span class="w"> </span><span class="p" data-group-id="5971386978-13">[</span><span class="w"> </span><span class="sc">&#39;if exists&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-13">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-14">(</span><span class="w"> </span><span class="nc">ABS</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">MAGIC</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="p" data-group-id="5971386978-14">)</span><span class="w">

       </span><span class="nc">ABI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-15">(</span><span class="w"> </span><span class="sc">&#39;abi&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-15">)</span><span class="w"> </span><span class="p" data-group-id="5971386978-16">(</span><span class="w"> </span><span class="nc">ABS</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">MAGIC</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="p" data-group-id="5971386978-16">)</span><span class="w"> </span><span class="sc">&#39;,&#39;</span><span class="w">

       </span><span class="nc">ABS</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-17">(</span><span class="n">the</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="5971386978-18">(</span><span class="mi">2</span><span class="p" data-group-id="5971386978-18">)</span><span class="p" data-group-id="5971386978-17">)</span><span class="w">

       </span><span class="nc">MAGIC</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;&lt;&#39;</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="sc">&#39;&gt;&#39;</span><span class="w">
         </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="o">.</span><span class="w">

       </span><span class="nc">COMMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="w"> </span><span class="nc">TEXT</span><span class="w"> </span><span class="p" data-group-id="5971386978-19">[</span><span class="w"> </span><span class="sc">&#39;</span><span class="se">\r</span><span class="sc">&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-19">]</span><span class="w"> </span><span class="sc">&#39;</span><span class="se">\n</span><span class="sc">&#39;</span><span class="w">

       </span><span class="nc">TEXT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">characters</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-20">(</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">HEAD</span><span class="w"> </span><span class="p" data-group-id="5971386978-20">)</span><span class="w"> </span><span class="p" data-group-id="5971386978-21">[</span><span class="w"> </span><span class="nc">ATTACHMENT</span><span class="w"> </span><span class="nc">SPECIFICATION</span><span class="w"> </span><span class="p" data-group-id="5971386978-21">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-22">[</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">FLAG</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="p" data-group-id="5971386978-22">]</span><span class="w"> </span><span class="sc">&#39;{&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-23">(</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="p" data-group-id="5971386978-23">)</span><span class="o">*</span><span class="w"> </span><span class="sc">&#39;}&#39;</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">HEAD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-24">[</span><span class="w"> </span><span class="sc">&#39;profile&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-24">]</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;profile&#39;</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-25">(</span><span class="w"> </span><span class="nc">UNQUOTED</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">QUOTED</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-25">)</span><span class="w">

       </span><span class="nc">QUOTED</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">UNQUOTED</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w">

       </span><span class="nc">UNQUOTED</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-26">(</span><span class="n">must</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">alphanumeric</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="p" data-group-id="5971386978-27">(</span><span class="k">after</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">expansion</span><span class="p" data-group-id="5971386978-27">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">meanings</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w"> </span><span class="nc">May</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="nc">VARIABLE</span><span class="o">.</span><span class="w"> </span><span class="nc">Rules</span><span class="w"> </span><span class="k">with</span><span class="w">
       </span><span class="n">embedded</span><span class="w"> </span><span class="n">spaces</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tabs</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">quoted</span><span class="o">.</span><span class="p" data-group-id="5971386978-26">)</span><span class="w">

       </span><span class="nc">ATTACHMENT</span><span class="w"> </span><span class="nc">SPECIFICATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-28">[</span><span class="w"> </span><span class="nc">PROFILE_EXEC_COND</span><span class="w"> </span><span class="p" data-group-id="5971386978-28">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-29">[</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">XATTR</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="p" data-group-id="5971386978-29">]</span><span class="w">

       </span><span class="nc">PROFILE_EXEC_COND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">XATTR</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p" data-group-id="5971386978-30">[</span><span class="w"> </span><span class="sc">&#39;xattrs=&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-30">]</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="n">comma</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">XATTR</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">XATTR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extended</span><span class="w"> </span><span class="n">attribute</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="nc">XATTR</span><span class="w"> </span><span class="nc">VALUE</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">XATTR</span><span class="w"> </span><span class="nc">VALUE</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">FLAG</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p" data-group-id="5971386978-31">[</span><span class="w"> </span><span class="sc">&#39;flags=&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-31">]</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="n">comma</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">FLAGS</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">FLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">MODE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AUDIT_MODE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;mediate_deleted&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;attach_disconnected&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;chroot_relative&#39;</span><span class="w">

       </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;enforce&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;complain&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;kill&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;unconfined&#39;</span><span class="w">

       </span><span class="nc">AUDIT</span><span class="w"> </span><span class="nc">MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;audit&#39;</span><span class="w">

       </span><span class="nc">RULES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-32">[</span><span class="w"> </span><span class="p" data-group-id="5971386978-33">(</span><span class="w"> </span><span class="nc">LINE</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">COMMA</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="sc">&#39;,&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">BLOCK</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="p" data-group-id="5971386978-33">)</span><span class="w">

       </span><span class="nc">LINE</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-34">(</span><span class="w"> </span><span class="nc">COMMENT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">INCLUDE</span><span class="w"> </span><span class="p" data-group-id="5971386978-34">)</span><span class="w"> </span><span class="p" data-group-id="5971386978-35">[</span><span class="w"> </span><span class="sc">&#39;</span><span class="se">\r</span><span class="sc">&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-35">]</span><span class="w"> </span><span class="sc">&#39;</span><span class="se">\n</span><span class="sc">&#39;</span><span class="w">

       </span><span class="nc">COMMA</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-36">(</span><span class="w"> </span><span class="nc">CAPABILITY</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">NETWORK</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">PIVOT</span><span class="w"> </span><span class="nc">ROOT</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">FILE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">LINK</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">CHANGE_PROFILE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="p" data-group-id="5971386978-36">)</span><span class="w">

       </span><span class="nc">BLOCK</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-37">(</span><span class="w"> </span><span class="nc">SUBPROFILE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">HAT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">QUALIFIER</span><span class="w"> </span><span class="nc">BLOCK</span><span class="w"> </span><span class="p" data-group-id="5971386978-37">)</span><span class="w">

       </span><span class="nc">SUBPROFILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;profile&#39;</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-38">[</span><span class="w"> </span><span class="nc">ATTACHMENT</span><span class="w"> </span><span class="nc">SPECIFICATION</span><span class="w"> </span><span class="p" data-group-id="5971386978-38">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-39">[</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">FLAG</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="p" data-group-id="5971386978-39">]</span><span class="w"> </span><span class="sc">&#39;{&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-40">(</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="p" data-group-id="5971386978-40">)</span><span class="o">*</span><span class="w"> </span><span class="sc">&#39;}&#39;</span><span class="w">

       </span><span class="nc">HAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-41">(</span><span class="sc">&#39;hat&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;^&#39;</span><span class="p" data-group-id="5971386978-41">)</span><span class="w"> </span><span class="nc">HATNAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-42">[</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">FLAG</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="p" data-group-id="5971386978-42">]</span><span class="w"> </span><span class="sc">&#39;{&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-43">(</span><span class="w"> </span><span class="nc">RULES</span><span class="w"> </span><span class="p" data-group-id="5971386978-43">)</span><span class="o">*</span><span class="w"> </span><span class="sc">&#39;}&#39;</span><span class="w">

       </span><span class="nc">HATNAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-44">(</span><span class="n">must</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">alphanumeric</span><span class="w"> </span><span class="n">character</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">aa_change_hat</span><span class="p" data-group-id="5971386978-45">(</span><span class="mi">2</span><span class="p" data-group-id="5971386978-45">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="s">&quot;hat&quot;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="sc">&#39;^&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hat</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">space</span><span class="w">
       </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;^&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HATNAME</span><span class="p" data-group-id="5971386978-44">)</span><span class="w">

       </span><span class="nc">QUALIFIER</span><span class="w"> </span><span class="nc">BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="nc">BLOCK</span><span class="w">

       </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-46">(</span><span class="w"> </span><span class="sc">&#39;allow&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;deny&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-46">)</span><span class="w">

       </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-47">[</span><span class="w"> </span><span class="sc">&#39;audit&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-47">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-48">[</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">TYPE</span><span class="w"> </span><span class="p" data-group-id="5971386978-48">]</span><span class="w">

       </span><span class="nc">CAPABILITY</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-49">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-49">]</span><span class="w"> </span><span class="sc">&#39;capability&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-50">[</span><span class="w"> </span><span class="nc">CAPABILITY</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="p" data-group-id="5971386978-50">]</span><span class="w">

       </span><span class="nc">CAPABILITY</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-51">(</span><span class="w"> </span><span class="nc">CAPABILITY</span><span class="w"> </span><span class="p" data-group-id="5971386978-51">)</span><span class="o">+</span><span class="w">

       </span><span class="nc">CAPABILITY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-52">(</span><span class="n">lowercase</span><span class="w"> </span><span class="n">capability</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="sc">&#39;CAP_&#39;</span><span class="w"> </span><span class="n">prefix</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">capabilities</span><span class="p" data-group-id="5971386978-53">(</span><span class="mi">7</span><span class="p" data-group-id="5971386978-53">)</span><span class="p" data-group-id="5971386978-52">)</span><span class="w">

       </span><span class="nc">NETWORK</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-54">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-54">]</span><span class="w"> </span><span class="sc">&#39;network&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-55">[</span><span class="w"> </span><span class="nc">DOMAIN</span><span class="w"> </span><span class="p" data-group-id="5971386978-55">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-56">[</span><span class="w"> </span><span class="nc">TYPE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">PROTOCOL</span><span class="w"> </span><span class="p" data-group-id="5971386978-56">]</span><span class="w">

       </span><span class="nc">DOMAIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-57">(</span><span class="w"> </span><span class="sc">&#39;unix&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;inet&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ax25&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ipx&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;appletalk&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;netrom&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;bridge&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;atmpvc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;x25&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;inet6&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rose&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;netbeui&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;security&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;key&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;netlink&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;packet&#39;</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="sc">&#39;ash&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;econet&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;atmsvc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rds&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;sna&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;irda&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;pppox&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;wanpipe&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;llc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ib&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;mpls&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;can&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;tipc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;bluetooth&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;iucv&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rxrpc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;isdn&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;phonet&#39;</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="sc">&#39;ieee802154&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;caif&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;alg&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nfc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;vsock&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;kcm&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;qipcrtr&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;smc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;xdp&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;mctp&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-57">)</span><span class="w"> </span><span class="sc">&#39;,&#39;</span><span class="w">

       </span><span class="nc">TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-58">(</span><span class="w"> </span><span class="sc">&#39;stream&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;dgram&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;seqpacket&#39;</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="sc">&#39;rdm&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;raw&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;packet&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-58">)</span><span class="w">

       </span><span class="nc">PROTOCOL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-59">(</span><span class="w"> </span><span class="sc">&#39;tcp&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;udp&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;icmp&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-59">)</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-60">(</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">REMOUNT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UMOUNT</span><span class="w"> </span><span class="p" data-group-id="5971386978-60">)</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-61">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-61">]</span><span class="w"> </span><span class="sc">&#39;mount&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-62">[</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">CONDITIONS</span><span class="w"> </span><span class="p" data-group-id="5971386978-62">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-63">[</span><span class="w"> </span><span class="nc">SOURCE</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="p" data-group-id="5971386978-63">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-64">[</span><span class="w"> </span><span class="sc">&#39;-&gt;&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-65">[</span><span class="w"> </span><span class="nc">MOUNTPOINT</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="p" data-group-id="5971386978-65">]</span><span class="w">

       </span><span class="nc">REMOUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-66">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-66">]</span><span class="w"> </span><span class="sc">&#39;remount&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-67">[</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">CONDITIONS</span><span class="w"> </span><span class="p" data-group-id="5971386978-67">]</span><span class="w"> </span><span class="nc">MOUNTPOINT</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">UMOUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-68">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-68">]</span><span class="w"> </span><span class="sc">&#39;umount&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-69">[</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">CONDITIONS</span><span class="w"> </span><span class="p" data-group-id="5971386978-69">]</span><span class="w"> </span><span class="nc">MOUNTPOINT</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">CONDITIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-70">[</span><span class="w"> </span><span class="p" data-group-id="5971386978-71">(</span><span class="w"> </span><span class="sc">&#39;fstype&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;vfstype&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-71">)</span><span class="w"> </span><span class="p" data-group-id="5971386978-72">(</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;in&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-72">)</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FSTYPE</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-70">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-73">[</span><span class="w"> </span><span class="sc">&#39;options&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-74">(</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;in&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-74">)</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FLAGS</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-73">]</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FSTYPE</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-75">(</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FSTYPE</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-75">)</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FSTYPE</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Comma</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="p" data-group-id="5971386978-76">(</span><span class="n">eg</span><span class="w"> </span><span class="n">ext4</span><span class="p">,</span><span class="w"> </span><span class="n">debugfs</span><span class="p">,</span><span class="w"> </span><span class="n">devfs</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="p" data-group-id="5971386978-76">)</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FLAGS</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-77">(</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FLAGS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-77">)</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FLAGS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Comma</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FLAGS</span><span class="o">.</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">FLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-78">(</span><span class="w"> </span><span class="sc">&#39;ro&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nosuid&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;suid&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nodev&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;dev&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;noexec&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;exec&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;sync&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;async&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;remount&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;mand&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nomand&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;dirsync&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;noatime&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;atime&#39;</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="sc">&#39;nodiratime&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;diratime&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;bind&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rbind&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;move&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;verbose&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;silent&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;loud&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;acl&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;noacl&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;unbindable&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;runbindable&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;private&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rprivate&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;slave&#39;</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="sc">&#39;rslave&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;shared&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rshared&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;relatime&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;norelatime&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;iversion&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;noiversion&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;strictatime&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nouser&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;user&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-78">)</span><span class="w">

       </span><span class="nc">MOUNT</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-79">(</span><span class="w"> </span><span class="nc">ALPHANUMERIC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="p" data-group-id="5971386978-79">)</span><span class="w"> </span><span class="n">...</span><span class="w">

       </span><span class="nc">PIVOT</span><span class="w"> </span><span class="nc">ROOT</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-80">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-80">]</span><span class="w"> </span><span class="n">pivot_root</span><span class="w"> </span><span class="p" data-group-id="5971386978-81">[</span><span class="w"> </span><span class="n">oldroot</span><span class="o">=</span><span class="nc">OLD</span><span class="w"> </span><span class="nc">PUT</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="p" data-group-id="5971386978-81">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-82">[</span><span class="w"> </span><span class="nc">NEW</span><span class="w"> </span><span class="nc">ROOT</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="p" data-group-id="5971386978-82">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-83">[</span><span class="w"> </span><span class="sc">&#39;-&gt;&#39;</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-83">]</span><span class="w">

       </span><span class="nc">SOURCE</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">MOUNTPOINT</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">OLD</span><span class="w"> </span><span class="nc">PUT</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">PTRACE_RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-84">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-84">]</span><span class="w"> </span><span class="sc">&#39;ptrace&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-85">[</span><span class="w"> </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">PERMISSIONS</span><span class="w"> </span><span class="p" data-group-id="5971386978-85">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-86">[</span><span class="w"> </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="p" data-group-id="5971386978-86">]</span><span class="w">

       </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">PERMISSIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w">

       </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="nc">Comma</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-87">(</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;w&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;read&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;readby&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;trace&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;tracedby&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-87">)</span><span class="w">

       </span><span class="nc">PTRACE</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;peer&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w">

       </span><span class="nc">SIGNAL_RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-88">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-88">]</span><span class="w"> </span><span class="sc">&#39;signal&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-89">[</span><span class="w"> </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">PERMISSIONS</span><span class="w"> </span><span class="p" data-group-id="5971386978-89">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-90">[</span><span class="w"> </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">SET</span><span class="w"> </span><span class="p" data-group-id="5971386978-90">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-91">[</span><span class="w"> </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="p" data-group-id="5971386978-91">]</span><span class="w">

       </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">PERMISSIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w">

       </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="nc">Comma</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-92">(</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;w&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;read&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;write&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;send&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;receive&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-92">)</span><span class="w">

       </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;set&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Comma</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">SIGNALS</span><span class="w">

       </span><span class="nc">SIGNALS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-93">(</span><span class="w"> </span><span class="sc">&#39;hup&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;int&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;quit&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ill&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;trap&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;abrt&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;bus&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;fpe&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;kill&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;usr1&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;segv&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;usr2&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;pipe&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;alrm&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;term&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;stkflt&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;chld&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;cont&#39;</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="sc">&#39;stop&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;stp&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ttin&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ttou&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;urg&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;xcpu&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;xfsz&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;vtalrm&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;prof&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;winch&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;io&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;pwr&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;sys&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;emt&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;exists&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rtmin+0&#39;</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="sc">&#39;rtmin+32&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-93">)</span><span class="w">

       </span><span class="nc">SIGNAL</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;peer&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-94">(</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">MESSAGE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">SERVICE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">EAVESDROP</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">COMBINED</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="p" data-group-id="5971386978-94">)</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">MESSAGE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-95">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-95">]</span><span class="w"> </span><span class="sc">&#39;dbus&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-96">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-96">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-97">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">BUS</span><span class="w"> </span><span class="p" data-group-id="5971386978-97">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-98">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="p" data-group-id="5971386978-98">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-99">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">INTERFACE</span><span class="w"> </span><span class="p" data-group-id="5971386978-99">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-100">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">MEMBER</span><span class="w"> </span><span class="p" data-group-id="5971386978-100">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-101">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="p" data-group-id="5971386978-101">]</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">SERVICE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-102">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-102">]</span><span class="w"> </span><span class="sc">&#39;dbus&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-103">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-103">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-104">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">BUS</span><span class="w"> </span><span class="p" data-group-id="5971386978-104">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-105">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-105">]</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">EAVESDROP</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-106">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-106">]</span><span class="w"> </span><span class="sc">&#39;dbus&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-107">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-107">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-108">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">BUS</span><span class="w"> </span><span class="p" data-group-id="5971386978-108">]</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">COMBINED</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-109">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-109">]</span><span class="w"> </span><span class="sc">&#39;dbus&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-110">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="p" data-group-id="5971386978-110">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-111">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">BUS</span><span class="w"> </span><span class="p" data-group-id="5971386978-111">]</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">EXPRESSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-112">(</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-112">)</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">BUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;bus&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;system&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;session&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">PATH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;path&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">INTERFACE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;interface&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">MEMBER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;member&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;peer&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-113">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-113">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-114">[</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">LABEL</span><span class="w"> </span><span class="p" data-group-id="5971386978-114">]</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;name&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">LABEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;label&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Comma</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w">

       </span><span class="nc">DBUS</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-115">(</span><span class="w"> </span><span class="sc">&#39;send&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;receive&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;bind&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;eavesdrop&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;read&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;w&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;write&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-115">)</span><span class="w">
         </span><span class="nc">Some</span><span class="w"> </span><span class="n">accesses</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">incompatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">rules</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w">

       </span><span class="nc">AARE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">?*</span><span class="p" data-group-id="5971386978-116">[</span><span class="p" data-group-id="5971386978-116">]</span><span class="p" data-group-id="5971386978-117">{</span><span class="p" data-group-id="5971386978-117">}</span><span class="o">^</span><span class="w">
         </span><span class="nc">See</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">meanings</span><span class="o">.</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-118">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-118">]</span><span class="w"> </span><span class="sc">&#39;unix&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-119">[</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">EXPR</span><span class="w"> </span><span class="p" data-group-id="5971386978-119">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-120">[</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="p" data-group-id="5971386978-120">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-121">[</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">LOCAL</span><span class="w"> </span><span class="nc">EXPR</span><span class="w"> </span><span class="p" data-group-id="5971386978-121">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-122">[</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="nc">EXPR</span><span class="w"> </span><span class="p" data-group-id="5971386978-122">]</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">EXPR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-123">(</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="p" data-group-id="5971386978-123">)</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-124">(</span><span class="w"> </span><span class="sc">&#39;create&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;bind&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;listen&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;accept&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;connect&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;shutdown&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;getattr&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;setattr&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;getopt&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;setopt&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;send&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;receive&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;w&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-124">)</span><span class="w">
         </span><span class="nc">Some</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">incompatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">parameters</span><span class="o">.</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="p" data-group-id="5971386978-125">(</span><span class="w"> </span><span class="p" data-group-id="5971386978-126">[</span><span class="sc">&#39;,&#39;</span><span class="p" data-group-id="5971386978-126">]</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="p" data-group-id="5971386978-125">)</span><span class="o">*</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="nc">CONDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-127">(</span><span class="w"> </span><span class="nc">TYPE</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">PROTO</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="p" data-group-id="5971386978-127">)</span><span class="w">
         </span><span class="nc">Each</span><span class="w"> </span><span class="k">cond</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">once</span><span class="o">.</span><span class="w">

       </span><span class="nc">TYPE</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;type&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w">  </span><span class="p" data-group-id="5971386978-128">(</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-129">(</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="p" data-group-id="5971386978-129">)</span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-128">)</span><span class="w">

       </span><span class="nc">PROTO</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;protocol&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w">  </span><span class="p" data-group-id="5971386978-130">(</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-131">(</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="p" data-group-id="5971386978-131">)</span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-130">)</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">LOCAL</span><span class="w"> </span><span class="nc">EXPR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-132">(</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ADDRESS</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">LABEL</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ATTR</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">OPT</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="p" data-group-id="5971386978-132">)</span><span class="o">*</span><span class="w">
         </span><span class="nc">Each</span><span class="w"> </span><span class="k">cond</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">once</span><span class="o">.</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">PEER</span><span class="w"> </span><span class="nc">EXPR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;peer&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-133">(</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ADDRESS</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">LABEL</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="p" data-group-id="5971386978-133">)</span><span class="o">+</span><span class="w">
         </span><span class="nc">Each</span><span class="w"> </span><span class="k">cond</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">once</span><span class="o">.</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ADDRESS</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="sc">&#39;addr&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-134">(</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-134">)</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">LABEL</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="sc">&#39;label&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-135">(</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-135">)</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">ATTR</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="sc">&#39;attr&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-136">(</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-136">)</span><span class="w">

       </span><span class="nc">UNIX</span><span class="w"> </span><span class="nc">OPT</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="sc">&#39;opt&#39;</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-137">(</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-137">)</span><span class="w">

       </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;set&#39;</span><span class="w"> </span><span class="sc">&#39;rlimit&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-138">[</span><span class="nc">RLIMIT</span><span class="w"> </span><span class="sc">&#39;&lt;=&#39;</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">VALUE</span><span class="w"> </span><span class="p" data-group-id="5971386978-138">]</span><span class="w">

       </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-139">(</span><span class="w"> </span><span class="sc">&#39;cpu&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;fsize&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;data&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;stack&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;core&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rss&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nofile&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ofile&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;as&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nproc&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;memlock&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;locks&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;sigpending&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;msgqueue&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;nice&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;rtprio&#39;</span><span class="w"> </span><span class="o">|</span><span class="w">
       </span><span class="sc">&#39;rttime&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-139">)</span><span class="w">

       </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">VALUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-140">(</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">SIZE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">NUMBER</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">TIME</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">NICE</span><span class="w"> </span><span class="p" data-group-id="5971386978-140">)</span><span class="w">

       </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">NUMBER</span><span class="w"> </span><span class="p" data-group-id="5971386978-141">(</span><span class="w"> </span><span class="sc">&#39;K&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;M&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;G&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-141">)</span><span class="w">
         </span><span class="nc">Only</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;fsize&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;stack&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;core&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;rss&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;as&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;memlock&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;msgqueue&#39;</span><span class="o">.</span><span class="w">

       </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">NUMBER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">
         </span><span class="nc">Only</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;ofile&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;nofile&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;locks&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;sigpending&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;nproc&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;rtprio&#39;</span><span class="o">.</span><span class="w">

       </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">TIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">NUMBER</span><span class="w"> </span><span class="p" data-group-id="5971386978-142">(</span><span class="w"> </span><span class="sc">&#39;us&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;microsecond&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;microseconds&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ms&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;millisecond&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;milliseconds&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;s&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;sec&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;second&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;seconds&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;min&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;minute&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;minutes&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;h&#39;</span><span class="w">
       </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;hour&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;hours&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;d&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;day&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;days&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;week&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;weeks&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-142">)</span><span class="w">
         </span><span class="nc">Only</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;cpu&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;rttime&#39;</span><span class="o">.</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="sc">&#39;cpu&#39;</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="sc">&#39;seconds&#39;</span><span class="o">.</span><span class="w">

       </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="nc">NICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">19</span><span class="o">.</span><span class="w">
         </span><span class="nc">Only</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">RLIMIT</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;nice&#39;</span><span class="o">.</span><span class="w">

       </span><span class="nc">FILE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-143">[</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-143">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-144">[</span><span class="w"> </span><span class="sc">&#39;owner&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-144">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-145">(</span><span class="w"> </span><span class="sc">&#39;file&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="5971386978-146">[</span><span class="w"> </span><span class="sc">&#39;file&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-146">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-147">(</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nc">ACCESS</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="p" data-group-id="5971386978-147">)</span><span class="w"> </span><span class="p" data-group-id="5971386978-148">[</span><span class="w"> </span><span class="sc">&#39;-&gt;&#39;</span><span class="w"> </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">TARGET</span><span class="w"> </span><span class="p" data-group-id="5971386978-148">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-145">)</span><span class="w">

       </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-149">(</span><span class="w"> </span><span class="nc">QUOTED</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">UNQUOTED</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="p" data-group-id="5971386978-149">)</span><span class="w">

       </span><span class="nc">QUOTED</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="nc">UNQUOTED</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="w">

       </span><span class="nc">UNQUOTED</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-150">(</span><span class="n">must</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-151">(</span><span class="k">after</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">expansion</span><span class="p" data-group-id="5971386978-151">)</span><span class="p">,</span><span class="w"> </span><span class="nc">AARE</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">meanings</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w"> </span><span class="nc">May</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="nc">VARIABLE</span><span class="o">.</span><span class="w"> </span><span class="nc">Rules</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">embedded</span><span class="w"> </span><span class="n">spaces</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tabs</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w">
       </span><span class="n">quoted</span><span class="o">.</span><span class="w"> </span><span class="nc">Rules</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">directories</span><span class="o">.</span><span class="p" data-group-id="5971386978-150">)</span><span class="w">

       </span><span class="nc">ACCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-152">(</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;w&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;k&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;m&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">TRANSITION</span><span class="w"> </span><span class="p" data-group-id="5971386978-152">)</span><span class="o">+</span><span class="w">  </span><span class="p" data-group-id="5971386978-153">(</span><span class="ow">not</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">combinations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">allowed</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="p" data-group-id="5971386978-153">)</span><span class="w">

       </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">TRANSITION</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p" data-group-id="5971386978-154">(</span><span class="w"> </span><span class="sc">&#39;ix&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;ux&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;Ux&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;px&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;Px&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;cx&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;Cx&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;pix&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;Pix&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;cix&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;Cix&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;pux&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;PUx&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;cux&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;CUx&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;x&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-154">)</span><span class="w">
         </span><span class="nc">A</span><span class="w"> </span><span class="n">bare</span><span class="w"> </span><span class="sc">&#39;x&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">qualifier</span><span class="p">,</span><span class="w"> </span><span class="n">everything</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">qualifier</span><span class="o">.</span><span class="w">

       </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">TARGET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w">
         </span><span class="nc">Requires</span><span class="w"> </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">TRANSITION</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">

       </span><span class="nc">LINK</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">QUALIFIERS</span><span class="w"> </span><span class="p" data-group-id="5971386978-155">[</span><span class="w"> </span><span class="sc">&#39;owner&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-155">]</span><span class="w"> </span><span class="sc">&#39;link&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-156">[</span><span class="w"> </span><span class="sc">&#39;subset&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-156">]</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w"> </span><span class="sc">&#39;-&gt;&#39;</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

       </span><span class="nc">ALPHA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-157">(</span><span class="sc">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="sc">&#39;z&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="sc">&#39;Z&#39;</span><span class="p" data-group-id="5971386978-157">)</span><span class="w">

       </span><span class="nc">ALPHANUMERIC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-158">(</span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="sc">&#39;9&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="sc">&#39;z&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="sc">&#39;Z&#39;</span><span class="p" data-group-id="5971386978-158">)</span><span class="w">

       </span><span class="nc">CHANGE_PROFILE</span><span class="w"> </span><span class="nc">RULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;change_profile&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-159">[</span><span class="w"> </span><span class="p" data-group-id="5971386978-160">[</span><span class="w"> </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">MODE</span><span class="w"> </span><span class="p" data-group-id="5971386978-160">]</span><span class="w"> </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="p" data-group-id="5971386978-159">]</span><span class="w"> </span><span class="p" data-group-id="5971386978-161">[</span><span class="w"> </span><span class="sc">&#39;-&gt;&#39;</span><span class="w"> </span><span class="nc">PROFILE</span><span class="w"> </span><span class="nc">NAME</span><span class="w"> </span><span class="p" data-group-id="5971386978-161">]</span><span class="w">

       </span><span class="nc">EXEC_MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5971386978-162">(</span><span class="w"> </span><span class="sc">&#39;safe&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="sc">&#39;unsafe&#39;</span><span class="w"> </span><span class="p" data-group-id="5971386978-162">)</span><span class="w">

       </span><span class="nc">EXEC</span><span class="w"> </span><span class="nc">COND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">FILEGLOB</span><span class="w">

   </span><span class="nc">All</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">subprofiles</span><span class="w"> </span><span class="p" data-group-id="5971386978-163">(</span><span class="n">aka</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="n">profiles</span><span class="p" data-group-id="5971386978-163">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="p">,</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">memory</span><span class="o">.</span><span class="w"> </span><span class="nc">Subprofile</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">limited</span><span class="w">
   </span><span class="n">to</span><span class="w"> </span><span class="mi">974</span><span class="w"> </span><span class="n">characters</span><span class="o">.</span><span class="w">  </span><span class="nc">Child</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">confine</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">way</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">confined</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">from</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="n">parent</span><span class="o">.</span><span class="w">  </span><span class="nc">Hats</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">aa_change_hat</span><span class="p" data-group-id="5971386978-164">(</span><span class="mi">2</span><span class="p" data-group-id="5971386978-164">)</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w">  </span><span class="nc">Applications</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">aa_change_hat</span><span class="p" data-group-id="5971386978-165">(</span><span class="mi">2</span><span class="p" data-group-id="5971386978-165">)</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">advantage</span><span class="w"> </span><span class="n">of</span><span class="w">
   </span><span class="n">subprofiles</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">confinements</span><span class="p">,</span><span class="w"> </span><span class="n">dependent</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">logic</span><span class="o">.</span><span class="w"> </span><span class="nc">Several</span><span class="w"> </span><span class="n">aa_change_hat</span><span class="p" data-group-id="5971386978-166">(</span><span class="mi">2</span><span class="p" data-group-id="5971386978-166">)</span><span class="o">-</span><span class="n">aware</span><span class="w"> </span><span class="n">applications</span><span class="w"> </span><span class="n">exist</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">Apache</span><span class="w"> </span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">mod_apparmor</span><span class="p" data-group-id="5971386978-167">(</span><span class="mi">5</span><span class="p" data-group-id="5971386978-167">)</span><span class="p">;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">PAM</span><span class="w">
   </span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">pam_apparmor</span><span class="p">;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Tomcat</span><span class="w"> </span><span class="n">valve</span><span class="p">,</span><span class="w"> </span><span class="n">tomcat_apparmor</span><span class="o">.</span><span class="w"> </span><span class="nc">Applications</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">change_profile</span><span class="p" data-group-id="5971386978-168">(</span><span class="mi">2</span><span class="p" data-group-id="5971386978-168">)</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">permanently</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w"> </span><span class="n">libvirt</span><span class="w"> </span><span class="n">is</span><span class="w">
   </span><span class="n">one</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">application</span><span class="o">.</span></code></pre><p>   Profile Head</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unique</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">attachment</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">flags</span><span class="o">.</span><span class="w">

   </span><span class="nc">Name</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">identifier</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">displayed</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">introspection</span><span class="w"> </span><span class="p" data-group-id="1303559730-1">(</span><span class="n">eg</span><span class="o">.</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="nc">Z</span><span class="p" data-group-id="1303559730-1">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">referenced</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">policy</span><span class="w">
   </span><span class="n">interaction</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">ipc</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">changes</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">recommended</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">kept</span><span class="w"> </span><span class="n">short</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">eg</span><span class="o">.</span><span class="w"> </span><span class="n">firefox</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">firefox</span><span class="w"> </span><span class="n">web</span><span class="w">
   </span><span class="n">browser</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">functional</span><span class="w"> </span><span class="n">role</span><span class="w"> </span><span class="n">eg</span><span class="o">.</span><span class="w"> </span><span class="n">log_admin</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">applications</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">absolute</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">eg</span><span class="o">.</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">firefox</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">attachment</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="sc">&#39;s exec
   attachment conditional. This use however has been deprecated and is discouraged as it makes for long names that can make profile rules difficult to understand, and may not be
   fully displayed by some introspection tools.

   Attachment Conditionals

   The attachment conditionals are used during profile changes to determine whether a profile is a match for the proposed profile transition. The attachment conditionals are
   optional, how and when they are applied is determined by the specific condition(s) used.

   When attachment conditionals are used, the attachment conditionals for all profiles in the namespace will be evaluated. The profile with the set of attachments that result in the
   best match will become the new profile after a transition operation. Attachments that don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">transition</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w">

   </span><span class="nc">Exec</span><span class="w"> </span><span class="nc">Attachment</span><span class="w"> </span><span class="nc">Conditional</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">attachment</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="n">governs</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">closely</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">program</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">rule</span><span class="w">
   </span><span class="n">specifies</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">px</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">cx</span><span class="w"> </span><span class="p" data-group-id="1303559730-2">(</span><span class="ow">or</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">derivatives</span><span class="p" data-group-id="1303559730-2">)</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">attachment</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">tasks</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pix</span><span class="w"> </span><span class="n">transition</span><span class="w">
   </span><span class="n">rule</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">attachment</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="p" data-group-id="1303559730-3">(</span><span class="n">fail</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="n">option</span><span class="p" data-group-id="1303559730-3">)</span><span class="o">.</span><span class="w">

   </span><span class="ss">Note</span><span class="p">:</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="nc">Name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attachment</span><span class="w"> </span><span class="n">conditional</span><span class="o">.</span><span class="w">

   </span><span class="nc">Exec</span><span class="w"> </span><span class="n">attachment</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">matching</span><span class="o">.</span><span class="w">  </span><span class="nc">They</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">longest</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">heuristic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">deterime</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">winner</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">at</span><span class="w">
   </span><span class="n">run</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">improved</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">retaining</span><span class="w"> </span><span class="n">backwards</span><span class="w"> </span><span class="n">compatibility</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">heuristic</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">a</span><span class="w">
   </span><span class="n">winner</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">denied</span><span class="o">.</span><span class="w">

   </span><span class="nc">Extended</span><span class="w"> </span><span class="nc">Attributes</span><span class="w"> </span><span class="nc">Attachment</span><span class="w"> </span><span class="nc">Conditional</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">xattr</span><span class="p" data-group-id="1303559730-4">(</span><span class="mi">7</span><span class="p" data-group-id="1303559730-4">)</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">addition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">attribute</span><span class="w"> </span><span class="s">&quot;security.apparmor&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ss">&quot;trusted&quot;</span><span class="p">:</span><span class="w">

     </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">xattrs</span><span class="p" data-group-id="1303559730-5">(</span><span class="n">security</span><span class="o">.</span><span class="n">apparmor</span><span class="o">=</span><span class="s">&quot;trusted&quot;</span><span class="p" data-group-id="1303559730-5">)</span><span class="w"> </span><span class="p" data-group-id="1303559730-6">{</span><span class="w">
       </span><span class="c1"># ...</span><span class="w">
     </span><span class="p" data-group-id="1303559730-6">}</span><span class="w">

   </span><span class="nc">See</span><span class="w"> </span><span class="n">apparmor_xattrs</span><span class="p" data-group-id="1303559730-7">(</span><span class="mi">7</span><span class="p" data-group-id="1303559730-7">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w">

   </span><span class="nc">Flags</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">modifying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">conflicting</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">profile</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="w">

   </span><span class="nc">Profile</span><span class="w"> </span><span class="nc">Mode</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">controlling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">enforcement</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enforce</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">

   </span><span class="n">enforce</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k" data-group-id="1303559730-8">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">grant</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">denied</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">EACCES</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">EPERM</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">userspace</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">violation</span><span class="w">
   </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">logged</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="nc">DENIED</span><span class="o">.</span><span class="w">
   </span><span class="n">kill</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variant</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">enforce</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">addition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">returning</span><span class="w"> </span><span class="nc">EACCES</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">EPERM</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">violation</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">kill</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w">
   </span><span class="n">complain</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k" data-group-id="1303559730-9">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">grant</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">violation</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">logged</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="nc">ALLOWED</span><span class="o">.</span><span class="w">
   </span><span class="n">unconfined</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">confined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">behave</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unconfined</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">to</span><span class="w">
   </span><span class="n">confinement</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">replacement</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">deployment</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">debugging</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">scenarios</span><span class="o">.</span><span class="w">

   </span><span class="nc">Audit</span><span class="w"> </span><span class="nc">Mode</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">logged</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">

   </span><span class="n">audit</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">denied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">logged</span><span class="o">.</span><span class="w">

   </span><span class="nc">Misc</span><span class="w"> </span><span class="n">modes</span><span class="w">

   </span><span class="n">mediate_deleted</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">forces</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">mediate</span><span class="w"> </span><span class="n">deleted</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">
   </span><span class="n">attach_disconnected</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">forces</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">attach</span><span class="w"> </span><span class="n">disconnected</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">task</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">mediate</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">namespace</span><span class="o">.</span><span class="w"> </span><span class="nc">WARNING</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w">
   </span><span class="n">unsafe</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">aliasing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="o">.</span><span class="w"> </span><span class="nc">Its</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">development</span><span class="w"> </span><span class="n">tool</span><span class="o">.</span><span class="w">
   </span><span class="n">chroot_relative</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">forces</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">chroot</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">behave</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chroot</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">namespace</span><span class="o">.</span></code></pre><p>   Access Modes</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">File</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">combinations</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">modes</span><span class="p">:</span><span class="w">

   </span><span class="n">r</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">read</span><span class="w">

   </span><span class="n">w</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">conflicts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">append</span><span class="w">

   </span><span class="n">a</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">append</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">conflicts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">write</span><span class="w">

   </span><span class="n">ux</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="n">execute</span><span class="w">

   </span><span class="nc">Ux</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">

   </span><span class="n">px</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">discrete</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">execute</span><span class="w">

   </span><span class="nc">Px</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">discrete</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">

   </span><span class="n">cx</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">subprofile</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">execute</span><span class="w">

   </span><span class="nc">Cx</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">subprofile</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">

   </span><span class="n">ix</span><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">inherit</span><span class="w"> </span><span class="n">execute</span><span class="w">

   </span><span class="n">pix</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">discrete</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">inherit</span><span class="w"> </span><span class="n">fallback</span><span class="w">

   </span><span class="nc">Pix</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">discrete</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">inherit</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">

   </span><span class="n">cix</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">subprofile</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">inherit</span><span class="w"> </span><span class="n">fallback</span><span class="w">

   </span><span class="nc">Cix</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">subprofile</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">inherit</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">

   </span><span class="n">pux</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">discrete</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">unconfined</span><span class="w">

   </span><span class="nc">PUx</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">discrete</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">

   </span><span class="n">cux</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">subprofile</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">unconfined</span><span class="w">

   </span><span class="nc">CUx</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">subprofile</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">

   </span><span class="n">deny</span><span class="w"> </span><span class="n">x</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">disallow</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p" data-group-id="7578923479-1">(</span><span class="ow">in</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">qualifier</span><span class="p" data-group-id="7578923479-1">)</span><span class="w">

   </span><span class="n">m</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="nc">PROT_EXEC</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">mmap</span><span class="p" data-group-id="7578923479-2">(</span><span class="mi">2</span><span class="p" data-group-id="7578923479-2">)</span><span class="w"> </span><span class="n">calls</span><span class="w">

   </span><span class="n">l</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">link</span><span class="w">

   </span><span class="n">k</span><span class="w">       </span><span class="o">-</span><span class="w"> </span><span class="n">lock</span></code></pre><p>   Access Modes Details</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Read</span><span class="w"> </span><span class="n">mode</span><span class="w">
       </span><span class="nc">Allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">listing</span><span class="o">.</span><span class="w"> </span><span class="nc">Read</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">content</span><span class="o">.</span><span class="w">

   </span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Write</span><span class="w"> </span><span class="n">mode</span><span class="w">
       </span><span class="nc">Allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">Files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">directories</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">unlinked</span><span class="w"> </span><span class="p" data-group-id="1380167716-1">(</span><span class="n">removed</span><span class="o">.</span><span class="p" data-group-id="1380167716-1">)</span><span class="w">  </span><span class="nc">Write</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w">
       </span><span class="n">directory</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">conflicts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">append</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">

   </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Append</span><span class="w"> </span><span class="n">mode</span><span class="w">
       </span><span class="nc">Allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">appending</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">Append</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">opening</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">passes</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="nc">O_APPEND</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">open</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">conflicts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">Write</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">

   </span><span class="n">ux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Unconfined</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">mode</span><span class="w">
       </span><span class="nc">Allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="o">.</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">confined</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">privileged</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">rebooting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">machine</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">placing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">privileged</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">another</span><span class="w">
       </span><span class="n">executable</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">granting</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">rights</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mandatory</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="n">imposed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">confined</span><span class="w"> </span><span class="n">processes</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">is</span><span class="w">
       </span><span class="n">constrained</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">apparmor</span><span class="p" data-group-id="1380167716-2">(</span><span class="mi">7</span><span class="p" data-group-id="1380167716-2">)</span><span class="w"> </span><span class="n">man</span><span class="w"> </span><span class="n">page</span><span class="o">.</span><span class="w">

       </span><span class="nc">WARNING</span><span class="w"> </span><span class="sc">&#39;ux&#39;</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">cases</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">enables</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">designated</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">protection</span><span class="o">.</span><span class="w">  </span><span class="sc">&#39;ux&#39;</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">environment</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">LD_PRELOAD</span><span class="p">;</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">undue</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">influence</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">callee</span><span class="o">.</span><span class="w">  </span><span class="nc">Use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="n">absolutely</span><span class="w">
       </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">LD_PRELOAD</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">Any</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">negligible</span><span class="w"> </span><span class="n">security</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">risk</span><span class="o">.</span><span class="w">

       </span><span class="nc">Incompatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">qualifier</span><span class="o">.</span><span class="w">

   </span><span class="nc">Ux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unconfined</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">
       </span><span class="sc">&#39;Ux&#39;</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="sc">&#39;ux&#39;</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">invoke</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="nc">Kernel</span><span class="sc">&#39;s unsafe_exec routines to scrub the environment, similar to setuid programs. (See
       ld.so(8) for some information on setuid/setgid environment scrubbing.)

       WARNING &#39;</span><span class="nc">Ux</span><span class="sc">&#39; should only be used in very special cases. It enables the designated child processes to be run without any AppArmor protection.  Use this mode only if the child
       absolutely must be run unconfined. Use at your own risk.

       Incompatible with other exec transition modes and the deny qualifier.

   px - Discrete Profile execute mode
       This mode requires that a discrete security profile is defined for a program executed and forces an AppArmor domain transition. If there is no profile defined then the access
       will be denied.

       WARNING &#39;</span><span class="n">px</span><span class="sc">&#39; does not scrub the environment of variables such as LD_PRELOAD; as a result, the calling domain may have an undue amount of influence over the callee.

       Incompatible with other exec transition modes and the deny qualifier.

   Px - Discrete Profile execute mode -- scrub the environment
       &#39;</span><span class="nc">Px</span><span class="sc">&#39; allows the named program to run in &#39;</span><span class="n">px</span><span class="sc">&#39; mode, but AppArmor will invoke the Linux Kernel&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">unsafe_exec</span><span class="w"> </span><span class="n">routines</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">setuid</span><span class="w"> </span><span class="n">programs</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="1380167716-3">(</span><span class="nc">See</span><span class="w">
       </span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="p" data-group-id="1380167716-4">(</span><span class="mi">8</span><span class="p" data-group-id="1380167716-4">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">setuid</span><span class="o">/</span><span class="n">setgid</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">scrubbing</span><span class="o">.</span><span class="p" data-group-id="1380167716-3">)</span><span class="w">

       </span><span class="nc">Incompatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">qualifier</span><span class="o">.</span><span class="w">

   </span><span class="n">cx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">Subprofile</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">mode</span><span class="w">
       </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">forces</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">will</span><span class="w">
       </span><span class="n">be</span><span class="w"> </span><span class="n">denied</span><span class="o">.</span><span class="w">

       </span><span class="nc">WARNING</span><span class="w"> </span><span class="sc">&#39;cx&#39;</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">LD_PRELOAD</span><span class="p">;</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">undue</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">influence</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">callee</span><span class="o">.</span><span class="w">

       </span><span class="nc">Incompatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">modes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">qualifier</span><span class="o">.</span><span class="w">

   </span><span class="nc">Cx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">Subprofile</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w">
       </span><span class="sc">&#39;Cx&#39;</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="sc">&#39;cx&#39;</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">invoke</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="nc">Kernel</span><span class="sc">&#39;s unsafe_exec routines to scrub the environment, similar to setuid programs. (See
       ld.so(8) for some information on setuid/setgid environment scrubbing.)

       Incompatible with other exec transition modes and the deny qualifier.

   ix - Inherit execute mode
       Prevent the normal AppArmor domain transition on execve(2) when the profiled program executes the named program. Instead, the executed resource will inherit the current
       profile.

       This mode is useful when a confined program needs to call another confined program without gaining the permissions of the target&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">profile</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">losing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">current</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">scrub</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="sc">&#39;ix&#39;</span><span class="w"> </span><span class="n">executions</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t change privileges.

       Incompatible with other exec transition modes and the deny qualifier.

   Profile transition with inheritance fallback execute mode
       These modes attempt to perform a domain transition as specified by the matching permission (shown below) and if that transition fails to find the matching profile the domain
       transition proceeds using the &#39;</span><span class="n">ix</span><span class="sc">&#39; transition mode.

         &#39;</span><span class="nc">Pix</span><span class="sc">&#39; == &#39;</span><span class="nc">Px</span><span class="sc">&#39; with fallback to &#39;</span><span class="n">ix</span><span class="sc">&#39;
         &#39;</span><span class="n">pix</span><span class="sc">&#39; == &#39;</span><span class="n">px</span><span class="sc">&#39; with fallback to &#39;</span><span class="n">ix</span><span class="sc">&#39;
         &#39;</span><span class="nc">Cix</span><span class="sc">&#39; == &#39;</span><span class="nc">Cx</span><span class="sc">&#39; with fallback to &#39;</span><span class="n">ix</span><span class="sc">&#39;
         &#39;</span><span class="n">cix</span><span class="sc">&#39; == &#39;</span><span class="n">cx</span><span class="sc">&#39; with fallback to &#39;</span><span class="n">ix</span><span class="sc">&#39;

       Incompatible with other exec transition modes and the deny qualifier.

   Profile transition with unconfined fallback execute mode
       These modes attempt to perform a domain transition as specified by the matching permission (shown below) and if that transition fails to find the matching profile the domain
       transition proceeds using the &#39;</span><span class="n">ux</span><span class="sc">&#39; transition mode if &#39;</span><span class="n">pux</span><span class="sc">&#39;, &#39;</span><span class="n">cux</span><span class="sc">&#39; or the &#39;</span><span class="nc">Ux</span><span class="sc">&#39; transition mode if &#39;</span><span class="nc">PUx</span><span class="sc">&#39;, &#39;</span><span class="nc">CUx</span><span class="sc">&#39; is used.

         &#39;</span><span class="nc">PUx</span><span class="sc">&#39; == &#39;</span><span class="nc">Px</span><span class="sc">&#39; with fallback to &#39;</span><span class="nc">Ux</span><span class="sc">&#39;
         &#39;</span><span class="n">pux</span><span class="sc">&#39; == &#39;</span><span class="n">px</span><span class="sc">&#39; with fallback to &#39;</span><span class="n">ux</span><span class="sc">&#39;
         &#39;</span><span class="nc">CUx</span><span class="sc">&#39; == &#39;</span><span class="nc">Cx</span><span class="sc">&#39; with fallback to &#39;</span><span class="nc">Ux</span><span class="sc">&#39;
         &#39;</span><span class="n">cux</span><span class="sc">&#39; == &#39;</span><span class="n">cx</span><span class="sc">&#39; with fallback to &#39;</span><span class="n">ux</span><span class="sc">&#39;

       Incompatible with other exec transition modes and the deny qualifier.

   deny x - Deny execute
       For rules including the deny modifier, only &#39;</span><span class="n">x</span><span class="sc">&#39; is allowed to deny execute.

       The &#39;</span><span class="n">ix</span><span class="sc">&#39;, &#39;</span><span class="nc">Px</span><span class="sc">&#39;, &#39;</span><span class="n">px</span><span class="sc">&#39;, &#39;</span><span class="nc">Cx</span><span class="sc">&#39;, &#39;</span><span class="n">cx</span><span class="sc">&#39; and the fallback modes conflict with the deny modifier.

   Directed profile transitions
       The directed (&#39;</span><span class="n">px</span><span class="sc">&#39;, &#39;</span><span class="nc">Px</span><span class="sc">&#39;, &#39;</span><span class="n">pix</span><span class="sc">&#39;, &#39;</span><span class="nc">Pix</span><span class="sc">&#39;, &#39;</span><span class="n">pux</span><span class="sc">&#39;, &#39;</span><span class="nc">PUx</span><span class="sc">&#39;) profile and subprofile (&#39;</span><span class="n">cx</span><span class="sc">&#39;, &#39;</span><span class="nc">Cx</span><span class="sc">&#39;, &#39;</span><span class="n">cix</span><span class="sc">&#39;, &#39;</span><span class="nc">Cix</span><span class="sc">&#39;, &#39;</span><span class="n">cux</span><span class="sc">&#39;, &#39;</span><span class="nc">CUx</span><span class="sc">&#39;) transitions normally determine the profile to transition
       to from the executable name. It is however possible to specify the name of the profile that the transition should use.

       The name of the profile to transition to is specified using the &#39;</span><span class="o">-&gt;</span><span class="sc">&#39; followed by the name of the profile to transition to. Eg.

         /bin/** px -&gt; profile,

       Incompatible with other exec transition modes.

   m - Allow executable mapping
       This mode allows a file to be mapped into memory using mmap(2)&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">PROT_EXEC</span><span class="w"> </span><span class="n">flag</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">marks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="n">executable</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">architectures</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="w">
       </span><span class="n">executable</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">pages</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">complicate</span><span class="w"> </span><span class="n">exploit</span><span class="w"> </span><span class="n">attempts</span><span class="o">.</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">well</span><span class="o">-</span><span class="n">behaved</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="p" data-group-id="1380167716-5">(</span><span class="ow">or</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">architectures</span><span class="w"> </span><span class="n">that</span><span class="w">
       </span><span class="n">enforce</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">executable</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">controls</span><span class="p" data-group-id="1380167716-5">)</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">libraries</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="o">-</span><span class="nc">L</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ld</span><span class="p" data-group-id="1380167716-6">(</span><span class="mi">1</span><span class="p" data-group-id="1380167716-6">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">LD_PRELOAD</span><span class="p">,</span><span class="w"> </span><span class="nc">LD_LIBRARY_PATH</span><span class="p">,</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="p" data-group-id="1380167716-7">(</span><span class="mi">8</span><span class="p" data-group-id="1380167716-7">)</span><span class="o">.</span><span class="w">

   </span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Link</span><span class="w"> </span><span class="n">mode</span><span class="w">
       </span><span class="nc">Allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">created</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="nc">MUST</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="1380167716-8">(</span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exception</span><span class="w">
       </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">access</span><span class="o">.</span><span class="p" data-group-id="1380167716-8">)</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="sc">&#39;x&#39;</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">link</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">exactly</span><span class="o">.</span><span class="w">

   </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="n">mode</span><span class="w">
       </span><span class="nc">Allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">covers</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">advisory</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">mandatory</span><span class="w"> </span><span class="n">locking</span><span class="o">.</span><span class="w">

   </span><span class="n">leading</span><span class="w"> </span><span class="nc">OR</span><span class="w"> </span><span class="n">trailing</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">permissions</span><span class="w">
       </span><span class="nc">File</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">leading</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">trailing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">glob</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

         </span><span class="n">rw</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="p">,</span><span class="w">               </span><span class="c1"># leading permissions</span><span class="w">

         </span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="w"> </span><span class="n">rw</span><span class="p">,</span><span class="w">               </span><span class="c1"># trailing permissions</span><span class="w">

       </span><span class="nc">When</span><span class="w"> </span><span class="n">leading</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="p">,</span><span class="w"> </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

         </span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">bar</span><span class="p">,</span><span class="w">       </span><span class="c1"># lead &#39;l&#39; link permission is equivalent to link rules</span></code></pre><p>   Link rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Link</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">pair</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w">
   </span><span class="n">subset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="sc">&#39;x&#39;</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">link</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">exactly</span><span class="o">.</span><span class="w">

   </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

     </span><span class="o">/</span><span class="n">file1</span><span class="w">  </span><span class="n">r</span><span class="p">,</span><span class="w">
     </span><span class="o">/</span><span class="n">file2</span><span class="w">  </span><span class="n">rwk</span><span class="p">,</span><span class="w">
     </span><span class="o">/</span><span class="n">link</span><span class="o">*</span><span class="w">  </span><span class="n">rw</span><span class="p">,</span><span class="w">
     </span><span class="n">link</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="o">/</span><span class="n">link</span><span class="o">*</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="p">,</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">linking</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">link</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="o">/</span><span class="n">file1</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">/</span><span class="n">file2</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">/</span><span class="n">link</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">/</span><span class="n">file1</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">would</span><span class="w">
   </span><span class="n">grant</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">/</span><span class="n">file1</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">specifies</span><span class="o">.</span><span class="w">

   </span><span class="nc">A</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">link</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">/</span><span class="n">file2</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">link</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;rwk&#39;</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">/</span><span class="n">file1</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">leading</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w">
   </span><span class="n">specified</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">rule</span><span class="w">

     </span><span class="n">link</span><span class="w"> </span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bar</span><span class="p">,</span><span class="w">
     </span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">bar</span><span class="p">,</span><span class="w">

   </span><span class="nc">File</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">don</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">extend</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">follows</span><span class="o">.</span><span class="w">

     </span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w">
     </span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w">
     </span><span class="n">link</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="p">,</span></code></pre><p>   Comments</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">Comments</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="c1"># and may begin at any place within a line. The comment ends when the line ends. This is the same comment style as shell scripts.</span></code></pre><p>   Capabilities</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">capabilities</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">confined</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">enumerated</span><span class="p">;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">please</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">capabilities</span><span class="p" data-group-id="2924630024-1">(</span><span class="mi">7</span><span class="p" data-group-id="2924630024-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">granting</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">capabilities</span><span class="w"> </span><span class="n">renders</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w">
   </span><span class="n">confinement</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">advisory</span><span class="p">;</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="2924630024-2">(</span><span class="mi">2</span><span class="p" data-group-id="2924630024-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="p" data-group-id="2924630024-3">(</span><span class="mi">2</span><span class="p" data-group-id="2924630024-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">write</span><span class="p" data-group-id="2924630024-4">(</span><span class="mi">2</span><span class="p" data-group-id="2924630024-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">granted</span><span class="p">,</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">capabilities</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">loading</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">modules</span><span class="p">,</span><span class="w">
   </span><span class="n">arbitrary</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">IPC</span><span class="p">,</span><span class="w"> </span><span class="n">ability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">discretionary</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">controls</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">operations</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">reserved</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">user</span><span class="o">.</span></code></pre><p>   Network Rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">coarse</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">mediation</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">restrict</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3936473969-1">(</span><span class="mi">2</span><span class="p" data-group-id="3936473969-1">)</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">operations</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">coarse</span><span class="o">-</span><span class="n">grained</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">a</span><span class="w">
   </span><span class="n">socket</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">created</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">written</span><span class="o">.</span><span class="w">  </span><span class="nc">There</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">beyond</span><span class="w"> </span><span class="n">tcp</span><span class="p">,</span><span class="w"> </span><span class="n">udp</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">raw</span><span class="o">.</span><span class="w">  </span><span class="nc">Network</span><span class="w"> </span><span class="n">netlink</span><span class="p" data-group-id="3936473969-2">(</span><span class="mi">7</span><span class="p" data-group-id="3936473969-2">)</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">may</span><span class="w">
   </span><span class="n">only</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="sc">&#39;dgram&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;raw&#39;</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accumulated</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">union</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">broad</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">restrictive</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">

   </span><span class="n">eg</span><span class="o">.</span><span class="w">

    </span><span class="n">network</span><span class="p">,</span><span class="w">               </span><span class="c1">#allow access to all networking</span><span class="w">
    </span><span class="n">network</span><span class="w"> </span><span class="n">tcp</span><span class="p">,</span><span class="w">           </span><span class="c1">#allow access to tcp</span><span class="w">
    </span><span class="n">network</span><span class="w"> </span><span class="n">inet</span><span class="w"> </span><span class="n">tcp</span><span class="p">,</span><span class="w">      </span><span class="c1">#allow access to tcp only for inet4 addresses</span><span class="w">
    </span><span class="n">network</span><span class="w"> </span><span class="n">inet6</span><span class="w"> </span><span class="n">tcp</span><span class="p">,</span><span class="w">     </span><span class="c1">#allow access to tcp only for inet6 addresses</span><span class="w">
    </span><span class="n">network</span><span class="w"> </span><span class="n">netlink</span><span class="w"> </span><span class="n">raw</span><span class="p">,</span><span class="w">   </span><span class="c1">#allow access to AF_NETLINK SOCK_RAW</span></code></pre><p>   Mount Rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">flags</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mount</span><span class="p" data-group-id="5119735746-1">(</span><span class="mi">8</span><span class="p" data-group-id="5119735746-1">)</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">syntax</span><span class="o">.</span><span class="w"> </span><span class="nc">Mount</span><span class="w">
   </span><span class="n">rules</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mount</span><span class="p">,</span><span class="w"> </span><span class="n">remount</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">umount</span><span class="w"> </span><span class="n">keywords</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">conditions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">optional</span><span class="o">.</span><span class="w"> </span><span class="nc">Unspecified</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">assumed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="p" data-group-id="5119735746-2">(</span><span class="n">eg</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w">
   </span><span class="n">specifying</span><span class="w"> </span><span class="n">fstype</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">fstypes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">matched</span><span class="p" data-group-id="5119735746-2">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">complexity</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">three</span><span class="w">
   </span><span class="n">different</span><span class="w"> </span><span class="ss">ways</span><span class="p">:</span><span class="w">

   </span><span class="mi">1</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">grants</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">mounts</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">following</span><span class="w"> </span><span class="ss">rule</span><span class="p">:</span><span class="w">

           </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">-</span><span class="nc">E</span><span class="o">&lt;</span><span class="n">gt</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="p">,</span><span class="w">

       </span><span class="nc">Would</span><span class="w"> </span><span class="ss">match</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

       </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="ss">these</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

   </span><span class="mi">2</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="sc">&#39;in&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">grants</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">mounts</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">has</span><span class="w">
       </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">rule</span><span class="p">:</span><span class="w">

           </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p" data-group-id="5119735746-3">(</span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p" data-group-id="5119735746-3">)</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="p">,</span><span class="w">

       </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ss">match</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

       </span><span class="n">but</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="ss">will</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">sync</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p">,</span><span class="n">sync</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">rw</span><span class="p">,</span><span class="n">noatime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

   </span><span class="mi">3</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">rule</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">grants</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shorthand</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">writing</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">rules</span><span class="w">
       </span><span class="n">which</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">logically</span><span class="w"> </span><span class="n">break</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">conditional</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">rule</span><span class="p">:</span><span class="w">

           </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">ro</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">atime</span><span class="w">

       </span><span class="n">both</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ss">match</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

       </span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ss">not</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

   </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">distinct</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k" data-group-id="5119735746-4">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">accumulate</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">rules</span><span class="p">:</span><span class="w">

       </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span><span class="w">

       </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">atime</span><span class="p">,</span><span class="w">

   </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">rules</span><span class="p">:</span><span class="w">

       </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="p" data-group-id="5119735746-5">(</span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p" data-group-id="5119735746-5">)</span><span class="p">,</span><span class="w">

       </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p" data-group-id="5119735746-6">(</span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p" data-group-id="5119735746-6">)</span><span class="p">,</span><span class="w">

   </span><span class="nc">To</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="n">clarify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">flexibility</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">complexity</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">rules</span><span class="p">,</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">accompanying</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

   </span><span class="n">mount</span><span class="p">,</span><span class="w">
       </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;mount&#39;</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">generic</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">mount</span><span class="o">.</span><span class="w"> </span><span class="nc">Equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="sc">&#39;mount fstype=** options=** ** -&gt; /**&#39;</span><span class="o">.</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">anywhere</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w"> </span><span class="nc">Some</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">ext3</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">vfat</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p">,</span><span class="n">noexec</span><span class="p">,</span><span class="n">nodiratime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">mountpoint</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">anywhere</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w"> </span><span class="nc">Some</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="k" data-group-id="5119735746-4">else</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="p" data-group-id="5119735746-7">(</span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p" data-group-id="5119735746-7">)</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">anywhere</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">inode</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">times</span><span class="o">.</span><span class="w">  </span><span class="nc">Some</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="k" data-group-id="5119735746-4">else</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p" data-group-id="5119735746-8">(</span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p" data-group-id="5119735746-8">)</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">anywhere</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;ro&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;atime&#39;</span><span class="w"> </span><span class="p" data-group-id="5119735746-9">(</span><span class="n">see</span><span class="w"> </span><span class="n">above</span><span class="p" data-group-id="5119735746-9">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Some</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="k" data-group-id="5119735746-4">else</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">other</span><span class="o">/</span><span class="n">place</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">anywhere</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">only</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">anywhere</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">inode</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">times</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">expressed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w"> </span><span class="ss">Matches</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="mi">1</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="mi">2</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="n">anything</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="o">.</span><span class="w"> </span><span class="nc">Some</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo1</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="mi">1</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="p">,</span><span class="n">noexec</span><span class="p">,</span><span class="n">nodiratime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo2</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">deep</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">foo2</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="n">ro</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="n">anything</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w"> </span><span class="nc">Some</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ss">commands</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo1</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="mi">1</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo2</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">deep</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">foo2</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="n">fstype</span><span class="o">=</span><span class="n">ext3</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="p" data-group-id="5119735746-10">(</span><span class="n">rw</span><span class="p">,</span><span class="n">atime</span><span class="p" data-group-id="5119735746-10">)</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">stick</span><span class="o">/</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ext3</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">stick</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">inode</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">times</span><span class="o">.</span><span class="w"> </span><span class="nc">Matches</span><span class="w"> </span><span class="ss">only</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">rw</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">stick</span><span class="w">

   </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="o">=</span><span class="p" data-group-id="5119735746-11">(</span><span class="n">ro</span><span class="p">,</span><span class="w"> </span><span class="n">atime</span><span class="p" data-group-id="5119735746-11">)</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p" data-group-id="5119735746-12">(</span><span class="n">nodev</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="5119735746-12">)</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="p">,</span><span class="w">
       </span><span class="n">allow</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">/</span><span class="n">mmt</span><span class="o">/</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">inode</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">mounting</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;nodev&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;user&#39;</span><span class="o">.</span><span class="w">  </span><span class="nc">Matches</span><span class="w"> </span><span class="ss">only</span><span class="p">:</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">ro</span><span class="p">,</span><span class="n">atime</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">nodev</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">

           </span><span class="err">$</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">nodev</span><span class="p">,</span><span class="n">user</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span></code></pre><p>   Pivot Root Rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">mediates</span><span class="w"> </span><span class="n">changing</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pivot_root</span><span class="p" data-group-id="8632820778-1">(</span><span class="mi">2</span><span class="p" data-group-id="8632820778-1">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;pivot_root&#39;</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pivot_root</span><span class="p" data-group-id="8632820778-2">(</span><span class="mi">2</span><span class="p" data-group-id="8632820778-2">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="w">
   </span><span class="n">parameters</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">notable</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reversed</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">put_old</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">pivot_root</span><span class="p" data-group-id="8632820778-3">(</span><span class="mi">2</span><span class="p" data-group-id="8632820778-3">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;pivot_root&#39;</span><span class="w">
   </span><span class="n">rule</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;oldroot=&#39;</span><span class="w"> </span><span class="n">prefix</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="sc">&#39;pivot_root&#39;</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">occur</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pivot_root</span><span class="p" data-group-id="8632820778-4">(</span><span class="mi">2</span><span class="p" data-group-id="8632820778-4">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">calling</span><span class="w">
   </span><span class="n">pivot_root</span><span class="p" data-group-id="8632820778-5">(</span><span class="mi">2</span><span class="p" data-group-id="8632820778-5">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="sc">&#39;pivot_root&#39;</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">directories</span><span class="o">.</span><span class="w">

   </span><span class="nc">Here</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="sc">&#39;pivot_root&#39;</span><span class="w"> </span><span class="ss">rules</span><span class="p">:</span><span class="w">

       </span><span class="c1"># Allow any pivot</span><span class="w">
       </span><span class="n">pivot_root</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow pivoting to any new root directory and putting the old root</span><span class="w">
       </span><span class="c1"># directory at /mnt/root/old/</span><span class="w">
       </span><span class="n">pivot_root</span><span class="w"> </span><span class="n">oldroot</span><span class="o">=</span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">old</span><span class="o">/</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow pivoting the root directory to /mnt/root/</span><span class="w">
       </span><span class="n">pivot_root</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow pivoting to /mnt/root/ and putting the old root directory at</span><span class="w">
       </span><span class="c1"># /mnt/root/old/</span><span class="w">
       </span><span class="n">pivot_root</span><span class="w"> </span><span class="n">oldroot</span><span class="o">=</span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">old</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow pivoting to /mnt/root/, putting the old root directory at</span><span class="w">
       </span><span class="c1"># /mnt/root/old/ and transition to the /mnt/root/sbin/init profile</span><span class="w">
       </span><span class="n">pivot_root</span><span class="w"> </span><span class="n">oldroot</span><span class="o">=</span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">old</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">init</span><span class="p">,</span></code></pre><p>   PTrace rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ptrace</span><span class="p" data-group-id="7885753239-1">(</span><span class="mi">2</span><span class="p" data-group-id="7885753239-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">PTrace</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accumulated</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="nc">PTrace</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">union</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="nc">PTrace</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">PTrace</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">PTrace</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tracedby</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">govern</span><span class="w"> </span><span class="n">ptrace</span><span class="p" data-group-id="7885753239-2">(</span><span class="mi">2</span><span class="p" data-group-id="7885753239-2">)</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">readby</span><span class="w"> </span><span class="n">govern</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">proc</span><span class="p" data-group-id="7885753239-3">(</span><span class="mi">5</span><span class="p" data-group-id="7885753239-3">)</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">accesses</span><span class="p">,</span><span class="w"> </span><span class="n">kcmp</span><span class="p" data-group-id="7885753239-4">(</span><span class="mi">2</span><span class="p" data-group-id="7885753239-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">futexes</span><span class="w"> </span><span class="p" data-group-id="7885753239-5">(</span><span class="n">get_robust_list</span><span class="p" data-group-id="7885753239-6">(</span><span class="mi">2</span><span class="p" data-group-id="7885753239-6">)</span><span class="p" data-group-id="7885753239-5">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">perf</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="n">events</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">ptrace</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tracing</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correct</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">process</span><span class="w"> </span><span class="n">attaching</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">task</span><span class="sc">&#39;s profile, and the task being traced must have the tracedby permission for the tracing
   process&#39;</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w">

   </span><span class="nc">Example</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">PTrace</span><span class="w"> </span><span class="ss">rules</span><span class="p">:</span><span class="w">

       </span><span class="c1"># Allow all PTrace access</span><span class="w">
       </span><span class="n">ptrace</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Explicitly allow all PTrace access,</span><span class="w">
       </span><span class="n">ptrace</span><span class="w"> </span><span class="p" data-group-id="7885753239-7">(</span><span class="n">read</span><span class="p">,</span><span class="w"> </span><span class="n">readby</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="p">,</span><span class="w"> </span><span class="n">tracedby</span><span class="p" data-group-id="7885753239-7">)</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Explicitly deny use of ptrace(2)</span><span class="w">
       </span><span class="n">deny</span><span class="w"> </span><span class="n">ptrace</span><span class="w"> </span><span class="p" data-group-id="7885753239-8">(</span><span class="n">trace</span><span class="p" data-group-id="7885753239-8">)</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow unconfined processes (eg, a debugger) to ptrace us</span><span class="w">
       </span><span class="n">ptrace</span><span class="w"> </span><span class="p" data-group-id="7885753239-9">(</span><span class="n">readby</span><span class="p">,</span><span class="w"> </span><span class="n">tracedby</span><span class="p" data-group-id="7885753239-9">)</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="n">unconfined</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow ptrace of a process running under the /usr/bin/foo profile</span><span class="w">
       </span><span class="n">ptrace</span><span class="w"> </span><span class="p" data-group-id="7885753239-10">(</span><span class="n">trace</span><span class="p" data-group-id="7885753239-10">)</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span></code></pre><p>   Signal rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">signal</span><span class="p" data-group-id="4293575430-1">(</span><span class="mi">7</span><span class="p" data-group-id="4293575430-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accumulated</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">union</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correct</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w">
   </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">task</span><span class="sc">&#39;s profile, and the task receiving the signal must have a receive permission for the
   sending process&#39;</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w">

   </span><span class="nc">Example</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="ss">rules</span><span class="p">:</span><span class="w">

       </span><span class="c1"># Allow all signal access</span><span class="w">
       </span><span class="n">signal</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Explicitly deny sending the HUP and INT signals</span><span class="w">
       </span><span class="n">deny</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="4293575430-2">(</span><span class="n">send</span><span class="p" data-group-id="4293575430-2">)</span><span class="w"> </span><span class="n">set</span><span class="o">=</span><span class="p" data-group-id="4293575430-3">(</span><span class="n">hup</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="p" data-group-id="4293575430-3">)</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow unconfined processes to send us signals</span><span class="w">
       </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="4293575430-4">(</span><span class="k">receive</span><span class="p" data-group-id="4293575430-4">)</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="n">unconfined</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow sending of signals to a process running under the /usr/bin/foo</span><span class="w">
       </span><span class="c1"># profile</span><span class="w">
       </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="4293575430-5">(</span><span class="n">send</span><span class="p" data-group-id="4293575430-5">)</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow checking for PID existence</span><span class="w">
       </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="4293575430-6">(</span><span class="k">receive</span><span class="p">,</span><span class="w"> </span><span class="n">send</span><span class="p" data-group-id="4293575430-6">)</span><span class="w"> </span><span class="n">set</span><span class="o">=</span><span class="p" data-group-id="4293575430-7">(</span><span class="s">&quot;exists&quot;</span><span class="p" data-group-id="4293575430-7">)</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow us to signal ourselves using the built-in @{profile_name} variable</span><span class="w">
       </span><span class="n">signal</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="err">@</span><span class="p" data-group-id="4293575430-8">{</span><span class="n">profile_name</span><span class="p" data-group-id="4293575430-8">}</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow two real-time signals</span><span class="w">
       </span><span class="n">signal</span><span class="w"> </span><span class="n">set</span><span class="o">=</span><span class="p" data-group-id="4293575430-9">(</span><span class="n">rtmin</span><span class="o">+</span><span class="mi">0</span><span class="w"> </span><span class="n">rtmin</span><span class="o">+</span><span class="mi">32</span><span class="p" data-group-id="4293575430-9">)</span><span class="p">,</span></code></pre><p>   DBus rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">mediation</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">conjunction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">daemon</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">daemon</span><span class="w"> </span><span class="n">verifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">communications</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">permitted</span><span class="w"> </span><span class="n">by</span><span class="w">
   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">policy</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accumulated</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">union</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">broad</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">restrictive</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">down</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">member</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="p" data-group-id="8871975432-1">(</span><span class="n">method</span><span class="w"> </span><span class="ow">or</span><span class="w">
   </span><span class="n">signal</span><span class="w"> </span><span class="n">name</span><span class="p" data-group-id="8871975432-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">examined</span><span class="o">.</span><span class="w">

   </span><span class="nc">Some</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">compatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="sc">&#39;bind&#39;</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="sc">&#39;send&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;receive&#39;</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">cannot</span><span class="w">
   </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="sc">&#39;eavesdrop&#39;</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;bus&#39;</span><span class="w"> </span><span class="n">conditional</span><span class="o">.</span><span class="w">

   </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;read&#39;</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">synonyms</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="sc">&#39;receive&#39;</span><span class="o">.</span><span class="w"> </span><span class="sc">&#39;w&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;write&#39;</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">synonyms</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="sc">&#39;send&#39;</span><span class="o">.</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">synonym</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="sc">&#39;send&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;receive&#39;</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="k">for</span><span class="w">
   </span><span class="n">message</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">

   </span><span class="nc">Example</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="nc">DBus</span><span class="w"> </span><span class="ss">rules</span><span class="p">:</span><span class="w">

       </span><span class="c1"># Allow all DBus access</span><span class="w">
       </span><span class="n">dbus</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Explicitly allow all DBus access,</span><span class="w">
       </span><span class="n">dbus</span><span class="w"> </span><span class="p" data-group-id="8871975432-2">(</span><span class="n">send</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="p">,</span><span class="w"> </span><span class="n">bind</span><span class="p" data-group-id="8871975432-2">)</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Deny send/receive/bind access to the session bus</span><span class="w">
       </span><span class="n">deny</span><span class="w"> </span><span class="n">dbus</span><span class="w"> </span><span class="n">bus</span><span class="o">=</span><span class="n">session</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow bind access for a particular name on any bus</span><span class="w">
       </span><span class="n">dbus</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="nc">ExampleName</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow receive access for a particular path and interface</span><span class="w">
       </span><span class="n">dbus</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">path</span><span class="o">=</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">path</span><span class="w"> </span><span class="n">interface</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="nc">Interface</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Deny send/receive access to the system bus for a particular interface</span><span class="w">
       </span><span class="n">deny</span><span class="w"> </span><span class="n">dbus</span><span class="w"> </span><span class="n">bus</span><span class="o">=</span><span class="n">system</span><span class="w"> </span><span class="n">interface</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="nc">ExampleInterface</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow send access for a particular path, interface, member, and pair of</span><span class="w">
       </span><span class="c1"># peer names:</span><span class="w">
       </span><span class="n">dbus</span><span class="w"> </span><span class="n">send</span><span class="w">
            </span><span class="n">bus</span><span class="o">=</span><span class="n">session</span><span class="w">
            </span><span class="n">path</span><span class="o">=</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">path</span><span class="w">
            </span><span class="n">interface</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="nc">Interface</span><span class="w">
            </span><span class="n">member</span><span class="o">=</span><span class="nc">ExampleMethod</span><span class="w">
            </span><span class="n">peer</span><span class="o">=</span><span class="p" data-group-id="8871975432-3">(</span><span class="n">name</span><span class="o">=</span><span class="p" data-group-id="8871975432-4">(</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="nc">ExampleName1</span><span class="o">|</span><span class="n">com</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="nc">ExampleName2</span><span class="p" data-group-id="8871975432-4">)</span><span class="p" data-group-id="8871975432-3">)</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow receive access for all unconfined peers</span><span class="w">
       </span><span class="n">dbus</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="p" data-group-id="8871975432-5">(</span><span class="n">label</span><span class="o">=</span><span class="n">unconfined</span><span class="p" data-group-id="8871975432-5">)</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow eavesdropping on the system bus</span><span class="w">
       </span><span class="n">dbus</span><span class="w"> </span><span class="n">eavesdrop</span><span class="w"> </span><span class="n">bus</span><span class="o">=</span><span class="n">system</span><span class="p">,</span><span class="w">

       </span><span class="c1"># Allow and audit all eavesdropping</span><span class="w">
       </span><span class="n">audit</span><span class="w"> </span><span class="n">dbus</span><span class="w"> </span><span class="n">eavesdrop</span><span class="p">,</span></code></pre><p>   Unix socket rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">fine</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">anonymous</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span><span class="w"> </span><span class="nc">Unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">mediated</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">

   </span><span class="nc">Abstract</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">nonportable</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">unix</span><span class="p" data-group-id="0401452079-1">(</span><span class="mi">7</span><span class="p" data-group-id="0401452079-1">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="o">.</span><span class="w">

   </span><span class="nc">Unix</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">paths</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">sun_path</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="p" data-group-id="0401452079-2">(</span><span class="n">aka</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">address</span><span class="p" data-group-id="0401452079-2">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w">

     </span><span class="n">addr</span><span class="o">=</span><span class="w">

   </span><span class="n">conditional</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">anonymous</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span><span class="w">

   </span><span class="nc">In</span><span class="w"> </span><span class="n">apparmor</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">begins</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="n">character</span><span class="p">,</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">reported</span><span class="w"> </span><span class="p" data-group-id="0401452079-3">(</span><span class="n">as</span><span class="w"> </span><span class="n">paths</span><span class="p" data-group-id="0401452079-3">)</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">netstat</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">follows</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">may</span><span class="w">
   </span><span class="n">contain</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">null</span><span class="w"> </span><span class="n">character</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">apparmor</span><span class="w"> </span><span class="n">null</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">escape</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="err">\</span><span class="mi">000</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">\</span><span class="n">x00</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">pattern</span><span class="w">
   </span><span class="n">matching</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

     </span><span class="n">unix</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="err">@</span><span class="o">*</span><span class="p">,</span><span class="w">

   </span><span class="nc">Autobound</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">sun_path</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">possible</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">autobinding</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w">
   </span><span class="n">controlled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">keyword</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

     </span><span class="n">unix</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span><span class="w">

   </span><span class="nc">To</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">bound</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w">
   </span><span class="n">address</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">indistinguishable</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">bound</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w">
   </span><span class="n">be</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">autobound</span><span class="w"> </span><span class="n">socket</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">kernels</span><span class="w">

     </span><span class="n">unix</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span><span class="w">

   </span><span class="n">is</span><span class="w"> </span><span class="n">transformed</span><span class="w"> </span><span class="n">to</span><span class="w">

     </span><span class="n">unix</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="err">@</span><span class="p" data-group-id="0401452079-4">[</span><span class="n">a</span><span class="o">-</span><span class="n">f0</span><span class="o">-</span><span class="mi">9</span><span class="p" data-group-id="0401452079-4">]</span><span class="p" data-group-id="0401452079-5">[</span><span class="n">a</span><span class="o">-</span><span class="n">f0</span><span class="o">-</span><span class="mi">9</span><span class="p" data-group-id="0401452079-5">]</span><span class="p" data-group-id="0401452079-6">[</span><span class="n">a</span><span class="o">-</span><span class="n">f0</span><span class="o">-</span><span class="mi">9</span><span class="p" data-group-id="0401452079-6">]</span><span class="p" data-group-id="0401452079-7">[</span><span class="n">a</span><span class="o">-</span><span class="n">f0</span><span class="o">-</span><span class="mi">9</span><span class="p" data-group-id="0401452079-7">]</span><span class="p" data-group-id="0401452079-8">[</span><span class="n">a</span><span class="o">-</span><span class="n">f0</span><span class="o">-</span><span class="mi">9</span><span class="p" data-group-id="0401452079-8">]</span><span class="p">,</span><span class="w">

   </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">note</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">autobound</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">fits</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">autobinding</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">socket</span><span class="o">.</span><span class="w">

   </span><span class="nc">Anonymous</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">sun_path</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w">
   </span><span class="n">anonymous</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

     </span><span class="n">unix</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="n">none</span><span class="p">,</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">autobind</span><span class="p">,</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">anonymous</span><span class="w"> </span><span class="n">sockets</span><span class="o">.</span><span class="w">

   </span><span class="nc">Unix</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">permissions</span><span class="w">

   </span><span class="nc">Unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accumulated</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">union</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w">

   </span><span class="nc">Unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">broad</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">restrictive</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">down</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p" data-group-id="0401452079-9">(</span><span class="n">aka</span><span class="w"> </span><span class="n">sun_path</span><span class="p" data-group-id="0401452079-9">)</span><span class="w">
   </span><span class="ow">and</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="n">level</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">communication</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">examined</span><span class="o">.</span><span class="w">

   </span><span class="nc">Unix</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w">
   </span><span class="n">compatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">implied</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">create</span><span class="p">,</span><span class="w"> </span><span class="n">bind</span><span class="p">,</span><span class="w"> </span><span class="n">listen</span><span class="p">,</span><span class="w"> </span><span class="n">shutdown</span><span class="p">,</span><span class="w"> </span><span class="n">getattr</span><span class="p">,</span><span class="w"> </span><span class="n">setattr</span><span class="p">,</span><span class="w"> </span><span class="n">getopt</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">setopt</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">permissions</span><span class="o">.</span><span class="w"> </span><span class="nc">They</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="sc">&#39;t be specified
   in rules that have a peer component. The accept permission applies to the combination of a local and peer socket. The connect, send, and receive permissions are peer socket
   permissions.

   Only the peer socket permissions will be applied to rules that don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">component</span><span class="o">.</span><span class="w">

   </span><span class="nc">Example</span><span class="w"> </span><span class="nc">Unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="ss">rules</span><span class="p">:</span><span class="w">

     </span><span class="c1"># Allow all permissions to unix sockets</span><span class="w">
     </span><span class="n">unix</span><span class="p">,</span><span class="w">

     </span><span class="c1"># Explicitly allow all unix permissions</span><span class="w">
     </span><span class="n">unix</span><span class="w"> </span><span class="p" data-group-id="0401452079-10">(</span><span class="n">create</span><span class="p">,</span><span class="w"> </span><span class="n">listen</span><span class="p">,</span><span class="w"> </span><span class="n">accept</span><span class="p">,</span><span class="w"> </span><span class="n">connect</span><span class="p">,</span><span class="w"> </span><span class="n">send</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="p">,</span><span class="w"> </span><span class="n">getattr</span><span class="p">,</span><span class="w"> </span><span class="n">setattr</span><span class="p">,</span><span class="w"> </span><span class="n">setopt</span><span class="p">,</span><span class="w"> </span><span class="n">getopt</span><span class="p" data-group-id="0401452079-10">)</span><span class="p">,</span><span class="w">

     </span><span class="c1"># Explicitly deny unix socket access</span><span class="w">
     </span><span class="n">deny</span><span class="w"> </span><span class="n">unix</span><span class="p">,</span><span class="w">

     </span><span class="c1"># Allow create and use of abstract and anonymous sockets for profile_name</span><span class="w">
     </span><span class="n">unix</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="p" data-group-id="0401452079-11">(</span><span class="n">label</span><span class="o">=</span><span class="err">@</span><span class="p" data-group-id="0401452079-12">{</span><span class="n">profile_name</span><span class="p" data-group-id="0401452079-12">}</span><span class="p" data-group-id="0401452079-11">)</span><span class="p">,</span><span class="w">

     </span><span class="c1"># Allow receiving via unix sockets from unconfined</span><span class="w">
     </span><span class="n">unix</span><span class="w"> </span><span class="p" data-group-id="0401452079-13">(</span><span class="k">receive</span><span class="p" data-group-id="0401452079-13">)</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="p" data-group-id="0401452079-14">(</span><span class="n">label</span><span class="o">=</span><span class="n">unconfined</span><span class="p" data-group-id="0401452079-14">)</span><span class="p">,</span><span class="w">

     </span><span class="c1"># Allow getattr and shutdown on anonymous sockets</span><span class="w">
     </span><span class="n">unix</span><span class="w"> </span><span class="p" data-group-id="0401452079-15">(</span><span class="n">getattr</span><span class="p">,</span><span class="w"> </span><span class="n">shutdown</span><span class="p" data-group-id="0401452079-15">)</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="n">none</span><span class="p">,</span><span class="w">

     </span><span class="c1"># Allow SOCK_STREAM connect, receive and send on an abstract socket @bar</span><span class="w">
     </span><span class="c1"># with peer running under profile &#39;/foo&#39;</span><span class="w">
     </span><span class="n">unix</span><span class="w"> </span><span class="p" data-group-id="0401452079-16">(</span><span class="n">connect</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="p">,</span><span class="w"> </span><span class="n">send</span><span class="p" data-group-id="0401452079-16">)</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="n">stream</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="p" data-group-id="0401452079-17">(</span><span class="n">label</span><span class="o">=</span><span class="o">/</span><span class="n">foo</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="s">&quot;@bar&quot;</span><span class="p" data-group-id="0401452079-17">)</span><span class="p">,</span><span class="w">

     </span><span class="c1"># Allow accepting connections from and receiving from peer running under</span><span class="w">
     </span><span class="c1"># profile &#39;/bar&#39; on abstract socket &#39;@foo&#39;</span><span class="w">
     </span><span class="n">unix</span><span class="w"> </span><span class="p" data-group-id="0401452079-18">(</span><span class="n">accept</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="p" data-group-id="0401452079-18">)</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="na">@foo</span><span class="w"> </span><span class="n">peer</span><span class="o">=</span><span class="p" data-group-id="0401452079-19">(</span><span class="n">label</span><span class="o">=</span><span class="o">/</span><span class="n">bar</span><span class="p" data-group-id="0401452079-19">)</span><span class="p">,</span><span class="w">

   </span><span class="nc">Abstract</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">autobind</span><span class="w">

   </span><span class="nc">Abstract</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">autobind</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">autobind</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unique</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">digit</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="n">numbers</span><span class="p">,</span><span class="w"> </span><span class="n">eg</span><span class="o">.</span><span class="w"> </span><span class="err">@</span><span class="mi">00001</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">from</span><span class="w">
   </span><span class="n">manually</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">impossible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reliably</span><span class="w"> </span><span class="n">identify</span><span class="w"> </span><span class="n">autobind</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">

   </span><span class="nc">Interaction</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">fine</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">rules</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">coarse</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">fine</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">coarse</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rule</span><span class="w">
   </span><span class="n">is</span><span class="w"> </span><span class="n">mapped</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">rule</span><span class="o">.</span><span class="w">

   </span><span class="nc">E.G</span><span class="o">.</span><span class="w">

       </span><span class="n">network</span><span class="w"> </span><span class="n">unix</span><span class="p">,</span><span class="w">  </span><span class="p">=&gt;</span><span class="w">  </span><span class="n">unix</span><span class="p">,</span><span class="w">

       </span><span class="n">network</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">stream</span><span class="p">,</span><span class="w">   </span><span class="p">=&gt;</span><span class="w">  </span><span class="n">unix</span><span class="w"> </span><span class="n">stream</span><span class="p">,</span><span class="w">

   </span><span class="nc">Fine</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">mediation</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">losslessly</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">coarse</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rule</span><span class="p">;</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w">

      </span><span class="n">unix</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">addr</span><span class="o">=</span><span class="na">@example</span><span class="p">,</span><span class="w">

   </span><span class="nc">Has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">coarse</span><span class="w"> </span><span class="n">grained</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">rules</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">closest</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">wider</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">of</span><span class="w">

      </span><span class="n">network</span><span class="w"> </span><span class="n">unix</span><span class="p">,</span></code></pre><p>   change_profile rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="n">directed</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">transitions</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">change_profile</span><span class="w"> </span><span class="n">api</span><span class="o">.</span><span class="w"> </span><span class="nc">Change_profile</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">confined</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">transition</span><span class="w">
   </span><span class="n">to</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">apparmor</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w">

     </span><span class="n">change_profile</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="p">,</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">change_profile</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">delayed</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">executes</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">application</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">change_profile</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">change_profile</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">precedence</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="nc">Change_profile</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">restrict</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">transitioned</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">condition</span><span class="o">.</span><span class="w">

     </span><span class="n">change_profile</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">new_profile</span><span class="p">,</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">restricting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">decisions</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">confinement</span><span class="w">
   </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">decision</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">controlled</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

     </span><span class="n">change_profile</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="4839400649-1">{</span><span class="n">new_profile1</span><span class="p">,</span><span class="n">new_profile2</span><span class="p">,</span><span class="n">new_profile3</span><span class="p" data-group-id="4839400649-1">}</span><span class="p">,</span><span class="w">

   </span><span class="nc">An</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">executable</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">change_profile</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">transition</span><span class="w">
   </span><span class="k">for</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">change_profile</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

     </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span><span class="w"> </span><span class="nc">Px</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">new_profile1</span><span class="p">,</span><span class="w">
     </span><span class="n">change_profile</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="4839400649-2">{</span><span class="n">new_profile1</span><span class="p">,</span><span class="n">new_profile2</span><span class="p">,</span><span class="n">new_profile3</span><span class="p" data-group-id="4839400649-2">}</span><span class="p">,</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">dictates</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="nc">Kernel</span><span class="sc">&#39;s unsafe_exec routines should be used to scrub the environment, similar to setuid programs.  (See ld.so(8) for some
   information on setuid/setgid environment scrubbing.) The safe mode sets up environment scrubbing to occur when the new application is executed and unsafe mode disables AppArmor&#39;</span><span class="n">s</span><span class="w">
   </span><span class="n">requirement</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">scrubbing</span><span class="w"> </span><span class="p" data-group-id="4839400649-3">(</span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">libc</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">scrubbing</span><span class="p" data-group-id="4839400649-3">)</span><span class="o">.</span><span class="w"> </span><span class="nc">An</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="o">.</span><span class="w">

     </span><span class="n">change_profile</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">new_profile</span><span class="p">,</span><span class="w">

   </span><span class="nc">Not</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">kernels</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parser</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">downgrade</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">unsafe</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">situation</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kernels</span><span class="w"> </span><span class="n">that</span><span class="w">
   </span><span class="n">support</span><span class="w"> </span><span class="n">it</span><span class="o">.</span></code></pre><p>   rlimit rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">setrlimit</span><span class="p" data-group-id="5389126018-1">(</span><span class="mi">2</span><span class="p" data-group-id="5389126018-1">)</span><span class="w"> </span><span class="n">man</span><span class="w"> </span><span class="n">page</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">controls</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">restricting</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">audited</span><span class="o">.</span><span class="w"> </span><span class="nc">Enforcement</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w">
   </span><span class="n">kernel</span><span class="w"> </span><span class="n">enforcement</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">rlimits</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">audited</span><span class="w"> </span><span class="n">apparmor</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enforced</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">alone</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">access</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">changing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">limit</span><span class="p">,</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="o">.</span><span class="w"> </span><span class="nc">However</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="n">profile</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">checked</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">lowered</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">exceed</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">

   </span><span class="nc">Eg</span><span class="o">.</span><span class="w">

     </span><span class="n">set</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">100</span><span class="nc">M</span><span class="p">,</span><span class="w">
     </span><span class="n">set</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">nproc</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
     </span><span class="n">set</span><span class="w"> </span><span class="n">rlimit</span><span class="w"> </span><span class="n">nice</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span></code></pre><p>   Variables</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">language</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">embedding</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">easier</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="p" data-group-id="8170881121-1">(</span><span class="ow">and</span><span class="w"> </span><span class="n">pervasive</span><span class="p" data-group-id="8170881121-1">)</span><span class="w"> </span><span class="n">setups</span><span class="o">.</span><span class="w">  </span><span class="nc">Variables</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">values</span><span class="w">
   </span><span class="n">assigned</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">assignments</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">parser</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">expand</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">assigned</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w">
   </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">quotes</span><span class="w"> </span><span class="p" data-group-id="8170881121-2">(</span><span class="s">&quot;&quot;</span><span class="p" data-group-id="8170881121-2">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">

   </span><span class="nc">At</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">writing</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="ss">policy</span><span class="p">:</span><span class="w">

     </span><span class="err">@</span><span class="p" data-group-id="8170881121-3">{</span><span class="nc">HOME</span><span class="p" data-group-id="8170881121-3">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-4">{</span><span class="nc">HOMEDIRS</span><span class="p" data-group-id="8170881121-4">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-5">{</span><span class="n">multiarch</span><span class="p" data-group-id="8170881121-5">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-6">{</span><span class="n">pid</span><span class="p" data-group-id="8170881121-6">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-7">{</span><span class="n">pids</span><span class="p" data-group-id="8170881121-7">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-8">{</span><span class="nc">PROC</span><span class="p" data-group-id="8170881121-8">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-9">{</span><span class="n">securityfs</span><span class="p" data-group-id="8170881121-9">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-10">{</span><span class="n">apparmorfs</span><span class="p" data-group-id="8170881121-10">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-11">{</span><span class="n">sys</span><span class="p" data-group-id="8170881121-11">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-12">{</span><span class="n">tid</span><span class="p" data-group-id="8170881121-12">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-13">{</span><span class="n">run</span><span class="p" data-group-id="8170881121-13">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-14">{</span><span class="nc">XDG_DESKTOP_DIR</span><span class="p" data-group-id="8170881121-14">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-15">{</span><span class="nc">XDG_DOWNLOAD_DIR</span><span class="p" data-group-id="8170881121-15">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-16">{</span><span class="nc">XDG_TEMPLATES_DIR</span><span class="p" data-group-id="8170881121-16">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-17">{</span><span class="nc">XDG_PUBLICSHARE_DIR</span><span class="p" data-group-id="8170881121-17">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-18">{</span><span class="nc">XDG_DOCUMENTS_DIR</span><span class="p" data-group-id="8170881121-18">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-19">{</span><span class="nc">XDG_MUSIC_DIR</span><span class="p" data-group-id="8170881121-19">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-20">{</span><span class="nc">XDG_PICTURES_DIR</span><span class="p" data-group-id="8170881121-20">}</span><span class="w">
     </span><span class="err">@</span><span class="p" data-group-id="8170881121-21">{</span><span class="nc">XDG_VIDEOS_DIR</span><span class="p" data-group-id="8170881121-21">}</span><span class="w">

   </span><span class="nc">These</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">abstractions</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="n">later</span><span class="o">.</span><span class="w">

   </span><span class="nc">You</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="o">/</span><span class="n">home</span><span class="o">.</span><span class="n">d</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">site</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">customization</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="8170881121-22">{</span><span class="nc">HOMEDIRS</span><span class="p" data-group-id="8170881121-22">}</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="o">/</span><span class="n">multiarch</span><span class="o">.</span><span class="n">d</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="8170881121-23">{</span><span class="n">multiarch</span><span class="p" data-group-id="8170881121-23">}</span><span class="w"> </span><span class="ow">and</span><span class="w">
   </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="o">/</span><span class="n">xdg</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">dirs</span><span class="o">.</span><span class="n">d</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="8170881121-24">{</span><span class="nc">XDG_</span><span class="o">*</span><span class="p" data-group-id="8170881121-24">}</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="8170881121-25">{</span><span class="n">profile_name</span><span class="p" data-group-id="8170881121-25">}</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">policy</span><span class="o">.</span></code></pre><p>   Alias rules</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">remapping</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">site</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">layouts</span><span class="o">.</span><span class="w"> </span><span class="nc">They</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">alternative</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">rewriting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">variables</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">variable</span><span class="w">
   </span><span class="n">resolution</span><span class="o">.</span><span class="w"> </span><span class="nc">Alias</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">occur</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">preamble</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w"> </span><span class="nc">System</span><span class="o">-</span><span class="n">wide</span><span class="w"> </span><span class="n">aliases</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="o">/</span><span class="kn">alias</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">by</span><span class="w">
   </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="o">/</span><span class="n">global</span><span class="o">.</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="o">/</span><span class="n">global</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">beginning</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span></code></pre><p>   Globbing</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">File</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">globbing</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">popular</span><span class="w"> </span><span class="n">shells</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">csh</span><span class="p" data-group-id="6793593706-1">(</span><span class="mi">1</span><span class="p" data-group-id="6793593706-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">bash</span><span class="p" data-group-id="6793593706-2">(</span><span class="mi">1</span><span class="p" data-group-id="6793593706-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">zsh</span><span class="p" data-group-id="6793593706-3">(</span><span class="mi">1</span><span class="p" data-group-id="6793593706-3">)</span><span class="o">.</span><span class="w">

   </span><span class="o">*</span><span class="w">   </span><span class="n">can</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="p">,</span><span class="w"> </span><span class="n">excepting</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w">

   </span><span class="o">*</span><span class="o">*</span><span class="w">  </span><span class="n">can</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w">

   </span><span class="sc">? </span><span class="w">  </span><span class="n">can</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">excepting</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w">

   </span><span class="p" data-group-id="6793593706-4">[</span><span class="n">abc</span><span class="p" data-group-id="6793593706-4">]</span><span class="w">
       </span><span class="n">will</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">c</span><span class="w">

   </span><span class="p" data-group-id="6793593706-5">[</span><span class="n">a</span><span class="o">-</span><span class="n">c</span><span class="p" data-group-id="6793593706-5">]</span><span class="w">
       </span><span class="n">will</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">c</span><span class="w">

   </span><span class="p" data-group-id="6793593706-6">[</span><span class="o">^</span><span class="n">a</span><span class="o">-</span><span class="n">c</span><span class="p" data-group-id="6793593706-6">]</span><span class="w">
       </span><span class="n">will</span><span class="w"> </span><span class="n">substitute</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">c</span><span class="w">

   </span><span class="p" data-group-id="6793593706-7">{</span><span class="n">ab</span><span class="p">,</span><span class="n">cd</span><span class="p" data-group-id="6793593706-7">}</span><span class="w">
       </span><span class="n">will</span><span class="w"> </span><span class="n">expand</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">ab</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">cd</span><span class="w">

   </span><span class="nc">When</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">looks</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pathname</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">looked</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">slash</span><span class="w"> </span><span class="p" data-group-id="6793593706-8">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="p" data-group-id="6793593706-8">)</span><span class="p">;</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">slash</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">trailing</span><span class="w">
   </span><span class="n">slash</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">directories</span><span class="o">.</span><span class="w"> </span><span class="nc">Some</span><span class="w"> </span><span class="n">examples</span><span class="p">,</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">itself</span><span class="p">,</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w">

   </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="o">*</span><span class="w">
       </span><span class="nc">Files</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">.</span><span class="w">

   </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="o">*</span><span class="o">/</span><span class="w">
       </span><span class="nc">Directories</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">.</span><span class="w">

   </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="w">
       </span><span class="nc">Files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">directories</span><span class="w"> </span><span class="n">anywhere</span><span class="w"> </span><span class="n">underneath</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">.</span><span class="w">

   </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="o">/</span><span class="w">
       </span><span class="nc">Directories</span><span class="w"> </span><span class="n">anywhere</span><span class="w"> </span><span class="n">underneath</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">.</span></code></pre><p>   Rule Qualifiers</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">There</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">qualifiers</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">  </span><span class="nc">Rule</span><span class="w"> </span><span class="n">qualifiers</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">modify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="o">.</span><span class="w">

   </span><span class="n">allow</span><span class="w">
       </span><span class="nc">Specifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">allowed</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w"> </span><span class="nc">Conflicts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">qualifier</span><span class="o">.</span><span class="w">

   </span><span class="n">audit</span><span class="w">
       </span><span class="nc">Specifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">recorded</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">log</span><span class="o">.</span><span class="w">

   </span><span class="n">deny</span><span class="w">
       </span><span class="nc">Specifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">denied</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">logging</span><span class="o">.</span><span class="w"> </span><span class="nc">Can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="sc">&#39;audit&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">logging</span><span class="o">.</span><span class="w"> </span><span class="nc">Conflicts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">qualifier</span><span class="o">.</span><span class="w">

   </span><span class="n">owner</span><span class="w">
       </span><span class="nc">Specifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">euid</span><span class="o">/</span><span class="n">fsuid</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">referenced</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="n">check</span><span class="o">.</span><span class="w">

   </span><span class="nc">Qualifier</span><span class="w"> </span><span class="nc">Blocks</span><span class="w">

   </span><span class="nc">Rule</span><span class="w"> </span><span class="nc">Qualifiers</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">grouping</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">block</span><span class="o">.</span><span class="w">

     </span><span class="n">audit</span><span class="w"> </span><span class="p" data-group-id="5076671542-1">{</span><span class="w">
        </span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w">
        </span><span class="n">network</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="5076671542-1">}</span></code></pre><p>   #include mechanism</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="n">abstraction</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">requirements</span><span class="p">;</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">abstraction</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">extremely</span><span class="w"> </span><span class="n">flexible</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">grant</span><span class="w"> </span><span class="n">site</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">rights</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">writing</span><span class="w">
   </span><span class="n">new</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">assembling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">building</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">program</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="sc">&#39;#include&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">modelled</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">cpp</span><span class="p" data-group-id="0221043432-1">(</span><span class="mi">1</span><span class="p" data-group-id="0221043432-1">)</span><span class="p">;</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;#include&#39;</span><span class="w"> </span><span class="n">statement</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">file</span><span class="sc">&#39;s contents.  The leading &#39;</span><span class="c1">#&#39; is optional, and the</span><span class="w">
   </span><span class="sc">&#39;#include&#39;</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="sc">&#39;if exists&#39;</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">compilation</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">continue</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">found</span><span class="o">.</span><span class="w">

   </span><span class="c1">#include &quot;/absolute/path&quot; specifies that /absolute/path should be used.  #include &quot;relative/path&quot; specifies that relative/path should be used, where the path is relative to the</span><span class="w">
   </span><span class="n">current</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span><span class="w">  </span><span class="c1">#include &lt;magic/path&gt; is the most common usage; it will load magic/path relative to a directory specified to apparmor_parser(8).  /etc/apparmor.d/ is</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">conventions</span><span class="p">;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">abstractions</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">abstractions</span><span class="o">/</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">clusters</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w"> </span><span class="nc">What</span><span class="w">
   </span><span class="n">follows</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">short</span><span class="w"> </span><span class="n">descriptions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">abstractions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">audio</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">accesses</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">audio</span><span class="w"> </span><span class="n">applications</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">authentication</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">services</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">necessary</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">services</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">authentication</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">base</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">readable</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">writable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">bash</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">bash</span><span class="p">;</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">interactive</span><span class="w"> </span><span class="n">shells</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">system</span><span class="p" data-group-id="0221043432-2">(</span><span class="mi">3</span><span class="p" data-group-id="0221043432-2">)</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">consoles</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">controlling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">console</span><span class="p">,</span><span class="w"> </span><span class="n">sshd</span><span class="p" data-group-id="0221043432-3">(</span><span class="mi">8</span><span class="p" data-group-id="0221043432-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">xterm</span><span class="p" data-group-id="0221043432-4">(</span><span class="mi">1</span><span class="p" data-group-id="0221043432-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">abstraction</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">interact</span><span class="w"> </span><span class="k">with</span><span class="w">
       </span><span class="n">users</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">fonts</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">fonts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="n">libraries</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">gnome</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">GNOME</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">GNOME</span><span class="w"> </span><span class="n">libraries</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">kde</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">KDE</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">KDE</span><span class="w"> </span><span class="n">libraries</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">kerberosclient</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">kerberos</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">nameservice</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="nc">DNS</span><span class="p">,</span><span class="w"> </span><span class="nc">LDAP</span><span class="p">,</span><span class="w"> </span><span class="nc">NIS</span><span class="p">,</span><span class="w"> </span><span class="nc">SMB</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">databases</span><span class="p">,</span><span class="w"> </span><span class="n">services</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="n">lookups</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">perl</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perl</span><span class="w"> </span><span class="n">modules</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">user</span><span class="o">-</span><span class="n">download</span><span class="w">
   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">user</span><span class="o">-</span><span class="n">mail</span><span class="w">
   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">user</span><span class="o">-</span><span class="n">manpages</span><span class="w">
   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">user</span><span class="o">-</span><span class="n">tmp</span><span class="w">
   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">user</span><span class="o">-</span><span class="n">write</span><span class="w">
       </span><span class="nc">Some</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">typical</span><span class="w"> </span><span class="s">&quot;user&quot;</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">describe</span><span class="w"> </span><span class="n">rights</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="n">wutmp</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">maintain</span><span class="w"> </span><span class="n">wtmp</span><span class="p" data-group-id="0221043432-5">(</span><span class="mi">5</span><span class="p" data-group-id="0221043432-5">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">utmp</span><span class="p" data-group-id="0221043432-6">(</span><span class="mi">5</span><span class="p" data-group-id="0221043432-6">)</span><span class="w"> </span><span class="n">databases</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">w</span><span class="p" data-group-id="0221043432-7">(</span><span class="mi">1</span><span class="p" data-group-id="0221043432-7">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="n">commands</span><span class="o">.</span><span class="w">

   </span><span class="n">abstractions</span><span class="o">/</span><span class="nc">X</span><span class="w">
       </span><span class="nc">Includes</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">libraries</span><span class="p">,</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="nc">X</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">X</span><span class="w"> </span><span class="n">socket</span><span class="o">.</span><span class="w">

   </span><span class="nc">Some</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">abstractions</span><span class="w"> </span><span class="n">rely</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">tunables</span><span class="o">/</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span><span class="w"> </span><span class="nc">These</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="0221043432-8">{</span><span class="nc">HOME</span><span class="p" data-group-id="0221043432-8">}</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="0221043432-9">{</span><span class="nc">HOMEDIRS</span><span class="p" data-group-id="0221043432-9">}</span><span class="o">.</span><span class="w"> </span><span class="nc">Variables</span><span class="w">
   </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">scope</span><span class="p">;</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w"> </span><span class="nc">Therefore</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">abstractions</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="c1">#include &lt;tunables/global&gt; or otherwise ensure</span><span class="w">
   </span><span class="n">that</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="0221043432-10">{</span><span class="nc">HOME</span><span class="p" data-group-id="0221043432-10">}</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">@</span><span class="p" data-group-id="0221043432-11">{</span><span class="nc">HOMEDIRS</span><span class="p" data-group-id="0221043432-11">}</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">definition</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">aa</span><span class="o">-</span><span class="n">autodep</span><span class="p" data-group-id="0221043432-12">(</span><span class="mi">8</span><span class="p" data-group-id="0221043432-12">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">aa</span><span class="o">-</span><span class="n">genprof</span><span class="p" data-group-id="0221043432-13">(</span><span class="mi">8</span><span class="p" data-group-id="0221043432-13">)</span><span class="w"> </span><span class="n">utilities</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">emit</span><span class="w"> </span><span class="c1">#include &lt;tunables/global&gt; in</span><span class="w">
   </span><span class="n">generated</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span></code></pre><p>   Feature ABI</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">abi</span><span class="w"> </span><span class="n">tells</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">developed</span><span class="w"> </span><span class="n">under</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">kernels</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t enforce features that
   the policy doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">support</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">unexpected</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">failures</span><span class="o">.</span><span class="w">

   </span><span class="nc">When</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">abi</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">abi</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">consulted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="sc">&#39;s kernel.

   If the kernel supports a feature not supported by the policy then policy will be built so that the kernel does NOT enforce that feature.

   If the policy supports a feature not supported by the kernel the compile may downgrade the rule with the feature to something the kernel supports, drop the rule completely, or
   fail the compile.

   If the policy abi is specified as kernel then the running kernel&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">abi</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">shipped</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">breakage</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">kernel</span><span class="w">
   </span><span class="n">is</span><span class="w"> </span><span class="n">installed</span><span class="o">.</span><span class="w">

   </span><span class="nc">ABI</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="mi">2</span><span class="o">.</span><span class="n">x</span><span class="w">

   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">remains</span><span class="w"> </span><span class="n">compatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="mi">2</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">detecting</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="nc">ABI</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pinned</span><span class="w">
   </span><span class="n">feature</span><span class="w"> </span><span class="nc">ABI</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">neither</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="nc">ABI</span><span class="o">.</span><span class="w">

   </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="nc">ABI</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">later</span><span class="o">.</span></code></pre><p>EXAMPLE</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">An</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="nc">AppArmor</span><span class="w"> </span><span class="ss">profile</span><span class="p">:</span><span class="w">

           </span><span class="c1"># which feature abi the policy was developed with</span><span class="w">
           </span><span class="n">abi</span><span class="w"> </span><span class="o">&lt;</span><span class="n">abi</span><span class="o">/</span><span class="mf">3.0</span><span class="o">&gt;</span><span class="p">,</span><span class="w">

           </span><span class="c1"># a variable definition in the preamble</span><span class="w">
           </span><span class="err">@</span><span class="p" data-group-id="7388794973-1">{</span><span class="nc">HOME</span><span class="p" data-group-id="7388794973-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="o">*</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="w">

           </span><span class="c1"># a comment about foo.</span><span class="w">
           </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">foo</span><span class="w"> </span><span class="p" data-group-id="7388794973-2">{</span><span class="w">
             </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">mount</span><span class="w">          </span><span class="n">ux</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="p" data-group-id="7388794973-3">{</span><span class="p">,</span><span class="n">u</span><span class="p" data-group-id="7388794973-3">}</span><span class="n">random</span><span class="w">     </span><span class="n">r</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="n">cache</span><span class="w">    </span><span class="n">r</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="n">conf</span><span class="w">       </span><span class="n">r</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="o">*</span><span class="w">          </span><span class="n">r</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="o">*</span><span class="o">.</span><span class="n">so</span><span class="o">*</span><span class="w">       </span><span class="n">rmix</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">lib</span><span class="o">*</span><span class="o">.</span><span class="n">so</span><span class="o">*</span><span class="w">       </span><span class="n">r</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="p" data-group-id="7388794973-4">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p" data-group-id="7388794973-4">]</span><span class="o">*</span><span class="o">*</span><span class="w">       </span><span class="n">r</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="o">*</span><span class="o">*</span><span class="w">         </span><span class="n">r</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="n">pid</span><span class="w">        </span><span class="n">wr</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="o">*</span><span class="w">          </span><span class="n">lrw</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="err">@</span><span class="p" data-group-id="7388794973-5">{</span><span class="nc">HOME</span><span class="p" data-group-id="7388794973-5">}</span><span class="o">/</span><span class="o">.</span><span class="n">foo_file</span><span class="w">  </span><span class="n">rw</span><span class="p">,</span><span class="w">
             </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">baz</span><span class="w">        </span><span class="nc">Cx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">baz</span><span class="p">,</span><span class="w">

             </span><span class="c1"># a comment about foo&#39;s hat (subprofile), bar.</span><span class="w">
             </span><span class="o">^</span><span class="n">bar</span><span class="w"> </span><span class="p" data-group-id="7388794973-6">{</span><span class="w">
               </span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="o">*</span><span class="o">.</span><span class="n">so</span><span class="o">*</span><span class="w">       </span><span class="n">rmix</span><span class="p">,</span><span class="w">
               </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bar</span><span class="w">        </span><span class="n">rmix</span><span class="p">,</span><span class="w">
               </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="o">*</span><span class="w">        </span><span class="n">rwl</span><span class="p">,</span><span class="w">
             </span><span class="p" data-group-id="7388794973-6">}</span><span class="w">

             </span><span class="c1"># a comment about foo&#39;s subprofile, baz.</span><span class="w">
             </span><span class="n">profile</span><span class="w"> </span><span class="n">baz</span><span class="w"> </span><span class="p" data-group-id="7388794973-7">{</span><span class="w">
               </span><span class="c1">#include &lt;abstractions/bash&gt;</span><span class="w">
               </span><span class="n">owner</span><span class="w"> </span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="p" data-group-id="7388794973-8">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p" data-group-id="7388794973-8">]</span><span class="o">*</span><span class="o">/</span><span class="n">stat</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w">
               </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span><span class="w"> </span><span class="n">ixr</span><span class="p">,</span><span class="w">
               </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">baz</span><span class="o">/</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w">
               </span><span class="n">owner</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">baz</span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">rw</span><span class="p">,</span><span class="w">
             </span><span class="p" data-group-id="7388794973-7">}</span><span class="w">
           </span><span class="p" data-group-id="7388794973-2">}</span></code></pre><p>FILES</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">boot</span><span class="o">.</span><span class="n">apparmor</span><span class="w">
   </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="o">.</span><span class="n">d</span><span class="o">/</span></code></pre><p>KNOWN BUGS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="err">â€¢</span><span class="w">   </span><span class="nc">Mount</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">correctly</span><span class="w"> </span><span class="n">intersected</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">patterns</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;mount options=**,&#39;</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w">
       </span><span class="sc">&#39;mount,&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="6573819365-1">(</span><span class="ss">LP</span><span class="p">:</span><span class="w"> </span><span class="c1">#965690)</span><span class="w">

   </span><span class="err">â€¢</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">fstype</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">matched</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">Specifically</span><span class="w"> </span><span class="n">fstype</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">remount</span><span class="p">,</span><span class="w">
       </span><span class="n">bind</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="w">

   </span><span class="err">â€¢</span><span class="w">   </span><span class="nc">Mount</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="sc">&#39;options&#39;</span><span class="w"> </span><span class="n">conditionals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">documented</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">merged</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="sc">&#39;options in (ro,nodev) options in (atime)&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w">
       </span><span class="sc">&#39;options in (ro,nodev,atime)&#39;</span><span class="o">.</span><span class="w">

   </span><span class="err">â€¢</span><span class="w">   </span><span class="nc">When</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;in&#39;</span><span class="w"> </span><span class="n">conditional</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">negative</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="o">.</span><span class="w"> </span><span class="nc">Eg</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;rw&#39;</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="sc">&#39;ro&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w">
       </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;dev&#39;</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="sc">&#39;nodev&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="sc">&#39;options in (ro,nodev)&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="sc">&#39;options in (rw,dev)&#39;</span><span class="o">.</span></code></pre><p>SEE ALSO</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">apparmor</span><span class="p" data-group-id="6971694855-1">(</span><span class="mi">7</span><span class="p" data-group-id="6971694855-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">apparmor_parser</span><span class="p" data-group-id="6971694855-2">(</span><span class="mi">8</span><span class="p" data-group-id="6971694855-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">apparmor_xattrs</span><span class="p" data-group-id="6971694855-3">(</span><span class="mi">7</span><span class="p" data-group-id="6971694855-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">aa</span><span class="o">-</span><span class="n">complain</span><span class="p" data-group-id="6971694855-4">(</span><span class="mi">1</span><span class="p" data-group-id="6971694855-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">aa</span><span class="o">-</span><span class="n">enforce</span><span class="p" data-group-id="6971694855-5">(</span><span class="mi">1</span><span class="p" data-group-id="6971694855-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">aa_change_hat</span><span class="p" data-group-id="6971694855-6">(</span><span class="mi">2</span><span class="p" data-group-id="6971694855-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">mod_apparmor</span><span class="p" data-group-id="6971694855-7">(</span><span class="mi">5</span><span class="p" data-group-id="6971694855-7">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span><span class="ss">://</span><span class="n">wiki</span><span class="o">.</span><span class="n">apparmor</span><span class="o">.</span><span class="n">net</span><span class="o">&gt;</span><span class="o">.</span></code></pre><p>AppArmor 3.0.8                                                                          2023-02-14                                                                           APPARMOR.D(5)</p>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="american-english.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          â† Previous Page
        </span>
        <span class="title">
american-english
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="apparmor-vim.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page â†’
        </span>
        <span class="title">
apparmor.vim
        </span>
      </a>

  </div>
</div>
      <footer class="footer">
        <p>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
              Search HexDocs
            </button>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.4) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
