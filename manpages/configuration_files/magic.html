<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="Manpages v3.0.0">


    <title>magic — Manpages v3.0.0</title>

    <link rel="stylesheet" href="dist/html-elixir-KV3YOVJ3.css" />

    <script defer src="dist/sidebar_items-23381D40.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>
<link rel="stylesheet" href="assets/doc.css">
  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Manpages" />
        </a>

      <div>
        <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectName" translate="no">
Manpages
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v3.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras="MANUALS"></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Manpages</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>magic</h1>


  </div>


<p>MAGIC(5)                                                                              File Formats Manual                                                                             MAGIC(5)</p><p>NAME</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">magic</span><span class="w"> </span><span class="err">—</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">command</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">file</span></code></pre><p>DESCRIPTION</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">This</span><span class="w">  </span><span class="n">manual</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">documents</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="p" data-group-id="6944391485-1">(</span><span class="mi">1</span><span class="p" data-group-id="6944391485-1">)</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">5.46</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">file</span><span class="p" data-group-id="6944391485-2">(</span><span class="mi">1</span><span class="p" data-group-id="6944391485-2">)</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">identifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">using</span><span class="p">,</span><span class="w"> </span><span class="n">among</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">test</span><span class="w">
   </span><span class="k">for</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="err">“</span><span class="n">magic</span><span class="w"> </span><span class="n">patterns</span><span class="err">”</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">database</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="err">“</span><span class="n">magic</span><span class="w"> </span><span class="n">patterns</span><span class="err">”</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">usually</span><span class="w"> </span><span class="n">located</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">magic</span><span class="o">.</span><span class="n">mgc</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">directory</span><span class="w">  </span><span class="n">of</span><span class="w">
   </span><span class="n">source</span><span class="w">  </span><span class="n">text</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">magic</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">database</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">patterns</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">tested</span><span class="w"> </span><span class="k">for</span><span class="p">,</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">MIME</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">pat</span><span class="err">‐</span><span class="w">
   </span><span class="n">tern</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">found</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">extract</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">database</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w"> </span><span class="nc">Each</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">performed</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">test</span><span class="w">  </span><span class="n">compares</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">data</span><span class="w">
   </span><span class="n">starting</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">succeeds</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">fields</span><span class="p">:</span><span class="w">

   </span><span class="n">offset</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="p" data-group-id="6944391485-3">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="6944391485-3">)</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">tested</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">negative</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ss">is</span><span class="p">:</span><span class="w">
            </span><span class="err">•</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">direct</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="p" data-group-id="6944391485-4">(</span><span class="n">at</span><span class="w"> </span><span class="n">continuation</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="6944391485-4">)</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">backwards</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">only</span><span class="w">
                </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">
            </span><span class="err">•</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">continuation</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">up</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="p" data-group-id="6944391485-5">(</span><span class="o">&amp;</span><span class="p" data-group-id="6944391485-5">)</span><span class="o">.</span><span class="w">
            </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="err">“</span><span class="o">+</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">offsets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">beginning</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="6944391485-6">(</span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="p" data-group-id="6944391485-6">)</span><span class="o">.</span><span class="w">

   </span><span class="n">type</span><span class="w">     </span><span class="nc">The</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">tested</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w">

            </span><span class="n">byte</span><span class="w">        </span><span class="nc">A</span><span class="w"> </span><span class="n">one</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">

            </span><span class="n">short</span><span class="w">       </span><span class="nc">A</span><span class="w"> </span><span class="n">two</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">machine</span><span class="sc">&#39;s native byte order.

            long        A four-byte value in this machine&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">native</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="w">

            </span><span class="n">quad</span><span class="w">        </span><span class="nc">An</span><span class="w"> </span><span class="n">eight</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">machine</span><span class="sc">&#39;s native byte order.

            float       A 32-bit single precision IEEE floating point number in this machine&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">native</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="w">

            </span><span class="n">double</span><span class="w">      </span><span class="nc">A</span><span class="w"> </span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">precision</span><span class="w"> </span><span class="nc">IEEE</span><span class="w"> </span><span class="n">floating</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">machine</span><span class="sc">&#39;s native byte order.

            string      A  string  of  bytes.  The string type specification can be optionally followed by a /&lt;width&gt; option and optionally followed by a set of flags /[bCcftTtWw]*.  The
                        width limits the number of characters to be copied.  Zero means all characters.  The following flags are supported:
                            b  Force binary file test.
                            C  Use upper case insensitive matching: upper case characters in the magic match both lower and upper case characters in the target, whereas lower case  char‐
                               acters in the magic only match upper case characters in the target.
                            c  Use  lower case insensitive matching: lower case characters in the magic match both lower and upper case characters in the target, whereas upper case char‐
                               acters in the magic only match upper case characters in the target.  To do a complete case insensitive match, specify both “c” and “C”.
                            f  Require that the matched string is a full word, not a partial word match.
                            T  Trim the string, i.e. leading and trailing whitespace
                            t  Force text file test.
                            W  Compact whitespace in the target, which must contain at least one whitespace character.  If the magic has n consecutive blanks, the target needs at least n
                               consecutive blanks to match.
                            w  Treat every blank in the magic as an optional blank.  is deleted before the string is printed.

            pstring     A Pascal-style string where the first byte/short/int is interpreted as the unsigned length.  The length defaults to byte and can be specified as a modifier.   The
                        following modifiers are supported:
                            B  A byte length (default).
                            H  A 2 byte big endian length.
                            h  A 2 byte little endian length.
                            L  A 4 byte big endian length.
                            l  A 4 byte little endian length.
                            J  The length includes itself in its count.
                        The string is not NUL terminated.  “J” is used rather than the more valuable “I” because this type of length is a feature of the JPEG format.

            date        A four-byte value interpreted as a UNIX date.

            qdate       An eight-byte value interpreted as a UNIX date.

            ldate       A four-byte value interpreted as a UNIX-style date, but interpreted as local time rather than UTC.

            qldate      An eight-byte value interpreted as a UNIX-style date, but interpreted as local time rather than UTC.

            qwdate      An eight-byte value interpreted as a Windows-style date.

            msdosdate   A two-byte value interpreted as FAT/DOS-style date.

            msdostime   A two-byte value interpreted as FAT/DOS-style time.

            beid3       A 32-bit ID3 length in big-endian byte order.

            beshort     A two-byte value in big-endian byte order.

            belong      A four-byte value in big-endian byte order.

            bequad      An eight-byte value in big-endian byte order.

            befloat     A 32-bit single precision IEEE floating point number in big-endian byte order.

            bedouble    A 64-bit double precision IEEE floating point number in big-endian byte order.

            bedate      A four-byte value in big-endian byte order, interpreted as a Unix date.

            beqdate     An eight-byte value in big-endian byte order, interpreted as a Unix date.

            beldate     A four-byte value in big-endian byte order, interpreted as a UNIX-style date, but interpreted as local time rather than UTC.

            beqldate    An eight-byte value in big-endian byte order, interpreted as a UNIX-style date, but interpreted as local time rather than UTC.

            beqwdate    An eight-byte value in big-endian byte order, interpreted as a Windows-style date.

            bemsdosdate
                        A two-byte value in big-endian byte order, interpreted as FAT/DOS-style date.

            bemsdostime
                        A two-byte value in big-endian byte order, interpreted as FAT/DOS-style time.

            bestring16  A two-byte unicode (UCS16) string in big-endian byte order.

            leid3       A 32-bit ID3 length in little-endian byte order.

            leshort     A two-byte value in little-endian byte order.

            lelong      A four-byte value in little-endian byte order.

            lequad      An eight-byte value in little-endian byte order.

            lefloat     A 32-bit single precision IEEE floating point number in little-endian byte order.

            ledouble    A 64-bit double precision IEEE floating point number in little-endian byte order.

            ledate      A four-byte value in little-endian byte order, interpreted as a UNIX date.

            leqdate     An eight-byte value in little-endian byte order, interpreted as a UNIX date.

            leldate     A four-byte value in little-endian byte order, interpreted as a UNIX-style date, but interpreted as local time rather than UTC.

            leqldate    An eight-byte value in little-endian byte order, interpreted as a UNIX-style date, but interpreted as local time rather than UTC.

            leqwdate    An eight-byte value in little-endian byte order, interpreted as a Windows-style date.

            lemsdosdate
                        A two-byte value in big-endian byte order, interpreted as FAT/DOS-style date.

            lemsdostime
                        A two-byte value in big-endian byte order, interpreted as FAT/DOS-style time.

            lestring16  A two-byte unicode (UCS16) string in little-endian byte order.

            melong      A four-byte value in middle-endian (PDP-11) byte order.

            medate      A four-byte value in middle-endian (PDP-11) byte order, interpreted as a UNIX date.

            meldate     A four-byte value in middle-endian (PDP-11) byte order, interpreted as a UNIX-style date, but interpreted as local time rather than UTC.

            indirect    Starting  at  the  given offset, consult the magic database again.  The offset of the indirect magic is by default absolute in the file, but one can specify /r to
                        indicate that the offset is relative from the beginning of the entry.

            name        Define a “named” magic instance that can be called from another use magic entry, like a subroutine call.  Named instance direct magic offsets are relative to  the
                        offset of the previous matched entry, but indirect offsets are relative to the beginning of the file as usual.  Named magic entries always match.

            use         Recursively call the named magic starting from the current offset.  If the name of the referenced begins with a ^ then the endianness of the magic is switched; if
                        the magic mentioned leshort for example, it is treated as beshort and vice versa.  This is useful to avoid duplicating the rules for different endianness.

            regex       A  regular expression match in extended POSIX regular expression syntax (like egrep).  Regular expressions can take exponential time to process, and their perfor‐
                        mance is hard to predict, so their use is discouraged.  When used in production environments, their performance should be carefully  checked.   The  size  of  the
                        string  to  search should also be limited by specifying /&lt;length&gt;, to avoid performance issues scanning long files.  The type specification can also be optionally
                        followed by /[c][s][l].  The “c” flag makes the match case insensitive, while the “s” flag update the offset to the start offset of the  match,  rather  than  the
                        end.   The “l” modifier, changes the limit of length to mean number of lines instead of a byte count.  Lines are delimited by the platforms native line delimiter.
                        When a line count is specified, an implicit byte count also computed assuming each line is 80 characters long.  If neither a byte or line count is specified,  the
                        search is limited automatically to 8KiB.  ^ and $ match the beginning and end of individual lines, respectively, not beginning and end of file.

            search      A  literal  string search starting at the given offset.  The same modifier flags can be used as for string patterns.  The search expression must contain the range
                        in the form /number, that is the number of positions at which the match will be attempted, starting from the start offset.  This is suitable for searching  larger
                        binary expressions with variable offsets, using </span><span class="se">\ </span><span class="sc">escapes for special characters.  The order of modifier and number is not relevant.

            default     This  is  intended to be used with the test x (which is always true) and it has no type.  It matches when no other test at that continuation level has matched be‐
                        fore.  Clearing that matched tests for a continuation level, can be done using the clear test.

            clear       This test is always true and clears the match flag for that continuation level.  It is intended to be used with the default test.

            der         Parse the file as a DER Certificate file.  The test field is used as a der type that needs to be matched.  The DER types are: eoc, bool, int, bit_str,  octet_str,
                        null,  obj_id, obj_desc, ext, real, enum, embed, utf8_str, rel_oid, time, res2, seq, set, num_str, prt_str, t61_str, vid_str, ia5_str, utc_time, gen_time, gr_str,
                        vis_str, gen_str, univ_str, char_str, bmp_str, date, tod, datetime, duration, oid-iri, rel-oid-iri.  These types can be followed  by  an  optional  numeric  size,
                        which indicates the field width in bytes.

            guid        A Globally Unique Identifier, parsed and printed as XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX.  It&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="o">.</span><span class="w">

            </span><span class="n">offset</span><span class="w">      </span><span class="nc">This</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">quad</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">buffer</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">en</span><span class="err">‐</span><span class="w">
                        </span><span class="ss">tries</span><span class="p">:</span><span class="w">

                              </span><span class="o">-</span><span class="mi">0</span><span class="w">      </span><span class="n">offset</span><span class="w">  </span><span class="n">x</span><span class="w">       </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="p">%</span><span class="n">lld</span><span class="w"> </span><span class="n">bytes</span><span class="w">
                              </span><span class="o">-</span><span class="mi">0</span><span class="w">      </span><span class="n">offset</span><span class="w">  </span><span class="o">&lt;=</span><span class="mi">100</span><span class="w">   </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="err">\</span><span class="w">
                                  </span><span class="n">bytes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="p">%</span><span class="n">lld</span><span class="w">

            </span><span class="n">octal</span><span class="w">       </span><span class="nc">A</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">representing</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">octal</span><span class="w"> </span><span class="n">number</span><span class="o">.</span><span class="w">

            </span><span class="nc">For</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Single</span><span class="w"> </span><span class="nc">Unix</span><span class="w"> </span><span class="nc">Standard</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifiers</span><span class="w"> </span><span class="n">dC</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">d1</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">byte</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifiers</span><span class="w"> </span><span class="n">uC</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">u1</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ubyte</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w">  </span><span class="n">speci</span><span class="err">‐</span><span class="w">
            </span><span class="n">fiers</span><span class="w">  </span><span class="n">dS</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">d2</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">short</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifiers</span><span class="w"> </span><span class="n">uS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">u2</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ushort</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifiers</span><span class="w"> </span><span class="n">dI</span><span class="p">,</span><span class="w"> </span><span class="n">dL</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">d4</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">speci</span><span class="err">‐</span><span class="w">
            </span><span class="n">fiers</span><span class="w"> </span><span class="n">uI</span><span class="p">,</span><span class="w"> </span><span class="n">uL</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">u4</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ulong</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifier</span><span class="w"> </span><span class="n">d8</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">quad</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifier</span><span class="w"> </span><span class="n">u8</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">uquad</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifier</span><span class="w"> </span><span class="n">s</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">equiva</span><span class="err">‐</span><span class="w">
            </span><span class="n">lent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">string</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">addition</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifier</span><span class="w"> </span><span class="n">dQ</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">quad</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifier</span><span class="w"> </span><span class="n">uQ</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">uquad</span><span class="o">.</span><span class="w">

            </span><span class="nc">Each</span><span class="w">  </span><span class="n">top</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p" data-group-id="6944391485-7">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">explanation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">levels</span><span class="p" data-group-id="6944391485-7">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">classified</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">Types</span><span class="w"> </span><span class="err">“</span><span class="n">regex</span><span class="err">”</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">“</span><span class="n">search</span><span class="err">”</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">classified</span><span class="w">
            </span><span class="n">as</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">printable</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pattern</span><span class="o">.</span><span class="w">  </span><span class="nc">All</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">classified</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">binary</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">top</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">test</span><span class="w">  </span><span class="n">text</span><span class="w">  </span><span class="ow">when</span><span class="w">
            </span><span class="n">all</span><span class="w">  </span><span class="n">its</span><span class="w"> </span><span class="n">patterns</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">patterns</span><span class="p">;</span><span class="w"> </span><span class="n">otherwise</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="n">pattern</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="n">patterns</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">tried</span><span class="w"> </span><span class="n">first</span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">found</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w">
            </span><span class="n">file</span><span class="w"> </span><span class="n">looks</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">determined</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">patterns</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">tried</span><span class="o">.</span><span class="w">

            </span><span class="nc">The</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">AND</span><span class="sc">&#39;ed with the numeric  value  before  any  comparisons  are  done.
            Prepending a u to the type indicates that ordered comparisons should be unsigned.

   test     The  value  to be compared with the value from the file.  If the type is numeric, this value is specified in C form; if it is a string, it is specified as a C string with the
            usual escapes permitted (e.g. </span><span class="se">\n</span><span class="sc"> for new-line).

            Numeric values may be preceded by a character indicating the operation to be performed.  It may be =, to specify that the value from the file must equal the specified  value,
            &lt;,  to  specify that the value from the file must be less than the specified value, &gt;, to specify that the value from the file must be greater than the specified value, &amp;, to
            specify that the value from the file must have set all of the bits that are set in the specified value, ^, to specify that the value from the file must have clear any of  the
            bits that are set in the specified value, or ~, the value specified after is negated before tested.  x, to specify that any value will match.  If the character is omitted, it
            is assumed to be =.  Operators &amp;, ^, and ~ don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">floats</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">doubles</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">succeed</span><span class="o">.</span><span class="w">

            </span><span class="nc">Numeric</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">form</span><span class="p">;</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w">  </span><span class="mi">13</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">decimal</span><span class="p">,</span><span class="w"> </span><span class="mi">013</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">octal</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mh">0x13</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">hexadecimal</span><span class="o">.</span><span class="w">

            </span><span class="nc">Numeric</span><span class="w"> </span><span class="n">operations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">offset</span><span class="o">.</span><span class="w">

            </span><span class="nc">For</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">string</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">operators</span><span class="w"> </span><span class="o">=</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="6944391485-8">(</span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="6944391485-8">)</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">is</span><span class="w">
            </span><span class="n">that</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">empty</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="p" data-group-id="6944391485-9">(</span><span class="n">usually</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">string</span><span class="p" data-group-id="6944391485-9">)</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">&gt;</span><span class="err">\</span><span class="mi">0</span><span class="w"> </span><span class="p" data-group-id="6944391485-10">(</span><span class="n">because</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">empty</span><span class="w">
            </span><span class="n">strings</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">string</span><span class="p" data-group-id="6944391485-10">)</span><span class="o">.</span><span class="w">

            </span><span class="nc">Dates</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">treated</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">representation</span><span class="o">.</span><span class="w">

            </span><span class="nc">The</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">evaluates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="o">.</span><span class="w">

   </span><span class="n">message</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">comparison</span><span class="w"> </span><span class="n">succeeds</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="6944391485-11">(</span><span class="mi">3</span><span class="p" data-group-id="6944391485-11">)</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">specification</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="6944391485-12">(</span><span class="k">with</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">masking</span><span class="w"> </span><span class="n">performed</span><span class="p" data-group-id="6944391485-12">)</span><span class="w">
            </span><span class="n">is</span><span class="w">  </span><span class="n">printed</span><span class="w">  </span><span class="n">using</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">message</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">string</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">begins</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="err">“</span><span class="err">\</span><span class="n">b</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remainder</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">whitespace</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="ss">it</span><span class="p">:</span><span class="w">
            </span><span class="n">multiple</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">space</span><span class="o">.</span><span class="w">

   </span><span class="nc">An</span><span class="w"> </span><span class="nc">APPLE</span><span class="w"> </span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="nc">APPLE</span><span class="w"> </span><span class="n">creator</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

         </span><span class="o">!</span><span class="ss">:apple</span><span class="w"> </span><span class="nc">CREATYPE</span><span class="w">

   </span><span class="nc">A</span><span class="w"> </span><span class="n">slash</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">commonly</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

         </span><span class="o">!</span><span class="ss">:ext</span><span class="w">   </span><span class="n">ext</span><span class="p" data-group-id="6944391485-13">[</span><span class="o">/</span><span class="n">ext</span><span class="n">...</span><span class="p" data-group-id="6944391485-13">]</span><span class="w">

   </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">literal</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="err">“</span><span class="o">!</span><span class="ss">:ext</span><span class="err">”</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">slash</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">commonly</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">extensions</span><span class="p">;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">JPEG</span><span class="w"> </span><span class="ss">images</span><span class="p">:</span><span class="w">

         </span><span class="o">!</span><span class="ss">:ext</span><span class="w"> </span><span class="n">jpeg</span><span class="o">/</span><span class="n">jpg</span><span class="o">/</span><span class="n">jpe</span><span class="o">/</span><span class="n">jfif</span><span class="w">

   </span><span class="nc">A</span><span class="w"> </span><span class="nc">MIME</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">blank</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">identifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">format</span><span class="p">:</span><span class="w">

         </span><span class="o">!</span><span class="ss">:mime</span><span class="w">  </span><span class="nc">MIMETYPE</span><span class="w">

   </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">literal</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="err">“</span><span class="o">!</span><span class="ss">:mime</span><span class="err">”</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MIME</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w">

   </span><span class="nc">An</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">strength</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">refers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">format</span><span class="p">:</span><span class="w">

         </span><span class="o">!</span><span class="ss">:strength</span><span class="w"> </span><span class="nc">OP</span><span class="w"> </span><span class="nc">VALUE</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">operand</span><span class="w"> </span><span class="nc">OP</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ss">be</span><span class="p">:</span><span class="w"> </span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">VALUE</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">constant</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">255</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">constant</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">operand</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">strength</span><span class="o">.</span><span class="w">

   </span><span class="nc">Some</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">formats</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">tests</span><span class="w">  </span><span class="n">are</span><span class="w">
   </span><span class="n">introduced</span><span class="w">  </span><span class="n">by</span><span class="w">  </span><span class="n">one</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">more</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">preceding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">offset</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">test</span><span class="p">;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">beginning</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">at</span><span class="w">
   </span><span class="n">level</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w">  </span><span class="nc">Tests</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">arranged</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tree</span><span class="o">-</span><span class="n">like</span><span class="w"> </span><span class="ss">hierarchy</span><span class="p">:</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">succeeds</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">performed</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tests</span><span class="w">
   </span><span class="n">succeed</span><span class="p">,</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p" data-group-id="6944391485-14">(</span><span class="ow">or</span><span class="w"> </span><span class="n">less</span><span class="p" data-group-id="6944391485-14">)</span><span class="w"> </span><span class="n">appears</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">complex</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s">&quot;if/then&quot;</span><span class="w"> </span><span class="n">effect</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">way</span><span class="p">:</span><span class="w">

         </span><span class="mi">0</span><span class="w">      </span><span class="n">string</span><span class="w">    </span><span class="nc">MZ</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">  </span><span class="n">uleshort</span><span class="w">  </span><span class="o">&lt;</span><span class="mh">0x40</span><span class="w">   </span><span class="nc">MS</span><span class="o">-</span><span class="nc">DOS</span><span class="w"> </span><span class="n">executable</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">  </span><span class="n">uleshort</span><span class="w">  </span><span class="o">&gt;</span><span class="mh">0x3f</span><span class="w">   </span><span class="n">extended</span><span class="w"> </span><span class="nc">PC</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-15">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="nc">MS</span><span class="w"> </span><span class="nc">Windows</span><span class="p" data-group-id="6944391485-15">)</span><span class="w">

   </span><span class="nc">Offsets</span><span class="w"> </span><span class="k" data-group-id="6944391485-16">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">constant</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">examined</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p" data-group-id="6944391485-17">(</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parenthesis</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
   </span><span class="n">terpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">indirect</span><span class="w"> </span><span class="n">offset</span><span class="o">.</span><span class="w">  </span><span class="nc">That</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parenthesis</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">read</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w">  </span><span class="n">offset</span><span class="w">
   </span><span class="ow">in</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">file</span><span class="o">.</span><span class="w">   </span><span class="nc">Indirect</span><span class="w">  </span><span class="n">offsets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">form</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6944391485-18">(</span><span class="n">x</span><span class="w"> </span><span class="p" data-group-id="6944391485-19">[</span><span class="p" data-group-id="6944391485-20">[</span><span class="o">.</span><span class="p">,</span><span class="p" data-group-id="6944391485-20">]</span><span class="p" data-group-id="6944391485-21">[</span><span class="n">bBcCeEfFgGhHiIlmosSqQ</span><span class="p" data-group-id="6944391485-21">]</span><span class="p" data-group-id="6944391485-19">]</span><span class="p" data-group-id="6944391485-22">[</span><span class="o">+</span><span class="o">-</span><span class="p" data-group-id="6944391485-22">]</span><span class="p" data-group-id="6944391485-23">[</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p" data-group-id="6944391485-23">]</span><span class="p" data-group-id="6944391485-18">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">byte</span><span class="p">,</span><span class="w"> </span><span class="n">id3</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">short</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">is</span><span class="w">
   </span><span class="n">read</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="p" data-group-id="6944391485-24">[</span><span class="n">bBcCeEfFgGhHiIlLmsSqQ</span><span class="p" data-group-id="6944391485-24">]</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">specifier</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">treated</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">signed</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="err">“</span><span class="p">,</span><span class="err">”</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="k">if</span><span class="w">  </span><span class="err">“</span><span class="o">.</span><span class="err">”</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">specified</span><span class="o">.</span><span class="w">   </span><span class="nc">The</span><span class="w">  </span><span class="n">capitalized</span><span class="w">
   </span><span class="n">types</span><span class="w">  </span><span class="n">interpret</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">big</span><span class="w"> </span><span class="n">endian</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">whereas</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">interpret</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">little</span><span class="w"> </span><span class="n">endian</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">interprets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">middle</span><span class="w"> </span><span class="n">endian</span><span class="w">
   </span><span class="p" data-group-id="6944391485-25">(</span><span class="nc">PDP</span><span class="o">-</span><span class="mi">11</span><span class="p" data-group-id="6944391485-25">)</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">long</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">  </span><span class="n">following</span><span class="w">  </span><span class="n">types</span><span class="w">  </span><span class="n">are</span><span class="w">
   </span><span class="ss">recognized</span><span class="p">:</span><span class="w">

         </span><span class="nc">Type</span><span class="w">    </span><span class="nc">Sy</span><span class="w"> </span><span class="nc">Mnemonic</span><span class="w">   </span><span class="nc">Sy</span><span class="w"> </span><span class="nc">Endian</span><span class="w"> </span><span class="nc">Sy</span><span class="w"> </span><span class="nc">Size</span><span class="w">
         </span><span class="n">bcBC</span><span class="w">    </span><span class="nc">Byte</span><span class="o">/</span><span class="nc">Char</span><span class="w">     </span><span class="nc">N</span><span class="o">/</span><span class="nc">A</span><span class="w">       </span><span class="mi">1</span><span class="w">
         </span><span class="n">efg</span><span class="w">     </span><span class="nc">Double</span><span class="w">        </span><span class="nc">Little</span><span class="w">    </span><span class="mi">8</span><span class="w">
         </span><span class="nc">EFG</span><span class="w">     </span><span class="nc">Double</span><span class="w">        </span><span class="nc">Big</span><span class="w">       </span><span class="mi">8</span><span class="w">
         </span><span class="n">hs</span><span class="w">      </span><span class="nc">Half</span><span class="o">/</span><span class="nc">Short</span><span class="w">    </span><span class="nc">Little</span><span class="w">    </span><span class="mi">2</span><span class="w">
         </span><span class="nc">HS</span><span class="w">      </span><span class="nc">Half</span><span class="o">/</span><span class="nc">Short</span><span class="w">    </span><span class="nc">Big</span><span class="w">       </span><span class="mi">2</span><span class="w">
         </span><span class="n">i</span><span class="w">       </span><span class="nc">ID3</span><span class="w">           </span><span class="nc">Little</span><span class="w">    </span><span class="mi">4</span><span class="w">
         </span><span class="nc">I</span><span class="w">       </span><span class="nc">ID3</span><span class="w">           </span><span class="nc">Big</span><span class="w">       </span><span class="mi">4</span><span class="w">
         </span><span class="n">l</span><span class="w">       </span><span class="nc">Long</span><span class="w">          </span><span class="nc">Little</span><span class="w">    </span><span class="mi">4</span><span class="w">
         </span><span class="nc">L</span><span class="w">       </span><span class="nc">Long</span><span class="w">          </span><span class="nc">Big</span><span class="w">       </span><span class="mi">4</span><span class="w">
         </span><span class="n">m</span><span class="w">       </span><span class="nc">Middle</span><span class="w">        </span><span class="nc">Middle</span><span class="w">    </span><span class="mi">4</span><span class="w">
         </span><span class="n">o</span><span class="w">       </span><span class="nc">Octal</span><span class="w">         </span><span class="nc">Textual</span><span class="w">   </span><span class="nc">Variable</span><span class="w">
         </span><span class="n">q</span><span class="w">       </span><span class="nc">Quad</span><span class="w">          </span><span class="nc">Little</span><span class="w">    </span><span class="mi">8</span><span class="w">
         </span><span class="nc">Q</span><span class="w">       </span><span class="nc">Quad</span><span class="w">          </span><span class="nc">Big</span><span class="w">       </span><span class="mi">8</span><span class="w">

   </span><span class="nc">That</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">structures</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="ss">examined</span><span class="p">:</span><span class="w">

         </span><span class="c1"># MS Windows executables are also valid MS-DOS executables</span><span class="w">
         </span><span class="mi">0</span><span class="w">           </span><span class="n">string</span><span class="w">   </span><span class="nc">MZ</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">       </span><span class="n">uleshort</span><span class="w"> </span><span class="o">&lt;</span><span class="mh">0x40</span><span class="w">  </span><span class="nc">MZ</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-26">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">DOS</span><span class="p" data-group-id="6944391485-26">)</span><span class="w">
         </span><span class="c1"># skip the whole block below if it is not an extended executable</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">       </span><span class="n">uleshort</span><span class="w"> </span><span class="o">&gt;</span><span class="mh">0x3f</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-27">(</span><span class="mh">0x3c</span><span class="o">.</span><span class="n">l</span><span class="p" data-group-id="6944391485-27">)</span><span class="w">  </span><span class="n">string</span><span class="w">   </span><span class="nc">PE</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w"> </span><span class="nc">PE</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-28">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">Windows</span><span class="p" data-group-id="6944391485-28">)</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-29">(</span><span class="mh">0x3c</span><span class="o">.</span><span class="n">l</span><span class="p" data-group-id="6944391485-29">)</span><span class="w">  </span><span class="n">string</span><span class="w">   </span><span class="nc">LX</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w"> </span><span class="nc">LX</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-30">(</span><span class="nc">OS</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="6944391485-30">)</span><span class="w">

   </span><span class="nc">This</span><span class="w">  </span><span class="n">strategy</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">examining</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ss">drawback</span><span class="p">:</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">eventually</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">something</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p" data-group-id="6944391485-31">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">neither</span><span class="w"> </span><span class="nc">PE</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="nc">LE</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w"> </span><span class="ow">in</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">example</span><span class="p" data-group-id="6944391485-31">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">indirect</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">directly</span><span class="p">,</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">calculations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ss">possible</span><span class="p">:</span><span class="w"> </span><span class="n">appending</span><span class="w"> </span><span class="p" data-group-id="6944391485-32">[</span><span class="o">+</span><span class="o">-</span><span class="o">*</span><span class="o">/</span><span class="p">%</span><span class="o">&amp;</span><span class="o">|</span><span class="o">^</span><span class="p" data-group-id="6944391485-32">]</span><span class="n">number</span><span class="w"> </span><span class="n">inside</span><span class="w"> </span><span class="n">parentheses</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">modify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w">  </span><span class="n">be</span><span class="err">‐</span><span class="w">
   </span><span class="n">fore</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="ss">offset</span><span class="p">:</span><span class="w">

         </span><span class="c1"># MS Windows executables are also valid MS-DOS executables</span><span class="w">
         </span><span class="mi">0</span><span class="w">           </span><span class="n">string</span><span class="w">   </span><span class="nc">MZ</span><span class="w">
         </span><span class="c1"># sometimes, the value at 0x18 is less that 0x40 but there&#39;s still an</span><span class="w">
         </span><span class="c1"># extended executable, simply appended to the file</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">       </span><span class="n">uleshort</span><span class="w"> </span><span class="o">&lt;</span><span class="mh">0x40</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-33">(</span><span class="mi">4</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="mi">512</span><span class="p" data-group-id="6944391485-33">)</span><span class="w"> </span><span class="n">leshort</span><span class="w">  </span><span class="mh">0x014c</span><span class="w">  </span><span class="nc">COFF</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-34">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">DOS</span><span class="p">,</span><span class="w"> </span><span class="nc">DJGPP</span><span class="p" data-group-id="6944391485-34">)</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-35">(</span><span class="mi">4</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="mi">512</span><span class="p" data-group-id="6944391485-35">)</span><span class="w"> </span><span class="n">leshort</span><span class="w">  </span><span class="o">!</span><span class="mh">0x014c</span><span class="w"> </span><span class="nc">MZ</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-36">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">DOS</span><span class="p" data-group-id="6944391485-36">)</span><span class="w">

   </span><span class="nc">Sometimes</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k" data-group-id="6944391485-37">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="p" data-group-id="6944391485-38">(</span><span class="ow">when</span><span class="w"> </span><span class="n">indirection</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">before</span><span class="p" data-group-id="6944391485-38">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">preceding</span><span class="w"> </span><span class="n">fields</span><span class="o">.</span><span class="w">  </span><span class="nc">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="k" data-group-id="6944391485-37">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">up</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="err">‘</span><span class="o">&amp;</span><span class="err">’</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">offset</span><span class="p">:</span><span class="w">

         </span><span class="mi">0</span><span class="w">           </span><span class="n">string</span><span class="w">   </span><span class="nc">MZ</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">       </span><span class="n">uleshort</span><span class="w"> </span><span class="o">&gt;</span><span class="mh">0x3f</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-39">(</span><span class="mh">0x3c</span><span class="o">.</span><span class="n">l</span><span class="p" data-group-id="6944391485-39">)</span><span class="w">  </span><span class="n">string</span><span class="w">   </span><span class="nc">PE</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w">    </span><span class="nc">PE</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-40">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">Windows</span><span class="p" data-group-id="6944391485-40">)</span><span class="w">
         </span><span class="c1"># immediately following the PE signature is the CPU type</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="ni">&amp;0</span><span class="w">       </span><span class="n">leshort</span><span class="w">  </span><span class="mh">0x14c</span><span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="nc">Intel</span><span class="w"> </span><span class="mi">80386</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="ni">&amp;0</span><span class="w">       </span><span class="n">leshort</span><span class="w">  </span><span class="mh">0x8664</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x86</span><span class="o">-</span><span class="mi">64</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="ni">&amp;0</span><span class="w">       </span><span class="n">leshort</span><span class="w">  </span><span class="mh">0x184</span><span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="nc">DEC</span><span class="w"> </span><span class="nc">Alpha</span><span class="w">

   </span><span class="nc">Indirect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">offsets</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="ss">combined</span><span class="p">:</span><span class="w">

         </span><span class="mi">0</span><span class="w">             </span><span class="n">string</span><span class="w">   </span><span class="nc">MZ</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">         </span><span class="n">uleshort</span><span class="w"> </span><span class="o">&lt;</span><span class="mh">0x40</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-41">(</span><span class="mi">4</span><span class="o">.</span><span class="n">s</span><span class="o">*</span><span class="mi">512</span><span class="p" data-group-id="6944391485-41">)</span><span class="w">   </span><span class="n">leshort</span><span class="w">  </span><span class="o">!</span><span class="mh">0x014c</span><span class="w"> </span><span class="nc">MZ</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-42">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">DOS</span><span class="p" data-group-id="6944391485-42">)</span><span class="w">
         </span><span class="c1"># if it&#39;s not COFF, go back 512 bytes and add the offset taken</span><span class="w">
         </span><span class="c1"># from byte 2/3, which is yet another way of finding the start</span><span class="w">
         </span><span class="c1"># of the extended executable</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="o">&amp;</span><span class="p" data-group-id="6944391485-43">(</span><span class="mi">2</span><span class="o">.</span><span class="n">s</span><span class="o">-</span><span class="mi">514</span><span class="p" data-group-id="6944391485-43">)</span><span class="w"> </span><span class="n">string</span><span class="w">   </span><span class="nc">LE</span><span class="w">      </span><span class="nc">LE</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-44">(</span><span class="nc">MS</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">VxD</span><span class="w"> </span><span class="n">driver</span><span class="p" data-group-id="6944391485-44">)</span><span class="w">

   </span><span class="nc">Or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="ss">around</span><span class="p">:</span><span class="w">

         </span><span class="mi">0</span><span class="w">                 </span><span class="n">string</span><span class="w">   </span><span class="nc">MZ</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">             </span><span class="n">uleshort</span><span class="w"> </span><span class="o">&gt;</span><span class="mh">0x3f</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-45">(</span><span class="mh">0x3c</span><span class="o">.</span><span class="n">l</span><span class="p" data-group-id="6944391485-45">)</span><span class="w">        </span><span class="n">string</span><span class="w">   </span><span class="nc">LE</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w">  </span><span class="nc">LE</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-46">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">Windows</span><span class="p" data-group-id="6944391485-46">)</span><span class="w">
         </span><span class="c1"># at offset 0x80 (-4, since relative offsets start at the end</span><span class="w">
         </span><span class="c1"># of the up-level match) inside the LE header, we find the absolute</span><span class="w">
         </span><span class="c1"># offset to the code area, where we look for a specific signature</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="p" data-group-id="6944391485-47">(</span><span class="ni">&amp;0</span><span class="n">x7c</span><span class="o">.</span><span class="n">l</span><span class="o">+</span><span class="mh">0x26</span><span class="p" data-group-id="6944391485-47">)</span><span class="w"> </span><span class="n">string</span><span class="w">   </span><span class="nc">UPX</span><span class="w">     </span><span class="err">\</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="nc">UPX</span><span class="w"> </span><span class="n">compressed</span><span class="w">

   </span><span class="nc">Or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">both!</span><span class="w">

         </span><span class="mi">0</span><span class="w">                </span><span class="n">string</span><span class="w">   </span><span class="nc">MZ</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">            </span><span class="n">uleshort</span><span class="w"> </span><span class="o">&gt;</span><span class="mh">0x3f</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-48">(</span><span class="mh">0x3c</span><span class="o">.</span><span class="n">l</span><span class="p" data-group-id="6944391485-48">)</span><span class="w">       </span><span class="n">string</span><span class="w">   </span><span class="nc">LE</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w"> </span><span class="nc">LE</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-49">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">Windows</span><span class="p" data-group-id="6944391485-49">)</span><span class="w">
         </span><span class="c1"># at offset 0x58 inside the LE header, we find the relative offset</span><span class="w">
         </span><span class="c1"># to a data area where we look for a specific signature</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="o">&amp;</span><span class="p" data-group-id="6944391485-50">(</span><span class="ni">&amp;0</span><span class="n">x54</span><span class="o">.</span><span class="n">l</span><span class="o">-</span><span class="mi">3</span><span class="p" data-group-id="6944391485-50">)</span><span class="w">  </span><span class="n">string</span><span class="w">   </span><span class="nc">UNACE</span><span class="w">  </span><span class="err">\</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="nc">ACE</span><span class="w"> </span><span class="n">self</span><span class="o">-</span><span class="n">extracting</span><span class="w"> </span><span class="n">archive</span><span class="w">

   </span><span class="nc">If</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">have</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">deal</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">offset</span><span class="o">/</span><span class="n">length</span><span class="w"> </span><span class="n">pairs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">parenthesized</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">itself</span><span class="p">,</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">parentheses</span><span class="o">.</span><span class="w">
   </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">indirect</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">indirect</span><span class="w"> </span><span class="n">offset</span><span class="o">.</span><span class="w">

         </span><span class="mi">0</span><span class="w">                 </span><span class="n">string</span><span class="w">       </span><span class="nc">MZ</span><span class="w">
         </span><span class="o">&gt;</span><span class="mh">0x18</span><span class="w">             </span><span class="n">uleshort</span><span class="w">     </span><span class="o">&gt;</span><span class="mh">0x3f</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6944391485-51">(</span><span class="mh">0x3c</span><span class="o">.</span><span class="n">l</span><span class="p" data-group-id="6944391485-51">)</span><span class="w">        </span><span class="n">string</span><span class="w">       </span><span class="nc">PE</span><span class="err">\</span><span class="mi">0</span><span class="err">\</span><span class="mi">0</span><span class="w"> </span><span class="nc">PE</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="p" data-group-id="6944391485-52">(</span><span class="nc">MS</span><span class="o">-</span><span class="nc">Windows</span><span class="p" data-group-id="6944391485-52">)</span><span class="w">
         </span><span class="c1"># search for the PE section called &quot;.idata&quot;...</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="ni">&amp;0</span><span class="n">xf4</span><span class="w">          </span><span class="n">search</span><span class="o">/</span><span class="mh">0x140</span><span class="w"> </span><span class="o">.</span><span class="n">idata</span><span class="w">
         </span><span class="c1"># ...and go to the end of it, calculated from start+length;</span><span class="w">
         </span><span class="c1"># these are located 14 and 10 bytes after the section name</span><span class="w">
         </span><span class="o">&gt;&gt;&gt;</span><span class="o">&gt;</span><span class="p" data-group-id="6944391485-53">(</span><span class="ni">&amp;0</span><span class="n">xe</span><span class="o">.</span><span class="n">l</span><span class="o">+</span><span class="p" data-group-id="6944391485-54">(</span><span class="o">-</span><span class="mi">4</span><span class="p" data-group-id="6944391485-54">)</span><span class="p" data-group-id="6944391485-53">)</span><span class="w"> </span><span class="n">string</span><span class="w">       </span><span class="nc">PK</span><span class="err">\</span><span class="mi">3</span><span class="err">\</span><span class="mi">4</span><span class="w"> </span><span class="err">\</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="nc">ZIP</span><span class="w"> </span><span class="n">self</span><span class="o">-</span><span class="n">extracting</span><span class="w"> </span><span class="n">archive</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">continuation</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">switch</span><span class="o">-</span><span class="n">like</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="ss">case</span><span class="p">:</span><span class="w">

         </span><span class="c1"># clear that continuation level match</span><span class="w">
         </span><span class="o">&gt;</span><span class="mi">18</span><span class="w">     </span><span class="n">clear</span><span class="w">   </span><span class="n">x</span><span class="w">
         </span><span class="o">&gt;</span><span class="mi">18</span><span class="w">     </span><span class="n">lelong</span><span class="w">  </span><span class="mi">1</span><span class="w">       </span><span class="n">one</span><span class="w">
         </span><span class="o">&gt;</span><span class="mi">18</span><span class="w">     </span><span class="n">lelong</span><span class="w">  </span><span class="mi">2</span><span class="w">       </span><span class="n">two</span><span class="w">
         </span><span class="o">&gt;</span><span class="mi">18</span><span class="w">     </span><span class="n">default</span><span class="w"> </span><span class="n">x</span><span class="w">
         </span><span class="c1"># print default match</span><span class="w">
         </span><span class="p">&gt;&gt;</span><span class="mi">18</span><span class="w">    </span><span class="n">lelong</span><span class="w">  </span><span class="n">x</span><span class="w">       </span><span class="n">unmatched</span><span class="w"> </span><span class="mi">0</span><span class="n">x</span><span class="p">%</span><span class="n">x</span></code></pre><p>SEE ALSO</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="n">file</span><span class="p" data-group-id="9772351761-1">(</span><span class="mi">1</span><span class="p" data-group-id="9772351761-1">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">reads</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="o">.</span></code></pre><p>BUGS</p><pre><code class="makeup elixir" translate="no"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">formats</span><span class="w"> </span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">belong</span><span class="p">,</span><span class="w"> </span><span class="n">lelong</span><span class="p">,</span><span class="w"> </span><span class="n">melong</span><span class="p">,</span><span class="w"> </span><span class="n">short</span><span class="p">,</span><span class="w"> </span><span class="n">beshort</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">leshort</span><span class="w"> </span><span class="k" data-group-id="9638147112-1">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">depend</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">short</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Single</span><span class="w"> </span><span class="nc">Unix</span><span class="w"> </span><span class="nc">Spec</span><span class="err">‐</span><span class="w">
   </span><span class="n">ification</span><span class="w"> </span><span class="n">implies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="k" data-group-id="9638147112-2">do</span><span class="o">.</span><span class="w">  </span><span class="nc">However</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="w"> </span><span class="nc">Mountain</span><span class="w"> </span><span class="nc">Lion</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Single</span><span class="w"> </span><span class="nc">Unix</span><span class="w"> </span><span class="nc">Specification</span><span class="w"> </span><span class="n">validation</span><span class="w"> </span><span class="n">suite</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">supplies</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">file</span><span class="p" data-group-id="9638147112-3">(</span><span class="mi">1</span><span class="p" data-group-id="9638147112-3">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="k" data-group-id="9638147112-4">do</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">de</span><span class="err">‐</span><span class="w">
   </span><span class="n">pend</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">sizes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">presumably</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">validation</span><span class="w"> </span><span class="n">suite</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">whether</span><span class="p">,</span><span class="w">
   </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">refers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">long</span><span class="o">.</span><span class="w">  </span><span class="nc">There</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">int8</span><span class="p">,</span><span class="w"> </span><span class="n">uint8</span><span class="p">,</span><span class="w"> </span><span class="n">int16</span><span class="p">,</span><span class="w"> </span><span class="n">uint16</span><span class="p">,</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">int64</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">uint64</span><span class="p">,</span><span class="w">  </span><span class="ow">and</span><span class="w">
   </span><span class="n">specified</span><span class="o">-</span><span class="n">byte</span><span class="o">-</span><span class="n">order</span><span class="w"> </span><span class="n">variants</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">them</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">clearer</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">widths</span><span class="o">.</span></code></pre><p>Debian                                                                                 November 27, 2024                                                                              MAGIC(5)</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="mac-vendor.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
mac-vendor
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="mailcap.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
mailcap
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
